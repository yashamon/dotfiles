/*! bro-fs v0.6.0 */
!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.fs=r():e.fs=r()}(window,(function(){return function(e){var r={};function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var o in e)t.d(n,o,function(r){return e[r]}.bind(null,o));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=4)}([function(e,r){function t(e){return function(){for(var r=arguments.length,t=[];r--;)t[r]=arguments[r];0===t.length?e():1===t.length?e(t[0]):e(t)}}function n(e,r,t,n){return function(o){var i="";try{i=JSON.stringify(t)}catch(e){i=t.join(", ")}e.name=o.name,e.message="".concat(o.message," Call: ").concat(r,"(").concat(i,")"),n(e)}}r.promiseCall=function(e,r){if(!e)throw new Error("Can't call promisified method '".concat(r,"' of ").concat(e));var o=[].slice.call(arguments,2);return new Promise((function(i,u){var a=t(i),c=n(new Error,r,o,u),f=o.concat([a,c]);return e[r].apply(e,f)}))},r.parsePath=function(e){var t=r.splitPath(e),n=t.pop();return{dirPath:t.join("/"),fileName:n}},r.splitPath=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if((e=e.replace(/^\.\//,"")).length>1&&e.endsWith("/"))throw new Error("Path can not end with '/'");return e.split("/").filter(Boolean)}},function(e,r){r.isNotFoundError=function(e){return e&&"NotFoundError"===e.name},r.isTypeMismatchError=function(e){return e&&"TypeMismatchError"===e.name}},function(e,r){var t=null,n=null;r.get=function(){if(t)return t;throw new Error("Filesystem not initialized.")},r.set=function(e,r){t=e,n=r},r.getType=function(){return n}},function(e,r,t){var n=t(0),o=t(1),i=t(2);function u(e,r){return n.promiseCall(e,"getDirectory",r,{create:!0,exclusive:!1})}function a(e,r){return n.promiseCall(e,"getDirectory",r,{create:!1})}r.get=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e&&"string"!=typeof e)return e.isDirectory?Promise.resolve(e):Promise.reject(new DOMError("TypeMismatchError","Expected directory but got file"));var t=n.splitPath(e);return t.reduce((function(e,t){return e.then((function(e){var n=a(e,t);return r.create&&(n=n.catch((function(r){return o.isNotFoundError(r)?u(e,t):Promise.reject(r)}))),n}))}),Promise.resolve(i.get()))},r.read=function(e){return function e(r,t){return n.promiseCall(r,"readEntries").then((function(n){return n.length?e(r,t.concat(n)):t}))}(e.createReader(),[])},r.readDeep=function(e){return r.read(e).then((function(e){var t=e.map((function(e){return e.isDirectory?r.readDeep(e).then((function(r){return Object.assign(e,{children:r})})):Promise.resolve(e)}));return Promise.all(t)}))}},function(e,r,t){function n(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var t=[],n=!0,o=!1,i=void 0;try{for(var u,a=e[Symbol.iterator]();!(n=(u=a.next()).done)&&(t.push(u.value),!r||t.length!==r);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(o)throw i}}return t}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o=t(0),i=t(1),u=t(2),a=t(5),c=t(3),f=t(6),l=t(7);function s(e,t,i,u){if(e===t)return Promise.resolve();var a=o.parsePath(t),f=a.dirPath,l=a.fileName;return Promise.all([r.getEntry(e),c.get(f,u)]).then((function(e){var r=n(e,2),t=r[0],u=r[1];return o.promiseCall(t,i,u,l)}))}function p(e){if(e!==window.PERSISTENT&&e!==window.TEMPORARY)throw new Error("Unknown storage type ".concat(e))}r.isSupported=function(){return Boolean(window.webkitRequestFileSystem)},r.init=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=Object.prototype.hasOwnProperty.call(e,"type")?e.type:window.PERSISTENT,t=e.bytes||1048576;p(r);var n=r===window.PERSISTENT&&(!Object.prototype.hasOwnProperty.call(e,"requestQuota")||e.requestQuota);return Promise.resolve().then((function(){return n?l.requestPersistent(t):t})).then((function(e){return o.promiseCall(window,"webkitRequestFileSystem",r,e)})).then((function(e){return u.set(e.root,r),e}))},r.usage=function(){return l.usage(u.getType())},r.getRoot=function(){return u.get()},r.readFile=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a.get(e).then((function(e){return a.read(e,r)}))},r.writeFile=function(e,r){return a.get(e,{create:!0,overwrite:!0}).then((function(e){return a.write(e,r,{append:!1})}))},r.appendFile=function(e,r){return a.get(e,{create:!0,overwrite:!1}).then((function(e){return a.write(e,r,{append:!0})}))},r.unlink=function(e){return a.get(e).then((function(e){return o.promiseCall(e,"remove")}),(function(e){return i.isNotFoundError(e)?Promise.resolve(!1):Promise.reject(e)}))},r.rename=function(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return s(e,r,"moveTo",t)},r.copy=function(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return s(e,r,"copyTo",t)},r.rmdir=function(e){return c.get(e).then((function(e){return e===u.get()?Promise.reject("Can not remove root. Use clear() to clear fs."):o.promiseCall(e,"removeRecursively")}),(function(e){return i.isNotFoundError(e)?Promise.resolve(!1):Promise.reject(e)}))},r.mkdir=function(e){return c.get(e,{create:!0})},r.exists=function(e){return r.getEntry(e).then((function(){return!0}),(function(e){return!i.isNotFoundError(e)&&Promise.reject(e)}))},r.stat=function(e){return r.getEntry(e).then((function(e){return f.get(e)}))},r.readdir=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return c.get(e).then((function(e){return r.deep?c.readDeep(e):c.read(e)}))},r.clear=function(){return r.readdir("/").then((function(e){var r=e.map((function(e){return e.isDirectory?o.promiseCall(e,"removeRecursively"):o.promiseCall(e,"remove")}));return Promise.all(r)}))},r.getUrl=function(e){return r.getEntry(e).then((function(e){return e.toURL()}))},r.getEntry=function(e){return a.get(e).catch((function(r){return i.isTypeMismatchError(r)?c.get(e):Promise.reject(r)}))},r.createReadStream=function(e){return a.createReadStream(e)},r.createWriteStream=function(e){return a.createWriteStream(e)}},function(e,r,t){var n=t(0),o=t(1),i=t(3);function u(e){return"string"==typeof e?"text/plain":"application/octet-binary"}function a(e,r,t){switch(e){case"ArrayBuffer":return r.readAsArrayBuffer(t);case"BinaryString":return r.readAsBinaryString(t);case"DataURL":return r.readAsDataURL(t);case"Text":default:return r.readAsText(t)}}function c(e){return new Response(e).blob()}function f(e,r){return n.promiseCall(e,"getFile",r,{create:!0,exclusive:!1})}function l(e,r){return n.promiseCall(e,"getFile",r,{create:!1})}r.get=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e&&"string"!=typeof e)return e.isFile?Promise.resolve(e):Promise.reject(new DOMError("TypeMismatchError","Expected file but got directory"));var t=n.parsePath(e),u=t.dirPath,a=t.fileName;return Promise.resolve().then((function(){return i.get(u,r)})).then((function(e){return r.create?r.overwrite?f(e,a):l(e,a).catch((function(r){return o.isNotFoundError(r)?f(e,a):Promise.reject(r)})):l(e,a)}))},r.write=function(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.promiseCall(e,"createWriter").then((function(e){return new Promise((function(n,o){if(t.append)e.seek(e.length),e.onwriteend=n;else{var i=!1;e.onwriteend=function(){i?n():(i=!0,this.truncate(this.position))}}e.onerror=o;var a=new Blob([r],{type:u(r)});e.write(a)}))})).then((function(){return e}))},r.read=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.promiseCall(e,"file").then((function(e){return"Blob"===r.type?c(e):"File"===r.type?e:new Promise((function(t,n){var o=new FileReader;o.onload=function(){return t(o.result)},o.onerror=function(){return n(o.error)},a(r.type,o,e)}))}))},r.createReadStream=function(e){var t=new TransformStream,o=t.readable,i=t.writable;return r.get(e).then((function(e){return n.promiseCall(e,"file")})).then((function(e){return new Response(e).body.pipeTo(i)})).catch((function(e){return i.abort(e)})),o},r.createWriteStream=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new WritableStream({start:function(){var o=this;return r.get(e,{create:!0,overwrite:!0}).then((function(e){return n.promiseCall(e,"createWriter")})).then((function(e){o.fileWriter=e,t.append&&e.seek(e.length)}))},write:function(e){var r=this;return new Promise((function(t,n){var o=new Blob([e],{type:u(e)});r.fileWriter.onwriteend=t,r.fileWriter.onerror=n,r.fileWriter.write(o)}))},close:function(){var e=this;return new Promise((function(r,t){e.fileWriter.onwriteend=r,e.fileWriter.onerror=t,e.fileWriter.truncate(e.fileWriter.position)}))}})}},function(e,r,t){var n=t(0);r.get=function(e){return n.promiseCall(e,"getMetadata").then((function(r){return{isFile:e.isFile,isDirectory:e.isDirectory,name:e.name,fullPath:e.fullPath,modificationTime:r.modificationTime,size:r.size}}))}},function(e,r,t){function n(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var t=[],n=!0,o=!1,i=void 0;try{for(var u,a=e[Symbol.iterator]();!(n=(u=a.next()).done)&&(t.push(u.value),!r||t.length!==r);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(o)throw i}}return t}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o=t(0);function i(e){return e===window.PERSISTENT?navigator.webkitPersistentStorage:navigator.webkitTemporaryStorage}r.requestPersistent=function(e){var r=i(window.PERSISTENT);return o.promiseCall(r,"requestQuota",e).then((function(r){return r>0?r:Promise.reject("Quota not granted (requested: ".concat(e,", granted: ").concat(r,")"))}))},r.usage=function(e){var r=i(e);return o.promiseCall(r,"queryUsageAndQuota").then((function(e){var r=n(e,2);return{usedBytes:r[0],grantedBytes:r[1]}}))}}])}));
//# sourceMappingURL=bro-fs.min.js.map