"use strict";var showFiles=null;function saveAs(e){var t=$(e.target).attr("file"),n=weblog.getPath(t);fsObj.saveAs(n,t,function(e){})}function selectedSaveAs(e){var t=$("#dataview>table>tbody>tr").filter(function(e,t){return $($(t).children("td")[0]).children("input")[0].checked});if(0!==t.length){for(var n=[],l=[],d=0;d<t.length;d++){var i=t[d],c=$($(i).children("td")[1]).text(),r=weblog.getPath(c);n.push(r),l.push(c)}fsObj.mutlSaveAs(n,l,function(e){})}}function delFile(e){var t=$(e.target).attr("file"),n=weblog.getPath(t);fsObj.delFile(n),fsObj.readDir(weblog.dir,function(e,t){showFiles(t)})}function deleteSelected(e){var t=$("#dataview>table>tbody>tr").filter(function(e,t){return $($(t).children("td")[0]).children("input")[0].checked});if(0!==t.length){for(var n=[],l=0;l<t.length;l++){var d=t[l],i=$($(d).children("td")[1]).text(),c=weblog.getPath(i);n.push(c)}fsObj.delFiles(n,function(){fsObj.readDir(weblog.dir,function(e,t){e||showFiles(t)})})}}$(function(){function a(e,d){var t=weblog.getPath(e);fsObj.getStat(t,function(e,t){var n=t.size,l=" B";1024<t.size&&(l=" KB",1024<(n=(n/1024).toFixed(1))&&(n=(n/1024).toFixed(1),l=" MB")),1024<t.size?d.innerText=n+l+" ("+t.size+" Bytes)":d.innerText=n+l})}$(".file-close").off("click").click(function(){window.close()}),document.querySelector("#dataview").style="overflow-y:auto;";var e=$("#dataview .table"),t=document.createElement("thead"),n=document.createElement("tr"),l=document.createElement("th"),o=document.createElement("input");function u(e){for(var t=$("#dataview>table>tbody>tr"),n=0;n<t.length;n++){var l=$(t[n]);$(l.children("td")[0]).children("input")[0].checked=e}}o.setAttribute("type","checkbox"),o.checked=!0,o.addEventListener("click",function(e){u($(e.target)[0].checked)}),e.undelegate().delegate("td","click",function(e){var t=$(this).parent().find("input")[0];t.checked=!t.checked}),l.appendChild(o),n.appendChild(l),(l=document.createElement("th")).innerText="File",n.appendChild(l),(l=document.createElement("th")).innerText="Size",n.appendChild(l),t.appendChild(n);var h=document.createElement("tbody");e.append(t),e.append(h),showFiles=function(e){if(e){for(var t=h.querySelectorAll("tr"),n=0;n<e.length;n++){var l=e[n];if(n<t.length){var d=(i=t[n]).querySelectorAll("td");d[1].innerText=l.name,a(l.name,d[2])}else{var i=document.createElement("tr"),c=document.createElement("td"),r=document.createElement("input");r.setAttribute("type","checkbox"),c.appendChild(r),i.appendChild(c),(c=document.createElement("td")).innerText=l.name,i.appendChild(c);c=document.createElement("td");a(l.name,c),i.appendChild(c),h.appendChild(i)}}if(t.length>e.length)for(n=e.length;n<t.length;n++){i=t[n];h.removeChild(i)}u(o.checked)}},document.getElementById("selectedSaveAs").addEventListener("click",selectedSaveAs),document.getElementById("deleteSelected").addEventListener("click",deleteSelected);!function e(){null!==fsObj&&weblog.dir?fsObj.readDir(weblog.dir,function(e,t){e||showFiles(t)}):setTimeout(e,1e3)}()});