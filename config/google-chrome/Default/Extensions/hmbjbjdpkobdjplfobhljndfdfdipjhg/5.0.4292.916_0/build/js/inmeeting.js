"use strict";var shareStream,lastShareStream,shareSourceType,audioInputDevices=[],audioOutputDevices=[],videoInputDevices=[],videoConstraints={},videoDefaultConstraints={},callbackId=0,callbackMap={},inmeeting=function(){var a=!1,o=!1,t=!1,n=!1,i=!1,m={ccMsg:[],CCSenderIds:[],initialCCTitleAttendees:[],availableCC:!1,hasPriviageChanged:!1,lastRecevMsgTime:null,ccMsgTimeoutVar:null,canEditCC:!1,ccMsgStatus:"c"};var s={attendees:[],unassignAttendees:[],boControlStatus:-1,boRooms:[],roomNum:1,autoAssign:!0,allBOInfo:{boItems:[],unassignedBoUsers:[]},boHost:{gotHost:0,hostGUID:null},myBOStatus:"",needUpdateBOWinUI:!0,isParticipantsChooseRoomEnabled:!1};var c={Yes:0,No:0,Slow:0,Fast:0,Good:0,Bad:0,Clap:0,Coffee:0,Clock:0,More:0},r={};function e(){window.onblur=function(){r={}},$(document).off("keydown",d).on("keydown",d),$(document).off("keyup",l).on("keyup",l)}function d(e){uiAgent.onInmeetingKeydown(e),r[e.key]=!0}function l(e){uiAgent.onInmeetingKeyUp(e),r={}}function u(){return{mandatory:{echoCancellation:!1,googEchoCancellation:!1,googAutoGainControl:!(85<=videocontrol.getChromeMajorVersion())&&userSettings.getAppSetting(userSettings.MIC_AGC),googNoiseSuppression:!1,googHighpassFilter:!1}}}function f(e){(document.getElementById("dummyShare").srcObject=e).oninactive=function(){N(),closeShareWindow(),restoreMainWindow()},shareStream=e,common.postMessageToNaCl({type:"share",command:"share.startShare",track:e.getVideoTracks()[0],shareSourceType:A()}),i=!1;var o=videocontrol.getMachineLevel();myStatusObject.videoIsSending&&o<=videocontrol.MACHINE_PERFORMANCE_LEVEL_MEDIUM&&(i=!0),null!==newVideoCaptureTimer&&(i=!0),i&&D()}function p(e){}function h(e){if(lastShareStream=shareStream,e){var o=winMgr.getWinByWinId("shareMainWindow");o&&o.show(),forceStartShare=!1,lastShareStream&&(lastShareStream.oninactive=null,lastShareStream.getTracks()[0].stop()),mainWindow.minimize();var t=videocontrol.getShareFrameRate(),n=1920,i=1200;videocontrol.MACHINE_PERFORMANCE_LEVEL_HIGHTEST==videocontrol.getMachineLevel()?(n=machineInfo.widthInNativePixels,i=machineInfo.heightInNativePixels):(0<machineInfo.width&&machineInfo.width<1920&&(n=machineInfo.width),0<machineInfo.height&&machineInfo.height<1200&&(i=machineInfo.height));var a={audio:!1,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxWidth:n,maxHeight:i,maxFrameRate:t}}};navigator.mediaDevices.getUserMedia(a).then(f).catch(p)}else if(shareStream&&shareStream.active){var s=winMgr.getWinByWinId("shareMainWindow");s&&s.show()}}function C(e){var o=common.formatNameByLength(e,30);$("#shareArea .share-starting-wrapper").text(o+" has started screen sharing"),o.match(new RegExp("s$"))?o=o.replace(new RegExp("s$"),"s'"):o+="'s",$(".share-user").text(o)}function v(){if(!mainAppChromeWindow.isFullscreen()){document.getElementById("listener");inmeeting.refreshCurrentActiveSpeaker(0),b(),closeBoWinsWhenToggleFullscreen(),client.forceHideSidePanel(),mainAppChromeWindow.fullscreen()}}function w(){inmeeting.refreshCurrentActiveSpeaker(0),b(),closeBoWinsWhenToggleFullscreen(),mainAppChromeWindow.restore()}function b(e){window.clearTimeout(resizeTimer),canShowActiveSpeakerUI=0,resizeTimer=window.setTimeout(function(){canShowActiveSpeakerUI=1},1e3)}function M(){common.postMessageToNaCl({type:"video",command:"video.switchVideoMode",mode:g.getConstants().VIDEO_MODE_GALLERY})}function S(){common.postMessageToNaCl({type:"video",command:"video.switchVideoMode",mode:g.getConstants().VIDEO_MODE_SPEAKER})}function I(){common.postMessageToNaCl({type:"video",command:"video.showNextPageVideo"})}function T(){common.postMessageToNaCl({type:"video",command:"video.showPrePageVideo"})}function y(e){}function O(e){o=e}function A(e){return e&&(shareSourceType=e),shareSourceType}function N(){i&&H(),common.postMessageToNaCl({type:"share",command:"share.stopShare"})}function k(e){var o=videocontrol.getResolution(),t={},n=commonModule.DeviceMgr.getInstance().getInMeetingUsingDeviceByKind("videoinput");return e=e||(n?n.deviceId:void 0),t.video=Object.assign({},videoDefaultConstraints,{deviceId:e,width:{ideal:o.width},height:{ideal:o.height},frameRate:{min:15,ideal:20,max:25}}),t}var W=0;function B(e){W=e}function E(){return W}function H(){if(i&&(i=!1),!(W>=g.getConstants().VIDEO_STATE_STARTING)){B(g.getConstants().VIDEO_STATE_STARTING),uiAgent.updateVideoButton(!1);var o=k();o.video.deviceId?(commonModule.DeviceMgr.getInstance().setInMeetingUsingDeviceByKind("videoinput",o.video.deviceId),navigator.mediaDevices.getUserMedia(o).then(videoSuccess2).catch(function(e){return videocontrol.openMediaError(e,{constraints:o,successCb:videoSuccess2,failCb:videoFailure})})):videoFailure(new Error("no any device"))}}function D(){g.getConstants().VIDEO_STATE_START===W&&(B(g.getConstants().VIDEO_STATE_CLOSE),F(),uiAgent.updateVideoButton(!0),common.postMessageToNaCl({type:"video",command:"video.stopSendMyVideo"}),stopVideoTrack())}function P(o){winMgr.createWindow("settingWindow","build/window/settingWindow.html",{width:680,height:600},function(e){o&&e.contentWindow.setActiveSettingTab(o)})}function V(){var e=commonModule.DeviceMgr.getInstance().getInMeetingUsingDeviceByKind("audioinput");if(e){var o={},t=e.deviceId;t=commonModule.DeviceMgr.getInstance().changeContraintsDeviceIdToDefault(e),o.audio=Object.assign({},u(),{optional:[{sourceId:t}]}),U(o)}else U()}function U(e){if(e||((e={}).audio=u()),g.getMeetingStatusObj().meetingIsViewOnly);else{if(e.audio&&e.audio.optional&&e.audio.optional[0]){var o=e.audio.optional[0].sourceId;commonModule.DeviceMgr.getInstance().setInMeetingUsingDeviceByKind("audioinput",o)}navigator.mediaDevices.getUserMedia(e).then(function(e){audioSuccess(e),client.updateDevicesListUI()}).catch(audioFailure)}hideAudio(),showMute(),common.postMessageToNaCl({type:"audio",command:"audio.start"}),startGetMicLevel()}var j,R=!1,x=null;function L(o){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,e=2<arguments.length&&void 0!==arguments[2]&&arguments[2];if(!R&&g.getConstants().VIDEO_STATE_START===W)if(R=!0,$(".videoImg").hasClass("img-stopvideo")||e){common.postMessageToNaCl({type:"video",command:"video.stopSendMyVideo"}),stopVideoTrack();var n=k(o);commonModule.DeviceMgr.getInstance().setInMeetingUsingDeviceByKind("videoinput",o),navigator.mediaDevices.getUserMedia(n).then(function(e){return function(e,o){if(g.getConstants().VIDEO_STATE_CLOSE===W){if(stopVideoTrack(),void 0!==e){var t=e.getVideoTracks()[0];"ended"!=t.readyState&&t.stop()}return void(R=!1)}saveToLocal("lastCameraDeviceId",o),n=videoStream,x=n,assignNewVideoTrack(e),client.updateDevicesListUI(),common.postMessageToNaCl({type:"video",command:"video.startSendMyVideo",track:videoStream.getVideoTracks()[0],mirrorEffect:getMirrorEffect()}),R=!1,checkOldVideoCaptureWorkswell();var n}(e,o)}).catch(function(e){return function(e){if(!e)return;saveToLocal("lastCameraDeviceId",e),R=!1}(t)})}else R=!1}function F(){if(x){var e=x.getVideoTracks()[0];"ended"!=e.readyState&&e.stop()}R=!1,x=null}function G(){common.addShortLine(g.getMeetingStatusObj().meetingNo);$(".meeting-id").text(common.addShortLine(g.getMeetingStatusObj().meetingNo))}function Y(e){e?$(".navi").removeClass("hideMe"):$(".navi").addClass("hideMe")}function K(){common.postMessageToNaCl({type:"conf",command:"conf.canStartCMRCheck"})}function z(){common.postMessageToNaCl({type:"conf",command:"conf.BO.getAllBOInfo"})}function X(e){common.postMessageToNaCl({type:"conf",command:"conf.CC.changeCCEditor",userID:Number(e)})}function q(){common.postMessageToNaCl({type:"conf",command:"conf.CC.canShowCCButton"})}function Q(){toolbar.showToolbarIcon("cc",!0)}function J(){ne(),toolbar.showToolbarIcon("cc",!1)}function Z(){$(".close-caption").find("i").removeClass("img-cc-disable").addClass("img-cc-enable"),m.availableCC=!0}function ee(){$(".close-caption").find("i").removeClass("img-cc-enable").addClass("img-cc-disable"),m.availableCC=!1,m.ccMsgStatus="c"}function oe(){var o,t,n,e,i,a,s=myStatusObject.id,c=m.initialCCTitleAttendees,r=CCStatusObject.isMyself,d=-1!==$.inArray(s,c),l=CCStatusObject.canShowCCButton,u=me();l?(Q(),e=CCStatusObject.isMyself,i=m.hasPriviageChanged,a=myStatusObject.isHost,ie(),i&&e&&!a&&setTimeout(function(){var e;e=se(),ue(),ae({content:"The host has assigned you to type Closed Caption.",needClose:!0,pos:e,fn:function(){ne(),client.openTyperWin(),Z()}}),client.showAssignToWin()},20),r||d||(u?(n="Closed Caption is available.",$(".webinar-cc").removeClass("forceHide"),util.deferTodo(function(){$(".webinar-cc").position();var e=mainAppChromeWindow.isFullscreen(),o={left:45,top:e?55:85};ae({content:n,needClose:!0,pos:{left:o.left,top:o.top},direction:"up",fn:function(){var e=m.availableCC=!0;ie(),ge(e),re()}})},0)):(o=m.initialCCTitleAttendees,t=myStatusObject.id,setTimeout(function(){var e=se();ae({content:"Closed Caption is available.",needClose:!0,pos:e,fn:function(){ie(),re(),Z()}}),o.push(t)},20)),client.showSharingTooltipForCCReceived())):(J(),ne(),closeWindow("typerWin"),$.grep(c,function(e,o){return e!==s}))}function te(){closeWindow("typerWin"),ee()}function ne(){ie(),ue(),clearTimeout(m.ccMsgTimeoutVar)}function ie(){$(".cc-tooltip").hasClass("hideMe")||(clearTimeout(m.ccMsgTimeoutVar),$(".cc-tooltip").off().addClass("hideMe"))}function ae(e){var o,t=$(".cc-tooltip-close"),n=$(".cc-tooltip").find(".cc-tooltip-inner");"up"===e.direction&&$(".cc-bottom-arrow").removeClass("cc-bottom-arrow").addClass("cc-up-arrow"),(o={content:e.content,needClose:e.needClose,duration:e.duration||0,pos:e.pos||{left:0,top:0},fn:$.isFunction(e.fn)?e.fn:null}).fn&&n.off().on("click",function(){o.fn.call()}),o.needClose?t.click(function(){ie()}):t.remove(),n.text(o.content).end().css({left:o.pos.left,top:o.pos.top}).removeClass("hideMe"),n.focus(),o.duration&&(m.ccMsgTimeoutVar=util.deferTodo(function(){ie()},o.duration))}function se(){var e;return toolbar.show(),e={},$(".close-caption").hasClass("forceHide")?$(".toolbar .more").hasClass("forceHide")?($(".cc-bottom-arrow").addClass("forceHide"),e.left=$("body").width()/2):(e.left=$(".toolbar .more").position().left-25,$(".cc-bottom-arrow").removeClass("forceHide")):(e=$(".close-caption").position(),$(".cc-bottom-arrow").removeClass("forceHide")),{left:e.left-92,top:$("body").height()-135}}function ce(){$(".cc-option").addClass("hideMe")}function re(e,o){var t,n,i,a,s,c=CCStatusObject.isMyself,r=e||((t=m.ccMsg).length?t[t.length-1]:""),d=$.isFunction(o)?o:null;r&&(c?client.showCCMsgInCCTyperWin(r):(d&&$(".cc-msg").off().one("click",function(){d.call()}),ie(),n=r,"c"===m.ccMsgStatus?(a=n,$(".cc-msg").removeClass("hideMe"),$(".cc-msg-btn").removeClass("visibility-hidden"),le(),$(".cc-content").blur(),$(".cc-content").text(a),accessibility.focusWithoutOutline(".cc-content"),$(".cc-msg-list").off().addClass("hideMe"),m.ccMsgStatus="c",clearTimeout(m.ccMsgTimeoutVar),m.ccMsgTimeoutVar=util.deferTodo(function(){$(".cc-msg").addClass("hideMe")})):(i=m.ccMsg,clearTimeout(m.ccMsgTimeoutVar),$("#cc_typer_temp").siblings().remove(),$.each(i,function(e,o){$("#cc_typer_temp").clone().removeAttr("id").text(o).removeClass("hideMe").appendTo(".cc-list-inner")}),$(".cc-list-inner").addClass("cc-list-inner-expand"),accessibility.focusWithoutOutline(".cc-list-inner"),de(),$(".cc-msg-list").removeClass("hideMe"),$(".cc-msg").off().addClass("hideMe"),m.ccMsgStatus="e"),s="c"===m.ccMsgStatus?".cc-msg":".cc-msg-list",$(s).off().hover(function(){$(".cc-msg-btn").removeClass("visibility-hidden"),le()},function(){$(".cc-msg-btn").addClass("visibility-hidden").off("click")})))}function de(){$(".cc-list-inner").scrollTop(1e3)}function le(){$(".cc-msg-btn").off("click").on("click",function(){m.ccMsgStatus="c"===m.ccMsgStatus?"e":"c",re()})}function ue(){clearTimeout(m.ccMsgTimeoutVar),$(".cc-msg, .cc-msg-list").addClass("hideMe")}function me(){var e=g.getMeetingStatusObj();return e.isWebinar&&e.meetingIsViewOnly}function ge(e){e?$("#webinar_cc").addClass("webinar-cc-enable"):$("#webinar_cc").removeClass("webinar-cc-enable")}function fe(){return!myStatusObject.isHost&&!myStatusObject.isCoHost&&s.isParticipantsChooseRoomEnabled}function pe(){return"-1"===s.boControlStatus.toString()&&!s.allBOInfo.boItems.length}function he(){return"3"!==s.boControlStatus.toString()&&g.getMeetingStatusObj().inBO}function Ce(){return"2"===s.boControlStatus.toString()||"-1"===s.boControlStatus.toString()&&g.getMeetingStatusObj().inBO}function ve(){return"4"===s.boControlStatus.toString()}function be(){return"3"===s.boControlStatus.toString()}function we(){$("li.bo").find(".atteedeetext").addClass("forceHide").off("click").end().find(".hosttext").removeClass("forceHide").end(),$(".toolbar .webinar-more .bo-more-text").text($("li.bo .hosttext").text()),toolbar.showToolbarIcon("bo",!0)}function Me(){$("li.askForHelp").off("click"),toolbar.showToolbarIcon("askforhelp",!1)}function Se(){return"ASSIGNED_NOT_JOINED"===s.myBOStatus}function Ie(){s.attendees=[],s.unassignAttendees=[],s.boRooms=[],s.myBOStatus=""}function Te(e){var o,t;s.allBOInfo.unassignedBoUsers=(t=[],(o=e)&&(_.forIn(o,function(e,o){t.push(e)}),t.shift()),t)}function ye(e){var o,t=[];e&&_.forIn(e,function(e,o){o.startsWith("BOItem")&&t.push(e)}),o=t,_.forIn(o,function(t,e){var n=[];_.forIn(t,function(e,o){o.startsWith("BOUserItem")&&(n.push(e),delete t[o])}),t.BOUserItems=n}),s.allBOInfo.boItems=t}function Oe(e){var o=$(".bo").find(".bo-badge");myStatusObject.isHost?(0<e?o.removeClass("forceHide").text(e):o.addClass("forceHide").text(""),o=null):o.addClass("forceHide").text("")}var Ae=null,Ne=null;function ke(e){var o=e>>10<<10;if(0!==$("#listener>#attendee_"+o).length)return!0;if(0!==$("#listener>#activeSpeaker_"+o).length)return!0;var t=!1;if(He.screenVideoUIStatus&&1<He.screenVideoUIStatus.length)for(var n=1;n<He.screenVideoUIStatus.length;n++){var i=He.screenVideoUIStatus[n];if(i.viewRenderType===g.getConstants().SINGLE_VIDEO_VIEW)t=Ve(i.activeView?i.activeView.userID:0)===o;else if(i.viewRenderType===g.getConstants().GALLERY_VIEW)for(var a=i.galleryView||[],s=0;s<a.length;s++){if(t=Ve(a[s])===o)break}if(t)break}return t}function We(){return!$(".whos-talking-prompt").hasClass("forceHide")}function $e(){Ne&&(clearTimeout(Ne),Ne=null),Ae&&(clearTimeout(Ae),Ae=null),Ne=setTimeout(function(){for(var e=He.talkingUsers,o=(Ue(),0),t=0;t<e.length;t++){var n=e[t];Pe(n)||(ke(n)||0===o&&(o=n))}if(0!==o){var i=getAttendeeObject(o,!0);if(i){var a=$(".whos-talking-prompt>img.avatar").attr("id","zrTalking"+o);""==i.smallPicUrl&&""==i.bigPicUrl?showDefaultAvatar(i,a[0]):i.picBlobUrlSmall?a.attr("src",i.picBlobUrlSmall):showAvatarXhr(!0,i.smallPicUrl,showSmallAvatar,i,a[0]),$(".whos-talking-prompt").removeClass("forceHide"),$(".whos-talking-prompt>.name").html(util.htmlEncode(i.name)),Ee(je()),Ae=setTimeout(function(){Be()},3e3)}}else Be()},500)}function Be(){We()&&$(".whos-talking-prompt").addClass("forceHide"),Ne&&(clearTimeout(Ne),Ne=null),Ae&&(clearTimeout(Ae),Ae=null)}function Ee(e){We()&&(0===e?($(".whos-talking-prompt").removeClass("whos-talking-right"),$(".whos-talking-prompt").addClass("whos-talking-left")):($(".whos-talking-prompt").removeClass("whos-talking-left"),$(".whos-talking-prompt").addClass("whos-talking-right")))}var He={activeUserID:0,talkingUsers:0,showingActiveFrameUserID:0,videoMode:0,isSharing:!1,isThumbVideoShowingForSpeakerView:!1,thumbVideoDisplayPostion:-1,spotlightMode:!1,isLocalShare:!1,isPSTNCallout:!1,inWaitingRoom:!1,isPining:!1,videoIsDrawing:!1,screenVideoUIStatus:null};function De(e,o){return e>>10==o>>10}function Pe(e){var o=getAttendeeObject(e,!0);return!!o&&!!o.isMyself}function Ve(e){return e>>10<<10}function Ue(){return He.activeUserID}function _e(e,o){if(0===e)$(".attendee").removeClass("current-active-speaker-thumbnail"),$(".attendee").removeClass("current-active-speaker-gallery");else if(o===g.getConstants().VIDEO_MODE_THUMBNAIL||o===g.getConstants().VIDEO_MODE_SPEAKER)$(".attendee").removeClass("current-active-speaker-gallery"),0===$(".current-active-speaker-thumbnail").length?$("#attendee_"+Ve(e)).addClass("current-active-speaker-thumbnail"):De(He.showingActiveFrameUserID,e)||($(".attendee").removeClass("current-active-speaker-thumbnail"),$("#attendee_"+Ve(e)).addClass("current-active-speaker-thumbnail"));else if(o===g.getConstants().VIDEO_MODE_GALLERY){$(".attendee").removeClass("current-active-speaker-thumbnail"),0===$(".current-active-speaker-gallery").length?$("#attendee_"+Ve(e)).addClass("current-active-speaker-gallery"):De(He.showingActiveFrameUserID,e)||($(".attendee").removeClass("current-active-speaker-gallery"),$("#attendee_"+Ve(e)).addClass("current-active-speaker-gallery"))}He.showingActiveFrameUserID=e}function je(){return He.videoMode===g.getConstants().VIDEO_MODE_SPEAKER&&He.isThumbVideoShowingForSpeakerView&&3===He.thumbVideoDisplayPostion?0:1}function Re(e){if(e&&(He.videoMode=e.mode,He.isSharing=e.isSharing,He.isThumbVideoShowingForSpeakerView=e.isThumbVideoShowingForSpeakerView,He.thumbVideoDisplayPostion=e.thumbVideoDisplayPostion,He.spotlightMode=e.spotlightMode,He.isLocalShare=e.isLocalShare,He.isPSTNCallout=e.isPSTNCallout,He.videoIsDrawing=!0,He.isPining=e.isPining),He.videoIsDrawing){if(He.inWaitingRoom)return _e(0),void Be();He.videoMode!=g.getConstants().VIDEO_MODE_GALLERY&&Be(),!function(){if(He.videoMode===g.getConstants().VIDEO_MODE_THUMBNAIL||He.videoMode===g.getConstants().VIDEO_MODE_SPEAKER){if($(".attendee").length<=1)return!1;if(He.videoMode===g.getConstants().VIDEO_MODE_SPEAKER)return!0;if(He.isSharing)return!0;if(He.isPining)return!0;if(Pe(Ue()))return!0}else if(He.videoMode===g.getConstants().VIDEO_MODE_GALLERY)return!0;return!1}()?_e(0):_e(Ue(),He.videoMode)}}function xe(){common.postMessageToNaCl({type:"conf",command:"conf.webinarBroadcast"})}return{reConfigureVideoTrack:function(){videoTrack&&"ended"!==videoTrack.readyState&&("user"!==videoTrack.getSettings().facingMode&&"environment"!==videoTrack.getSettings().facingMode||L(videoTrack.getSettings().deviceId,!0))},zoomInOutThumbVideo:function(e,o,t,n){common.postMessageToNaCl({type:"video",command:"video.zoomInOutThumbVideo",left:e,top:o,width:t,height:n})},moveThumbVideoPosition:function(e,o){common.postMessageToNaCl({type:"video",command:"video.moveThumbVideoPosition",oldX:e.x,oldY:e.y,newX:o.x,newY:o.y})},needAutoStartMyVideo:function(){return!g.getMeetingStatusObj().meetingIsViewOnly&&!g.getMeetingStatusObj().isLocalShareMeeting&&!(!meetingAutoStartMyVideo&&!g.getMeetingStatusObj().startMeetingByMySelf||!g.getMeetingStatusObj().isVideoOn)},switch2FloatShare:function(e){common.postMessageToNaCl({type:"video",command:"video.switch2FloatShare",floatShare:!!e})},pinUser:function(e,o){common.postMessageToNaCl({type:"video",command:"video.pinUser",userID:e,screenIndex:o||0})},unpinUser:function(e,o){common.postMessageToNaCl({type:"video",command:"video.unpinUser",userID:e,screenIndex:o||0})},updateThumbVideoInfo:function(e){He.isThumbVideoShowingForSpeakerView=0!==e.size,He.thumbVideoDisplayPostion=e.position,Ee(je())},resetCanSwitch2Gallery:function(e){backgroundWindow.isKioskApp()&&kiosk.disableSwitchToGalleryView(e?0:1)},resetUIStatus:function(){He={activeUserID:0,talkingUsers:0,showingActiveFrameUserID:0,videoMode:0,isSharing:!1,isThumbVideoShowingForSpeakerView:!1,thumbVideoDisplayPostion:-1,spotlightMode:!1,isLocalShare:!1,isPSTNCallout:!1,isSilentMode:!1,isPining:!1,videoIsDrawing:!1,screenVideoUIStatus:null},_e(0),Be()},updateActiveUser:function(e){He.activeUserID=e,Re(null)},updateTalkingUser:function(e){e&&0!==e.length&&(He.talkingUsers=e,function(){if(He.isPSTNCallout||He.isLocalShare)return Be();$e()}(),Ee(je()))},updateScreenVideoUIStatus:function(e){He.screenVideoUIStatus=e},updateVideoUIStatus:Re,updateMyVideoState:B,getMyVideoState:E,switchCameraComplete:F,toggleThumbVideoMode:function(e){e=e||0,common.postMessageToNaCl({type:"video",command:"video.toggleThumbVideoMode",mode:e})},toggleThumbVideoPostion:function(e){e=e||3,common.postMessageToNaCl({type:"video",command:"video.toggleThumbVideoPostion",position:e})},switchHideMyVideo:function(e){e=e||!1,common.postMessageToNaCl({type:"video",command:"video.switchHideMyVideo",hideMyVideo:e})},enableMirrorEffect:function(e){e=e||!1,common.postMessageToNaCl({type:"video",command:"video.enableMirrorEffect",enableMirror:e})},switchHideNonVideo:function(e){e=e||!1,common.postMessageToNaCl({type:"video",command:"video.switchHideNonVideo",hideNonVideo:e})},getGmailInviteInfo:function(e){callbackMap[callbackId]=e,common.postMessageToNaCl({type:"user",command:"user.getGmailInviteInfo",id:callbackId}),callbackId++},getYahooInviteInfo:function(e){callbackMap[callbackId]=e,common.postMessageToNaCl({type:"user",command:"user.getYahooInviteInfo",id:callbackId}),callbackId++},getCopyInviteInfo:function(e){callbackMap[callbackId]=e,common.postMessageToNaCl({type:"user",command:"user.getCopyInviteInfo",id:callbackId}),callbackId++},joinPhone:function(){hideAudio(),showPhone()},joinAudio:V,leaveAudio:function(){common.postMessageToNaCl({type:"audio",command:"audio.leave"})},showUserSettingWindow:P,saveTelephoneUserNum:function(){for(var e=0,o=0;o<attendeeList.length;o++)attendeeList[o].isTelephoneUser&&e++;telephoneUserNum=e},stopAudio:function(){stopGetMicLevel(),stopAllAudioTracks(),showAudio(),hideMute(),hidePhone()},bindEvent:function(){uiAgent.meetingUIInit(),g.getMeetingStatusObj().isWebinar&&g.getMeetingStatusObj().meetingIsViewOnly||uiAgent.initToolbar(),G(),$("#listener").css("z-index",5),$("#listener").dblclick(function(){mainAppChromeWindow.isFullscreen()?w():v()}),$(".screen-mode").off("click").click("click",function(e){$(this).find(".forceHide").hasClass("img-fullscreen")?w():v()}),client.bindVideoToolbarEvt(),$(".statistics-info").off("click").click("click",function(e){P()}),$(".switch-view").off("click").click(function(e){"speakerview"==$(this).find("span").attr("data-name")?S():M()}),$(".conf-encryption").off("click").on("click",function(e){e.stopPropagation(),window.eev.emit(g.getConstants().INMEETING_INFO_WINDOW.SHOW)}),$(".turnpage-button-group").undelegate().delegate("a","click",function(e){e.stopPropagation(),"prev"==$(this).attr("data-name")?$(this).closest(".left").hasClass("enabled")&&T():"next"==$(this).attr("data-name")&&$(this).closest(".right").hasClass("enabled")&&I()}).delegate("a","keyup",function(e){"Enter"===e.key&&$(this).click()}).delegate("a","dblclick",function(e){e.stopPropagation()}),$("#video-mode").delegate("i","click",function(e){$(this).hasClass("img-hidevideo")?($(".img-hidevideo").addClass("forceHide"),$(".img-showvideo").removeClass("forceHide")):($(".img-hidevideo").removeClass("forceHide"),$(".img-showvideo").addClass("forceHide"))}),client.TalkingUserBar.addEventListener(),b="float-video-container",$("html").off("pointerdown",".userlist-mode, ."+b).on("pointerdown",".userlist-mode, ."+b,function(e){var c,o,r,t,d,l,u,m,f,p,n,h=$(this);if((n=e).target.classList.contains("crop-line")||n.target.classList.contains("crop-corner"))return c=h,r=(o=e).target.dataset.dir,t=$("#html"),d=c.width(),l=c.height(),u=c.offset().top,m=c.offset().left,f=o.pageX,p=o.pageY,t.off("pointermove").on("pointermove",function(e){var o={x:Math.round(e.pageX-f),y:Math.round(e.pageY-p)},t=function(e){var o=16/9,t=g.getConstants().FLOAT_VIDEO_MIN_WIDTH,n=g.getConstants().FLOAT_VIDEO_MAX_WIDTH,i=e.videoWidth,a=e.videoHeight,s=e.videoTop,c=e.videoLeft,r=e.direction,d=e.vector,l=i,u=a,m=s,f=c;switch(r){case"r":u=i+d.x>n?(l=n)/o:i+d.x<t?(l=t)/o:(l=i+d.x,a+d.x/o);break;case"d":case"rd":u=i+d.y*o>n?(l=n)/o:i+d.y*o<t?(l=t)/o:(l=i+d.y*o,a+d.y);break;case"u":case"ru":m=i-d.y*o>n?s-((u=(l=n)/o)-a):i-d.y*o<t?s-((u=(l=t)/o)-a):(l=i-d.y*o,u=a-d.y,s+d.y);break;case"l":f=i-d.x>n?(u=(l=n)/o,c-(l-i)):i-d.x<t?(u=(l=t)/o,c-(l-i)):(l=i-d.x,u=a-d.x/o,c+d.x);break;case"ld":f=i+d.y*o>n?(u=(l=n)/o,c-(l-i)):i+d.y*o<t?(u=(l=t)/o,c-(l-i)):(l=i+d.y*o,u=a+d.y,c-d.y*o);break;case"lu":m=i-d.y*o>n?(f=c-((l=n)-i),s-((u=n/o)-a)):i-d.y*o<t?(f=c-((l=t)-i),s-((u=t/o)-a)):(l=i-d.y*o,u=a-d.y,f=c+d.y*o,s+d.y)}return{tWidth:l,tHeight:u,tLeft:f,tTop:m}}({videoHeight:l,videoWidth:d,videoTop:u,videoLeft:m,direction:r,vector:o}),n=t.tWidth,i=t.tHeight,a=t.tTop,s=t.tLeft;$(".userlist-mode").css({width:n+4,top:a-30,left:s-2}),c.css({height:i,width:n,top:a,left:s}),commonModule.setFloatVideoCachePosition({height:i,width:n,top:a,left:s})}),void t.off("pointerup").on("pointerup",function(e){t.unbind("pointermove pointerup"),t=null});if(e.originalEvent.isPrimary){var i=h.offset().left,a=h.offset().top;h.hasClass("userlist-mode");var C=e.pageX-i,v=e.pageY-a,s=$("html");s.off("pointermove").on("pointermove",function(e){if(e.originalEvent.isPrimary&&void 0!==h.offset()){var o=h.css("marginLeft").replace("px",""),t=h.css("marginTop").replace("px",""),n=e.pageX-C-o,i=e.pageY-v-t,a=30;h.hasClass("userlist-mode")&&(a=0);var s=-o,c=mainAppChromeWindow.innerBounds.width-h.width()-o,r=a-t,d=$("."+b).length?$("."+b).height():120,l=mainAppChromeWindow.innerBounds.height-d-t;n<s?n=s:c<n&&(n=c),i<r?i=r:l<i&&(i=l),h.hasClass("userlist-mode")?(h.css({top:i,left:n}),$("."+b).css({top:i+30,left:n+2}),commonModule.setFloatVideoCachePosition({top:i+30,left:n+2})):($(".userlist-mode").css({top:i-30,left:n-2}),h.css({top:i,left:n}),commonModule.setFloatVideoCachePosition({top:i,left:n}))}}),s.off("pointerup pointercancel").on("pointerup pointercancel",function(e){e.originalEvent.isPrimary&&(s.off("pointermove pointerup pointercancel"),s=h=null)})}}),$("#dummyShare").resize(function(e){var o=document.getElementById("dummyShare").videoWidth,t=document.getElementById("dummyShare").videoHeight;common.postMessageToNaCl({type:"share",command:"share.newSize",width:o,height:t})}),$(".screen-mode, .statistics-info, .switch-view, #video-mode, .inmeeting-info, .conf-encryption, .bandwidth-limit, .userlist-mode, .div-video-toolbar").off("dblclick").on("dblclick",function(e){e.stopPropagation()}),$(".defbtn").off("click").on("click",function(){client.openTyperWin(),X(myStatusObject.id),Z(),$(".cc-option").addClass("hideMe")}),$(".infobtn").off("click").on("click",function(){$("#participant-panel").hasClass("hideMe")&&client.showParticipantList(),ee(),$(".cc-option").addClass("hideMe")}),$(".waitingRoomNotice").delegate(".button","click",function(){var e=$(this).data("name");if("admit"==e){var o=0;g.getMeetingStatusObj().waitingUserList[0]&&(o=g.getMeetingStatusObj().waitingUserList[0].userID),0!=o&&mainAppHtmlWindow.inmeeting.userLeaveSilentmode(o),$(".waitingRoomNotice").addClass("forceHide")}else"showParticipants"==e&&($(".toolbar li.participant").click(),$(".waitingRoomNotice").addClass("forceHide"))}),e(),K(),q();var b},leaveMeeting:function(){backgroundWindow&&backgroundWindow.setNormalExit(),common.postMessageToNaCl({type:"user",command:"user.leaveConf"}),setTimeout(function(){isNaClReloaded||reloadJoinMeetingPageandNaClModule()},5e3)},cancelJoin:function(){common.postMessageToNaCl({type:"user",command:"user.cancelJoinConf"})},endMeeting:function(){backgroundWindow&&backgroundWindow.setNormalExit(),common.postMessageToNaCl({type:"conf",command:"conf.termConf"}),setTimeout(function(){isNaClReloaded||reloadJoinMeetingPageandNaClModule()},5e3)},showNotice:function(e){var o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;clearTimeout(j),$(".notice").text(e).css({"z-index":o?30:-30}).show(),n&&!backgroundWindow.isKioskApp()&&accessibility.focusWithoutOutline(".notice"),j=window.setTimeout(function(){$(".notice").hide()},5e3)},initAudioStatus:function(){g.getMeetingStatusObj().isSupportVoip&&V()},initVideoStatus:function(){B(g.getConstants().VIDEO_STATE_STARTING),uiAgent.updateVideoButton(!1);var o=k();o.video.deviceId?(commonModule.DeviceMgr.getInstance().setInMeetingUsingDeviceByKind("videoinput",o.video.deviceId),navigator.mediaDevices.getUserMedia(o).then(function(e){videoSuccess(e),client.updateDevicesListUI()}).catch(function(e){return videocontrol.openMediaError(e,{constraints:o,successCb:videoSuccess,failCb:videoFailure})})):videoFailure(null)},showMeetingNo:G,fullScreen:v,onWindowFullScreened:function(){$("#outsideMeeting").hasClass("forceHide")?($(".winbar").hide(),$(".statistics-info, .switch-view, .screen-mode").addClass("full-screen"),$(".img-fullscreen").addClass("forceHide"),$(".img-restorescreen").removeClass("forceHide"),Y(0)):$(".winbar .window-maxmize").addClass("forceHide"),client.disableMergeToWindow(!0)},onWindowMaximized:function(){0!=g.getMeetingStatusObj().meetingNo&&(w(),v())},restorScreen:w,minimize:function(){mainAppChromeWindow.minimize()},setShareUserName:C,refreshUserDisplayName:function(e,o){$(".name_"+e).text(o.name),g.getMeetingStatusObj().activeShareUserId>>10==e>>10&&C(o.name)},stopMyVideo:D,showMuteIcon:function(e,o,t){var n=o>>10<<10,i=$("[id^='attendee_"+n+"']");"AUDIO_TELEPHONY"==t?(e?(i.find("i.img-listPhoneOff").removeClass("forceHide"),$("#activeSpeaker_"+n).find("i.img-listPhoneOff").removeClass("forceHide")):(i.find("i.img-listPhoneOff").addClass("forceHide"),$("#activeSpeaker_"+n).find("i.img-listPhoneOff").addClass("forceHide")),i.find("i.img-listAudioOff").addClass("forceHide"),$("#activeSpeaker_"+n).find("i.img-listAudioOff").addClass("forceHide")):"AUDIO_VOIP"==t?(e?(i.find("i.img-listAudioOff").removeClass("forceHide unmute-icon"),$("#activeSpeaker_"+n).find("i.img-listAudioOff").removeClass("forceHide unmute-icon")):(i.find("i.img-listAudioOff").removeClass("forceHide").addClass("unmute-icon"),$("#activeSpeaker_"+n).find("i.img-listAudioOff").removeClass("forceHide").addClass("unmute-icon")),i.find("i.img-listPhoneOff").addClass("forceHide"),$("#activeSpeaker_"+n).find("i.img-listPhoneOff").addClass("forceHide")):"AUDIO_NONE"==t&&(i.find("i.img-listAudioOff").addClass("forceHide"),$("#activeSpeaker_"+n).find("i.img-listAudioOff").addClass("forceHide"),i.find("i.img-listPhoneOff").addClass("forceHide"),$("#activeSpeaker_"+n).find("i.img-listPhoneOff").addClass("forceHide"))},showNetworkBandwidth:function(e,o){$("#activeSpeaker_"+(o>>10<<10)).find("i.img-bandwidth").removeClass().addClass("img-bandwidth img-sprite").addClass(e)},startShare:function(){forceStartShare?client.showChooseShareSourceWindow():common.postMessageToNaCl({type:"share",command:"share.canStartShare"})},stopShare:N,pauseShare:function(){common.postMessageToNaCl({type:"share",command:"share.pauseShare"})},resumeShare:function(){common.postMessageToNaCl({type:"share",command:"share.resumeShare"})},onShareCheckPassed:function(){if(shareStream&&shareStream.active){var e=mainAppHtmlWindow.winMgr.getWinByWinId("shareMainWindow");e&&e.contentWindow.onShareCheckPassed()}else client.showChooseShareSourceWindow()},showSystemChooseShareWindow:function(e){mainAppChromeWindow.focus(),A(e[0]),chrome.desktopCapture.chooseDesktopMedia(e,h)},rePostionShareWindow:function(){var e=winMgr.getWinByWinId("shareMainWindow");e&&e.contentWindow.positionShareWindow()},mute:function(){common.postMessageToNaCl({type:"audio",command:"audio.muteSelf"})},renameUser:function(e,o,t){common.postMessageToNaCl({type:"conf",command:e,userId:Number(o),name:t})},startMyVideo:H,toggleMyVideo:function(){if(!g.getMeetingStatusObj().meetingIsViewOnly)if($(".videoImg").hasClass("img-stopvideo"))D();else{if(myStatusObject.isHost||myStatusObject.isCoHost)return void H();if(myStatusObject.videoMuteByHost||myStatusObject.videoMuteByCoHost){var e="You can't start your video because the host has stopped it.";return myStatusObject.videoMuteByCoHost&&(e="You can't start your video because the co-host has stopped it."),void uiAgent.showMeetingAlert(e)}H()}},sendHostCommand:function(e,o){common.postMessageToNaCl({type:"conf",command:e,userId:Number(o)})},unmuteAll:function(){common.postMessageToNaCl({type:"conf",command:"conf.unmuteAll"})},askAllToUnmute:function(){common.postMessageToNaCl({type:"conf",command:"conf.isAskAllToUnmuteAvailable"})},muteAll:function(e){common.postMessageToNaCl({type:"conf",command:"conf.muteAll",allowUnmute:e})},reclaimHost:function(){common.postMessageToNaCl({type:"conf",command:"conf.claimHost"})},sendHostLockCommand:function(e,o){common.postMessageToNaCl({type:"conf",command:e,lock:o})},sendHostMuteEntryCommand:function(e){g.getMeetingStatusObj().isMuteOnEntryOn=e,common.postMessageToNaCl({type:"conf",command:"conf.setMuteOnEntry",muteOnEntry:e})},setupShareAreaMovePicture:function(e,o){"original"==$("#shareScreenSizeFlag").val()&&o?($("#shareArea").css("cursor","-webkit-grab"),$("#shareArea").unbind("mousedown").mousedown(function(e){$("#shareArea").css("cursor","-webkit-grabbing"),client.autoShow(0);var n=e.clientX,i=e.clientY;$("html").unbind("mousemove").mousemove(function(e){var o=e.clientX,t=e.clientY;a=!0,common.postMessageToNaCl({type:"share",command:"share.movePicture",oldX:n,oldY:i,newX:o,newY:t}),n=o,i=t})}),$("#shareArea").unbind("mouseup").mouseup(function(e){$("#shareArea").css("cursor","-webkit-grab"),a=!1,inmeeting.shortcutsStatus.autoShowUI&&client.autoShow(1),$("html").unbind("mousemove")}),("ontouchstart"in document||"ontouchstart"in window||0<navigator.maxTouchPoints)&&($("#shareArea").unbind("touchstart").bind("touchstart",function(e){var n=e.originalEvent.changedTouches[0].clientX,i=e.originalEvent.changedTouches[0].clientY;$("html").unbind("touchmove").bind("touchmove",function(e){var o=e.originalEvent.changedTouches[0].clientX,t=e.originalEvent.changedTouches[0].clientY;o!=n&&t!=i&&(a=!0,client.autoShow(0),common.postMessageToNaCl({type:"share",command:"share.movePicture",oldX:n,oldY:i,newX:o,newY:t}),n=o,i=t)})}),$("#shareArea").unbind("touchend").bind("touchend",function(e){a?a=!1:inmeeting.shortcutsStatus.autoShowUI&&client.autoShow(1),$("html").unbind("touchmove"),e.preventDefault()}))):($("#shareArea").css("cursor",""),$("#shareArea").unbind("mousedown").unbind("mouseup"),$("#shareArea").unbind("touchstart").unbind("touchend"),a=!1)},getOverallStat:function(){common.postMessageToNaCl({type:"conf",command:"conf.getStat",statType:"overall"})},getAudioStat:function(){common.postMessageToNaCl({type:"conf",command:"conf.getStat",statType:"audio"})},getVideoStat:function(){common.postMessageToNaCl({type:"conf",command:"conf.getStat",statType:"video"})},getShareStat:function(){common.postMessageToNaCl({type:"conf",command:"conf.getStat",statType:"share"})},canStartCMRCheck:K,startCMR:function(e){common.postMessageToNaCl({type:"conf",command:"conf.startCMR",email:e})},stopCMR:function(){common.postMessageToNaCl({type:"conf",command:"conf.stopCMR"})},pauseCMR:function(){common.postMessageToNaCl({type:"conf",command:"conf.pauseCMR"})},resumeCMR:function(){common.postMessageToNaCl({type:"conf",command:"conf.resumeCMR"})},askQAQuestion:function(e,o){common.postMessageToNaCl({type:"conf",command:"conf.QA.addQuestion",question:e,anonymously:o})},answerQAQuestion:function(e,o,t){common.postMessageToNaCl({type:"conf",command:"conf.QA.addAnswer",questionID:e,answer:o,privately:t})},setQaAnonymous:function(e){qaObject.isHostAllowAnonymous=!!e;var o=winMgr.getWinByWinId("qaWin");o&&o.contentWindow.qa.updateHosAllowAnnoymous()},startQALiving:function(e){common.postMessageToNaCl({type:"conf",command:"conf.QA.startLiving",questionID:e})},endQALiving:function(e){common.postMessageToNaCl({type:"conf",command:"conf.QA.endLiving",questionID:e})},raiseHand:function(e){common.postMessageToNaCl({type:"conf",command:"conf.raiseHand",userId:Number(e)})},lowerHand:function(e){common.postMessageToNaCl({type:"conf",command:"conf.lowerHand",userId:Number(e)})},lowerAllHands:function(){common.postMessageToNaCl({type:"conf",command:"conf.lowerAllHands"})},raiseHandInWebinar:function(){common.postMessageToNaCl({type:"conf",command:"conf.raiseHandInWebinar"})},lowerHandInWebinar:function(e){common.postMessageToNaCl({type:"conf",command:"conf.lowerHandInWebinar",userId:Number(e)})},lowerAllHandsInWebinar:function(){common.postMessageToNaCl({type:"conf",command:"conf.lowerAllHandsInWebinar"})},setCheckToAnswer:function(e,o,t,n){common.postMessageToNaCl({type:"conf",command:"conf.polling.setCheckToAnswer",pollingID:e,questionID:o,answerID:t,isChecked:n})},startPoll:function(e){common.postMessageToNaCl({type:"conf",command:"conf.polling.startPoll",pollingID:e})},reopenPoll:function(e){common.postMessageToNaCl({type:"conf",command:"conf.polling.reopenPoll",pollingID:e})},closePoll:function(e){common.postMessageToNaCl({type:"conf",command:"conf.polling.closePoll",pollingID:e})},sharePollResult:function(e){common.postMessageToNaCl({type:"conf",command:"conf.polling.sharePollResult",pollingID:e})},stopSharePollResult:function(e){common.postMessageToNaCl({type:"conf",command:"conf.polling.stopSharePollResult",pollingID:e})},getEditPollingURL:function(){common.postMessageToNaCl({type:"conf",command:"conf.polling.getEditPollingURL"})},submitPoll:function(e){common.postMessageToNaCl({type:"conf",command:"conf.polling.submitPoll",pollingID:e})},saveEditPollingURL:function(e){editPollingURL=e},refreshViewerHand4Plist:function(e,o){util.getViewerObject(o).raiseHandStatus=e,mainAppHtmlWindow.eev.emit(mainAppHtmlWindow.g.getConstants().FEEDBACK.HAND,{type:"viewer",flag:e?1:-1})},refreshPlistHand:function(e,o){var t=getAttendeeObject(o,!0);null!==t&&(t.isRaiseHand=e,t.userFeedback=void 0,mainAppHtmlWindow.eev.emit(mainAppHtmlWindow.g.getConstants().FEEDBACK.HAND,{type:"participant",flag:e?1:-1}))},startCallOut:function(e,o,t){common.postMessageToNaCl({type:"conf",command:"conf.startCallOut",countryCode:e,callOutNumber:o,callOutName:t||""})},hangUp:function(){common.postMessageToNaCl({type:"conf",command:"conf.hangUp"})},cancelInviteByPhone:function(e,o,t){common.postMessageToNaCl({type:"conf",command:"conf.cancelInviteByPhone",callOutName:e||"",countryCode:o||"",callOutNumber:t||""})},getPhoneCallInNumber:function(){common.postMessageToNaCl({type:"conf",command:"conf.getPhoneCallInNumber"})},getTollFreeCallInNumber:function(){common.postMessageToNaCl({type:"conf",command:"conf.getTollFreeCallInNumber"})},saveCallInInfo:function(e){for(var o=[],t=0;t<e.length;t++)o.push(e["countryItem"+t]);o.sort(function(e,o){return e.name<o.name?-1:e.name>o.name?1:0}),callInInfoObject.callInInfoList=o,callInInfoObject.isPSTNPassWordOn=e.isPSTNPassWordOn,callInInfoObject.PSTNPassWord=e.PSTNPassWord,callInInfoObject.defaultCallInCountryCodeID=e.defaultCallInCountryCodeID,mainAppHtmlWindow.callInInfoObject.isTspEnabled=e.isTspEnabled,e.isTspEnabled&&(mainAppHtmlWindow.callInInfoObject.tspInfo=e.tspInfo)},saveCallOutInfo:function(e){for(var o=[],t=0;t<e.length;t++)o.push(e["countryItem"+t]);o.sort(function(e,o){return e.name<o.name?-1:e.name>o.name?1:0}),callOutInfoObject.callOutInfoList=o,callOutInfoObject.defaultCallOutCountryCodeID=e.defaultCallOutCountryCodeID},showCMRConnectingNotice:function(e){e?($(".notice").hide(),"block"!=$(".cmr-connecting-notice").css("display")&&$(".cmr-connecting-notice").css("z-index",30).show(300).delay(3e3).fadeOut(300)):$(".cmr-connecting-notice").css("z-index",30).hide()},expelAttendee:function(e){common.postMessageToNaCl({type:"conf",command:"conf.expelAttendee",userId:Number(e)})},promotePanelist:function(e){common.postMessageToNaCl({type:"conf",command:"conf.promotePanelist",userId:Number(e)})},getPollingWindowHtml:function(){return $("#window-poll").html()},downgradetoAttendee:function(e){common.postMessageToNaCl({type:"conf",command:"conf.downgradetoAttendee",userId:Number(e)})},switchToGalleryView:M,showNextPageVideo:I,showPrePageVideo:T,refreshPageTurnButton4GalleryView:function(e){var o=e.currentPageIndex+1;1<e.totalPageNumber&&e.mode===g.getConstants().VIDEO_MODE_GALLERY?($(".page-info").text(o+"/"+e.totalPageNumber),o<=1?($(".turnpage-button-group .left").removeClass("enabled"),$(".turnpage-button-group .right").addClass("enabled")):o>=e.totalPageNumber?($(".turnpage-button-group .left").addClass("enabled"),$(".turnpage-button-group .right").removeClass("enabled")):($(".turnpage-button-group .left").addClass("enabled"),$(".turnpage-button-group .right").addClass("enabled")),$(".turnpage-button-group").removeClass("forceHide")):$(".turnpage-button-group").addClass("forceHide")},refreshCurrentActiveSpeaker:y,saveCurrentActiveSpeaker:function(e){g.getMeetingStatusObj().currentActiveSpekerUserId=e>>10<<10},switchToActiveSpeakerView:S,forceFreshCurrentView:function(){var e=g.getConstants().VIDEO_MODE_SPEAKER;"speakerview"===$(".switch-view").find("span").attr("data-name")&&(e=g.getConstants().VIDEO_MODE_GALLERY),common.postMessageToNaCl({type:"video",command:"video.switchVideoMode",forceFresh:1,mode:e})},switchVideoMode:function(e){common.postMessageToNaCl({type:"video",command:"video.switchVideoMode",mode:e})},enterWaitingRoom:function(){if(1!=n){E()>=g.getConstants().VIDEO_STATE_STARTING?(O(!0),D()):O(!1),window.eev.emit(g.getConstants().RECORDING_REMINDER,{show:!1});var e=g.getMeetingStatusObj().meetingTopic;g.getMeetingStatusObj().isInWaitingRoom=!0,shareStream&&shareStream.getTracks()[0].stop(),inmeeting.stopShare(),closeShareWindow(),restoreMainWindow(),closeWindow("joinBoWin"),closeWindow("boWin"),client.hideBroadcastMsg(),client.closeUnusedWins(),$(".dl-sidePanel").addClass("hideMe"),mainAppChromeWindow.isFullscreen()&&!0,g.getMeetingStatusObj().isInSharing&&uiAgent.showShareOption(0),participants.isSidePanelShow()&&(participants.hidePanel(),client.showSidePanelResizeUI(!1)),chat.isSidePanelShow()&&(chat.hidePanel(),client.showSidePanelResizeUI(!1)),window.eev.emit(window.g.getConstants().WAITING_ROOM,{show:!0,meetingTopic:e}),client.removeAutoShowUI(),client.showSettingsAndScreenMode(0),client.showSwitchView(0),accessibility.focusWithoutOutline(".waiting_room_main"),n=!0,He.inWaitingRoom=!0,Re()}},outWaitingRoom:function(){0!=n&&($(".dl-sidePanel").removeClass("hideMe"),g.getMeetingStatusObj().isInWaitingRoom=!1,commonModule.rendererMgr.getInstance().onWaitingRoom(0),window.eev.emit(window.g.getConstants().WAITING_ROOM,{show:!1}),toolbar.checkShouldAutoShow(),client.showSettingsAndScreenMode(1),g.getMeetingStatusObj().isInSharing||uiAgent.showSwitchViewAndTurnPage(1),g.getMeetingStatusObj().isInSharing&&uiAgent.showShareOption(1),n=!1,He.inWaitingRoom=!1,Re(),inmeeting.showNotice("You are in the meeting now.",0),client.showBoWaitingToBeAssignedMsg())},setCameraIsOnBeforeEnterWaitingroom:O,getCameraIsOnBeforeEnterWaitingroom:function(){return o},setIsOutWaitingRoom:function(e){t=e},getIsOutWaitingRoom:function(){return t},changeAttendeeChatPriviledge:function(e){common.postMessageToNaCl({type:"conf",command:"conf.changeAttendeeChatPriviledge",attendeeChatPriviledge:Number(e)})},userEnterSilentmode:function(e){common.postMessageToNaCl({type:"conf",command:"conf.userEnterSilentmode",userId:Number(e)})},userLeaveSilentmode:function(e){common.postMessageToNaCl({type:"conf",command:"conf.userLeaveSilentmode",userId:Number(e)})},setPutOnHoldOnEntry:function(e){common.postMessageToNaCl({type:"conf",command:"conf.setPutOnHoldOnEntry",on:Number(e)})},showSmallPic:function(o,e){var t=new XMLHttpRequest;t.open("GET",e,!0),t.responseType="blob",t.onload=function(e){200==t.status&&(getWaitingUserObject(o).picBlobUrlSmall=window.URL.createObjectURL(this.response))},t.onerror=function(e){},t.send()},createBO:function(e){common.postMessageToNaCl({type:"conf",command:"conf.BO.createBO",createBOInfo:e})},updateBO:function(e,o,t){common.postMessageToNaCl({type:"conf",command:"conf.BO.updateBO",BID:e,BOName:o,userGUIDList:t})},removeBO:function(e){common.postMessageToNaCl({type:"conf",command:"conf.BO.removeBO",BID:e})},startBO:function(){common.postMessageToNaCl({type:"conf",command:"conf.BO.startBO"})},stopBO:function(){common.postMessageToNaCl({type:"conf",command:"conf.BO.stopBO"})},joinBO:function(e){common.postMessageToNaCl({type:"conf",command:"conf.BO.joinBO",BID:e})},switchBO:function(e){common.postMessageToNaCl({type:"conf",command:"conf.BO.switchBO",BID:e})},leaveBO:function(){common.postMessageToNaCl({type:"conf",command:"conf.BO.leaveBO"})},clearAllBO:function(){common.postMessageToNaCl({type:"conf",command:"conf.BO.clearAllBO"})},notifyHelpRequestHandled:function(e,o){common.postMessageToNaCl({type:"conf",command:"conf.BO.notifyHelpRequestHandled",userGUID:e,ignore:o})},updateUnassignedUserToThisBO:function(e,o){common.postMessageToNaCl({type:"conf",command:"conf.BO.updateUnassignedUserToThisBO",BID:e,userGUID:o}),setTimeout(function(){inmeeting.getAllBOInfo()},1e3)},switchAssignedUserToThisBO:function(e,o){common.postMessageToNaCl({type:"conf",command:"conf.BO.switchAssignedUserToThisBO",BID:e,userGUID:o}),setTimeout(function(){inmeeting.getAllBOInfo()},1e3)},broadcastMessage:function(e){common.postMessageToNaCl({type:"conf",command:"conf.BO.broadcastMessage",content:e})},requestForHelp:function(){common.postMessageToNaCl({type:"conf",command:"conf.BO.requestForHelp"})},getMyBOStatus:function(){common.postMessageToNaCl({type:"conf",command:"conf.BO.getMyBOStatus"})},getAllBOInfo:z,clearBoObjParams:Ie,changeCCEditor:X,ccObj:m,sendClosedCaption:function(e){common.postMessageToNaCl({type:"conf",command:"conf.CC.sendClosedCaption",content:e})},canShowCCButton:q,enableCCBtnStyle:Z,disableCCBtnStyle:ee,showHideCCButtonOnToolbar:function(){var e,o;myStatusObject.isHost?(e=myStatusObject.id,o=m.initialCCTitleAttendees,CCStatusObject.isMyself,$.inArray(e,o),CCStatusObject.canShowCCButton?Q():(J(),closeWindow("typerWin"))):oe()},handleEditorChange:function(e){var o,t,n=myStatusObject.isHost;m.hasPriviageChanged=!0,m.canEditCC=e,n?(t=winMgr.getWinByWinId("typerWin"),m.canEditCC?t||(client.openTyperWin(),Z(),ue()):te()):(o=winMgr.getWinByWinId("typerWin"),closeWindow("ccMsgWin"),!m.canEditCC&&o&&te())},handleCCMsgReceived:function(e){var o,t,n=m.availableCC,i=CCStatusObject.isMyself,a=winMgr.getWinByWinId("shareMainWindow"),s=me();if(m.hasPriviageChanged=!1,m.ccMsg.push(e),m.lastRecevMsgTime=(new Date).getTime(),n){if(i)return void client.showCCMsgInCCTyperWin(e);s?re(e):a?a.contentWindow.showCCMsgWin(e):(o=e,t=m.ccMsgStatus,clearTimeout(m.ccMsgTimeoutVar),"e"===t?$(".cc-msg-list").hasClass("hideMe")||($("#cc_typer_temp").clone().removeAttr("id").text(o).removeClass("hideMe").appendTo(".cc-list-inner"),de()):re(o))}},hideCCChoice:ce,hideCCTooltip:ie,relocateCCToolTipPos:function(){$(".cc-tooltip").hasClass("hideMe")||setTimeout(function(){var e=se();$(".cc-tooltip").css({top:e.top,left:e.left})},20)},showHideShareButtonOnToolbar:function(){g.getMeetingStatusObj().isScreenShareDisabled?toolbar.showToolbarIcon("shareContainer",!1):toolbar.showToolbarIcon("shareContainer",!0)},boObj:s,getAttendeesFromBoItems:function(){var e=s.allBOInfo.boItems,o=[];return _.forEach(e,function(e){o=_.concat(o,e.BOUserItems)}),o},showHideBoButtonOnToolbar:function(){var e=myStatusObject.isHost||s.boHost.gotHost,o=myStatusObject.isCoHost,t=g.getMeetingStatusObj().isBOEnabled;if(Oe(0),e&&t)return we(),void Me();if(g.getMeetingStatusObj().inBO)be()||(s.isParticipantsChooseRoomEnabled&&we(),toolbar.showToolbarIcon("askforhelp",!0));else{if(!pe()&&!ve()&&s.isParticipantsChooseRoomEnabled)return we(),void Me();Ce()&&Se()?o?we():($("li.bo").find(".atteedeetext").removeClass("forceHide").end().find(".hosttext").addClass("forceHide").off("click").end(),$(".toolbar .webinar-more .bo-more-text").text($("li.bo .atteedeetext").text()),toolbar.showToolbarIcon("bo",!0)):toolbar.showToolbarIcon("bo",!1),Me()}},showHideBoButtonOnToolbarWhenOnUserStatusChanged:function(){var e=myStatusObject.isHost||inmeeting.boObj.boHost.gotHost,o=g.getMeetingStatusObj().isBOEnabled;Ie(),z(),e&&o?inmeeting.showHideBoButtonOnToolbar():g.getMeetingStatusObj().inBO&&inmeeting.showHideBoButtonOnToolbar()},handleBoHostChanged:function(){fe()?closeBoWins():(closeWindow("createBoWin"),closeWindow("boWin"),!$("#window-createBo").hasClass("hideMe")&&$("#window-createBo").addClass("hideMe"),!$("#window-bo").hasClass("hideMe")&&$("#window-bo").addClass("hideMe")),inmeeting.showHideBoButtonOnToolbar()},createBoWindow:function(e){var o=winMgr.getWinByWinId("boWin");o?o.focus():winMgr.createWindow("boWin","build/window/bo/boWindow.html",{width:460,height:520},e)},createAssignBoWindow:function(){var e=winMgr.getWinByWinId("createBoWin");e?e.focus():winMgr.createWindow("createBoWin","build/window/bo/createBoWindow.html",{width:390,height:220},function(e){e.contentWindow.createBo.initCreateBoWindow()})},updateBoBadge:Oe,isViewRoomOnly:fe,isNew:pe,isInprogress:Ce,isEnded:ve,isStopping:be,createHostAskForWindow:function(e){var o=e.userGUID,t=e.userDisplayName,n=e.meetingName;winMgr.createWindow("hostAskForHelpWin",encodeURI("build/window/bo/hostAskForHelpWindow.html"),{width:420,height:170},function(e){e.contentWindow.initHostAskForHelpWindow(o,t,n)})},handleGetAllBOInfo:function(e){Te(e.unassignedBOUsers),ye(_.assign({},e)),s.needUpdateBOWinUI&&function(){var e=winMgr.getWinByWinId("boWin");if(e)do{if(fe()){pe()||ve()?closeBoWins():e.contentWindow.bo.executeAttendeeViewRoom();break}if(he()){e.contentWindow.bo.executeInBOMeeting();break}if(Ce()){e.contentWindow.bo.executeInprogress();break}if(ve()){s.unassignAttendees=s.allBOInfo.unassignedBoUsers,e.contentWindow.bo.executeEnded(),s.needUpdateBOWinUI=!1;break}}while(0);else do{if(fe()){pe()||ve()?closeBoWins():bo.executeAttendeeViewRoom();break}if(he()){bo.executeInBOMeeting();break}if(Ce()){bo.executeInprogress();break}if(ve()){s.unassignAttendees=s.allBOInfo.unassignedBoUsers,bo.executeEnded(),s.needUpdateBOWinUI=!1;break}}while(0)}()},handleBOControlStatusChanged:function(e){s.boControlStatus=e.BOControlStatus,2==s.boControlStatus&&(s.needUpdateBOWinUI=!0)},handleOnMasterConfHostChanged:function(e){s.boHost={gotHost:e.gotHost,hostGUID:e.hostGUID}},shortcutsStatus:{autoShowUI:!0},changeVideoInput:function(e){var o=videoTrack?videoTrack.getSettings().deviceId:"";o!==e&&L(e,o)},changeAudioInput:function(o){var e={};if(backgroundWindow.isKioskApp()){var t=commonModule.DeviceMgr.getInstance().deviceList.find(function(e){return e.deviceId===o});o=commonModule.DeviceMgr.getInstance().changeContraintsDeviceIdToDefault(t)}e.audio=Object.assign({},u(),{optional:[{sourceId:o}]}),stopAllAudioTracks(),navigator.mediaDevices.getUserMedia(e).then(function(e){commonModule.DeviceMgr.getInstance().setInMeetingUsingDeviceByKind("audioinput",o),audioSuccess(e)}).catch(console.error)},getAudioConstraints:u,joinAudioWithDeivce:U,getVideoInputDevices:function(){return videoInputDevices},offShortCuts:function(){$(document).off("keydown",d).off("keyup",l)},bindShortcuts:e,refreshturnPageButton:function(e){e.currentPageIndex+=1,1===e.mode||e.totalPageNumber<=1||1===e.currentPageIndex||(e.currentPageIndex,e.totalPageNumber)},isInBOMeeting:he,showNavi:Y,admitAll:function(){common.postMessageToNaCl({type:"conf",command:"conf.waitingRoomAdmitAll"})},getActiveUser:Ue,handleCCEvt:function(){var e,o=mainAppHtmlWindow.myStatusObject,t=mainAppHtmlWindow.CCStatusObject,n=o.isHost,i=t.hasAssignedCCEditor,a=t.isMyself;if(m.availableCC?(ne(),closeWindow("typerWin"),ee()):Z(),n&&!i)return $(".cc-option").hasClass("hideMe")?$(".cc-option").hasClass("hideMe")&&($(".cc-option").off("click").on("click",function(e){e.stopPropagation()}),$("body").one("click",function(e){ce()}),e=se(),$(".cc-option").css({left:e.left-50,top:e.top-100}).removeClass("hideMe")):ce(),ee(),void $(".cc-btns .infobtn").focus();a?m.availableCC&&(ne(),client.openTyperWin(),Z()):m.availableCC?3e4<(new Date).getTime()-m.lastRecevMsgTime?m.availableCC?re("Closed caption is turned on.",function(){re()}):ie():re():ne()},handleWebinarCCEvt:function(){var e;m.availableCC=!m.availableCC,ge(e=m.availableCC),e?re():ue()},getKeydownStatus:function(){return r},getIsInMovingSharePicture:function(){return a},onAllowPanelistsVoteStatusChange:function(e){var o=!myStatusObject.isHost&&!myStatusObject.isCoHost&&e;g.getMeetingStatusObj().isAllowPanelistsVote=!!o},sendNonFeedback:function(e){common.postMessageToNaCl({type:"conf",command:"conf.nonVerbalFeedback",feedback_button:e})},refreshPlistFeedback:function(e,o){var t=getAttendeeObject(o,!0);null!==t&&(t.userFeedback=e)},setFeedbackNumbersObject:function(e){e&&(c=Object.assign({},e))},getFeedbackNumbersObject:function(){return Object.assign({},c)},onPracticeSessionStatusChangeForHostChange:function(e){var o=(myStatusObject.isHost||myStatusObject.isCoHost)&&g.getMeetingStatusObj().isWebinar&&e,t=$("#practice-session-bar");o?t.removeClass("forceHide opened").one("click",xe):t.addClass("forceHide")},onPracticeSessionStatusChange:function(e){var o=g.getMeetingStatusObj().isWebinar&&!e,t=$("#practice-session-bar");o&&(t.removeClass("forceHide").addClass("opened"),setTimeout(function(){t.addClass("forceHide")},3e3))},isAssignedAttendee:Se,onAccessApproved:h,resetccObj:function(){m.ccMsg=[],m.CCSenderIds=[],m.initialCCTitleAttendees=[],m.availableCC=!1,m.hasPriviageChanged=!1,m.lastRecevMsgTime=null,m.ccMsgTimeoutVar=null,m.canEditCC=!1,m.ccMsgStatus="c"},resetboObj:function(){s.attendees=[],s.unassignAttendees=[],s.boControlStatus=-1,s.boRooms=[],s.roomNum=1,s.autoAssign=!0,s.allBOInfo.boItems=[],s.allBOInfo.unassignedBoUsers=[],s.boHost.gotHost=0,s.boHost.hostGUID=null,s.myBOStatus="",s.needUpdateBOWinUI=!0,s.isParticipantsChooseRoomEnabled=!1}}}();