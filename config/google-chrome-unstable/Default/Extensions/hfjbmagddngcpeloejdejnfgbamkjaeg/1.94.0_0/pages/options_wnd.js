"use strict";__filename="pages/options_wnd.js",define(["require","exports","./async_bg","./options_base","./options_defs"],function(n,t,e,o,i){function u(){function n(){var n,t,e,i=o.ns.Us;for(n in i)"object"==typeof(e=(t=i[n]).os)&&e&&(t.os=t.ds())}e.Ns.removeEventListener("unload",u,{capture:false}),setTimeout(function(){if(e.Eo(),!e.Ns)return window.onbeforeunload=null,void window.close();e.Ns.addEventListener("unload",u),"loading"===e.Ns.document.readyState?e.Ns.addEventListener("DOMContentLoaded",function t(){e.Ns.removeEventListener("DOMContentLoaded",t,{capture:true}),setTimeout(n,100)},{capture:true,once:true}):setTimeout(n,67)},200)}var r,a,c,f,s;Object.defineProperty(t,"__esModule",{value:true}),t.click=t.loadChecker=t.clear_delayed_task=t.delayed_task=t.mt=void 0,r=function(){t.delayed_task=null},t.clear_delayed_task=r,e.me.runtime.getPlatformInfo(function(n){t.mt=n.os.toLowerCase(),e.Ao(1)}),e.c(o.showI18n),o.ts&&e.c(o.ts),e.c(function(n){var t=e.me.runtime.getManifest();n.textContent=t.version_name||t.version},e.$(".version")),i.saveBtn.onclick=function(n){if(false===n||o.ns.uh()){var t=o.ns.zs;o.ns.zs=[],this.disabled=true,this.firstChild.data=o.$i("o115_3"),i.exportBtn.disabled=false,i.savedStatus(false),window.onbeforeunload=null,0!==t.length&&setTimeout(function(n){e.cs.Qe({N:6,d:n.map(function(n){return e.cs.Le[n]})})},100,t)}},a=function(){var n,u,r,a,c,f,s=false,l=e.$("#advancedOptionsButton");for(u in l.onclick=function(n,t){var i=this,u=e.$("#advancedOptions"),r=null,a=function(){return r=e.cs.Xe("showAdvancedOptions")};null==t||"hash"===t&&false===a()?e.cs.Ve("showAdvancedOptions",s=!s):s=null!=r?r:a(),e.c(function(){u.previousElementSibling.style.display=u.style.display=s?"":"none";var n=s?"Hide":"Show";i.firstChild.data=o.$i(n)||n,i.setAttribute("aria-checked",""+s)},9)},l.onclick(null,true),o.ns.Us)o.ns.Us[u].vs();for(e.c(function(){var n,t;for(n in o.ns.Us)(t=o.ns.Us[n]).ys(t.os)}),o.ns.Us.exclusionRules.os.length>0&&e.c(function(n){n.style.visibility=""},e.$("#exclusionToolbar")),r=(n=e.$$("[data-check]")).length;0<=--r;)(l=n[r]).addEventListener(l.dataset.check||"input",t.loadChecker);for(document.addEventListener("keyup",function(n){var e=n.target,o=n.keyCode;if(13===o){if(e instanceof HTMLAnchorElement)e.hasAttribute("href")||setTimeout(function(n){t.click(n),n.blur()},0,e);else if((n.ctrlKey||n.metaKey)&&(e.blur&&e.blur(),i.savedStatus()))return i.saveBtn.onclick()}else{if(32!==o)return;e instanceof HTMLSpanElement&&e.parentElement instanceof HTMLLabelElement&&(n.preventDefault(),t.click(e.parentElement.control))}}),a=function(){var n,t,o=e.$("#"+this.dataset.autoResize),i=o.scrollHeight,u=o.scrollWidth,r=u-o.clientWidth;i<=o.clientHeight&&r<=0||(n=Math.max(Math.min(innerWidth,1024)-120,550),o.style.maxWidth=u>n?n+"px":"",o.style.height=o.style.width="",t=o.offsetHeight-o.clientHeight,i+=t=(r=u-o.clientWidth)>0?Math.max(26,t):t+18,r>0&&(o.style.width=o.offsetWidth+r+4+"px"),o.style.height=i+"px")},r=(n=e.$$("[data-auto-resize]")).length;0<=--r;)n[r].onclick=a;for(a=function(n){var o=this.dataset.delay,i=null;"continue"!==o&&n&&n.preventDefault(),"event"===o&&(i=n||null),t.delayed_task=["#"+this.id,i],"complete"!==document.readyState?window.addEventListener("load",function n(t){t.target===document&&(window.removeEventListener("load",n),e.import2("./options_ext.js"))}):e.import2("./options_ext.js")},r=(n=e.$$("[data-delay]")).length;0<=--r;)n[r].onclick=a;if(e.Un<53)for(a=function(n){n.target===this&&(n.preventDefault(),getSelection().selectAllChildren(this))},r=(n=e.$$(".sel-all")).length;0<=--r;)n[r].onmousedown=a;for((n=e.$$("[data-permission]")).length>0&&(function(n){function t(){var n,t=this.querySelector("[data-permission]");this.onclick=null,t&&(t.placeholder=o.$i("lackPermission",[(n=t.dataset.permission)?': "'+n+'"':""]))}var i,u,r,a=e.me.runtime.getManifest();for(i of a.permissions||[])a[i]=true;for(u=function(i){var u,r,c=n[i],f=c.dataset.permission;if("C"===f[0]){if(e.Un>=parseInt(f.slice(1)))return"continue";if("."===(r=f.split(",",2)[1]||",")[0]?null!=window[r.slice(1)]:"("===r[0]&&matchMedia(r.slice(1,-1)))return"continue";u=["beforeChromium",[f.slice(1).split(",",1)[0]]]}else{if(f in a)return"continue";u=["lackPermission",[f?":\n* "+f:""]]}e.c(function(n){n.disabled=true;var e=o.$i("invalidOption",[o.$i(u[0],u[1])]);n instanceof HTMLInputElement&&"checkbox"===n.type?(n.nextElementSibling.tabIndex=-1,(n=n.parentElement).title=e):(n.value="",n.title=e,n.parentElement.onclick=t,n instanceof HTMLSpanElement&&(n.style.textDecoration="line-through"))},c)},r=n.length;0<=--r;)u(r)})(n),e.c(function(){setTimeout(function(){var n,t,o,i=e.$$("[data-href]");for(n=i.length;0<=--n;)o=e.Oo.Ee((t=i[n]).dataset.href,null,-1),t.removeAttribute("data-href"),t.setAttribute("href",o)},100)}),l=e.$("#openExtensionsPage"),e.Un<65&&(l.href="chrome://extensions/configureCommands"),l.onclick=function(n){n.preventDefault(),e.Oo.su({u:this.href,p:true})},e.c(function(n){var t=n.children[1],e=o.$i("NewTabAdapter");t.title=e+" - "+o.$i("webstore")},e.$("#chromeExtVomnibar")),n=e.$$(".ref-text"),c=function(n){s||e.$("#advancedOptionsButton").onclick(null),n.preventDefault();var t=o.ns.Us[this.getAttribute("for")].rs.nextElementSibling;e.Un<61?t.scrollIntoViewIfNeeded():t.scrollIntoView({block:"center"}),t.focus(),window.VApi&&VApi.x(t.parentElement.parentElement)},f=function(t){var i=o.ns.Us[n[t].getAttribute("for")],u=i.ps;i.ps=function(){u.call(i),e.c(function(n){n.textContent=o.$i(i.bs()>1?"o145_2":"o144")},e.$("#"+i.rs.id+"Status"))},n[t].onclick=c,i.rs.addEventListener("change",i.ps,true)},r=n.length;0<=--r;)f(r)},c=function(){var n,t,i,u;for(n in o.ns.ms=false,a(),a=c=null,o.ns.Us)o.ns.Us[n].ps();(t=o.ns.Us.newTabUrl)._s.xs(t.os),e.Oo.yn.o||e.c(function(n){n.textContent="Cmd"},e.$("#Ctrl")),window.onhashchange(),e.Un>75&&((i=matchMedia("(prefers-color-scheme: dark)")).onchange=function(){e.Oo.vo(),setTimeout(u,34)},(u=function(n){var t,r,a,c,f,s,l,d=o.ns.Us.autoDarkMode;if(d.os&&d.as){if(t=i.matches,window.VApi&&VApi.z){if(r=VApi.y().r)for(a of e.Un<51?[].slice.call(r.children):r.children)"style"!==a.localName&&(a.classList.toggle("D",t),"iframe"===(a=a.firstElementChild||a).localName&&(c=a.classList.contains("Find"),(s=(f=a.contentDocument).querySelector("style#dark"))&&s.sheet&&(s.sheet.disabled=!t),f.body.classList.toggle(c?"D":"has-dark",t),c&&(l=VApi.y().f)&&l.parentElement.classList.toggle("D",t)));e.cs.Ke("d",t,VApi.z)}else 1===n&&t!==!!e.Oo.yn.d&&setTimeout(u,500);e.toggleDark(t)}})(1)),o.ns.Us.autoDarkMode.ps=function(){e.Oo.vo(),e.toggleDark(this.os)},o.ns.Us.autoReduceMotion.ps=function(){e.toggleReduceMotion(this.os)}},o.ns.Us.userDefinedCss.rs.addEventListener("input",o.ss(function(){var n,t,i,u,r,a,c,f=o.ns.Us.userDefinedCss,s=f.rs.classList.contains("debugging");(!f.as||s)&&window.VApi&&VApi.z&&(t=(n=f.bs())===f.os,i=e.Oo.ri(-1,n),u=VApi.y().r,!s&&e.Ns&&e.me.tabs.query({currentWindow:true,active:true},function(n){if(n&&n[0]&&n[0].url===location.href){var t=e.Oo.ho(n[0].id,0);t&&(t.s.fr|=40)}}),f.rs.classList.toggle("debugging",!t),VApi.t({k:u||t?0:1,t:"Debugging CSS\u2026",H:i.ui,f:i.find}),(a=(r=u&&u.querySelector("iframe.Omnibar"))&&r.contentDocument)&&((c=a.querySelector("style.debugged")||a.querySelector("style#custom"))||((c=a.createElement("style")).type="text/css",c.id="custom"),c.parentNode||a.head.appendChild(c),c.classList.add("debugged"),c.textContent=(t?"\n":"\n.transparent { opacity: 1; }\n")+(i.omni&&i.omni+"\n"||"")))},1200,null,0)),e.$("#importButton").onclick=function(){var n=e.$("#importOptions");n.onchange?n.onchange(null):t.click(e.$("#settingsFile"))},e.c(function(n){var i,u=navigator.userAgentData,r=(u&&u.brands||[]).find(function(n){return n.version===e.Un&&"Chromium"!==n.brand}),a=e.zn?"MS Edge":"",c=r?r.brand:u?a||"Chromium":(/\bChromium\b/.exec(navigator.userAgent)||[""])[0]||a||"Chrome";n.textContent=c+" "+e.Un+o.$i("comma")+o.$i("NS")+(o.$i(t.mt)||t.mt[0].toUpperCase()+t.mt.slice(1)),e.zn&&((i=e.$("#openExtensionsPage")).textContent=i.href="edge://extensions/shortcuts")},e.$("#browserName")),t.loadChecker=function(){e.import2("./options_checker.js")},document.addEventListener("keydown",function(n){var t,o,i,u,r;if(32===n.keyCode)"span"===(r=n.target).localName&&"label"===r.parentElement.localName&&n.preventDefault();else{if(!window.VApi||!VApi.z||"input textarea".includes(document.activeElement.localName))return;"a-f12"===(t=VApi.m({c:" ",e:n,i:n.keyCode},9))?(o=e.$("#importOptions"),i=o.selectedIndex,u=function(){o.onchange&&o.onchange(null),o.selectedIndex=i},e.$("#recommendedSettings").selected=true,null!=o.onchange?u():setTimeout(u,100)&&o.click()):"?"===t&&e.$("#showCommands").click()}}),window.onhashchange=function(){var n,t=location.hash;(t=t.slice("!"===t[1]?2:1))&&/^[a-z][a-z\d_-]*$/i.test(t)&&((n=e.$('[data-hash="'+t+'"]'))?n.onclick&&e.c(function(){n.onclick(null,"hash")}):(n=e.$("#"+t))&&e.c(function(){n.dataset.model&&n.classList.add("highlight");var t=function(t){t&&t.target!==window||(window.onload&&(window.onload=null,window.scrollTo(0,0)),n.scrollIntoViewIfNeeded())};if("complete"===document.readyState)return t();window.scrollTo(0,0),window.onload=t}))},e.Oo.N()&&e.Oo.N()?e.Oo.N().then(c):c(),window.onunload=function(){e.Ns.removeEventListener("unload",u)},e.Ns.addEventListener("unload",u,{capture:false,once:true}),(f=e.Oo.po().sn.get("?"))&&7===f.ma||(s="",e.Oo.po().sn.forEach(function(n,t){7===n.ma&&(s=s&&s.length<t.length?s:t)}),s&&e.c(function(n){return n[0].textContent=n[1]},[e.$("#questionShortcut"),s])),document.addEventListener("click",function n(){var t=window.VApi,o=t&&t.y();o&&o.r&&(document.removeEventListener("click",n,true),o.r.addEventListener("click",function(n){var t,e=n.target;VApi&&e.classList.contains("HelpCommandName")&&(t=e.textContent.slice(1,-1),VApi.p({H:16,s:t}))},true),document.addEventListener("click",function(n){var t,o,i,u,r;"a"===n.target.localName&&(n.ctrlKey||n.metaKey)&&(i=(o=(t=window.VApi)&&t.b)&&o.$())&&i.b&&!i.a&&(u=-17&i.m)<32&&2&u&&!(1&u)&&(r=e.Oo.ko())>=0&&setTimeout(function(){e.me.tabs.update(r,{active:true})},0)}))},true),t.click=function(n){var t=document.createEvent("MouseEvents");return t.initMouseEvent("click",true,true,window,1,0,0,0,0,false,false,false,false,0,null),n.dispatchEvent(t)}});