"use strict";__filename="background/help_dialog.js",define(["require","exports","./store","./utils","./browser","./normalize_urls","./key_mappings"],function(e,t,o,n,a,i,r){var s,l,c,d,b,p,u,m,g,v,T,k,h,f,w,L;Object.defineProperty(t,"__esModule",{value:true}),t.mo=t.parseHTML=void 0,n=__importStar(n),s=null,c=null,d=new Map,t.parseHTML=function(e){var t,r=51===o.Un,s=e.indexOf("</style>")+8,c=e.slice(0,s),d=e.slice(s).trim();return r&&r&&(c=c.replace(/contain:\s?[\w\s]+/g,"contain: none !important")),d=d.replace(/\$(\w+)/g,function(e,t){var o;return null!==(o=l[t])&&void 0!==o?o:t}),t=n.qt({homePage:o.u.pt,version:o.u.at,release:i.Ee("vimium://release"),reviewPage:(o.zn?"https://microsoftedge.microsoft.com/addons/detail/aibcglbfblnogfjhbcmmpobjhnomhcdo":"https://chrome.google.com/webstore/detail/vimium-c-all-by-keyboard/$id/reviews").replace("$id",function(){return a.me.runtime.id}),webStore:l[o.zn?"edgestore":"webstore"],browserHelp:o.zn?"https://support.microsoft.com/help/4531783/microsoft-edge-keyboard-shortcuts":"https://support.google.com/chrome/answer/157179"}),[c,d=d.replace(/\{\{(\w+)}}/g,function(e,o){return t[o]||e})]},b=function(e){var a,i,d,b,p;return l=o.Nn[1],s&&!o.Nn[0]||(s=t.parseHTML(o.Nn[0]),o.Nn[0]=""),a=new Map,i=!e,d=e,o.sn.forEach(function(e,t){var o,n;t.startsWith("<v-")&&t.endsWith(">")||(o=g(e.ca),(n=a.get(o))||a.set(o,n=[]),"string"==typeof e.ra&&/\$(?:key|desc)=/.test(e.ra)&&r.Xt(e),n.push([t,e]))}),b=n.qt({title:l[e?"cmdList":"help"]||"",tip:d&&l.tipClickToCopy||"",lbPad:d?'\n\t\t<tr><td class="HelpTd TdBottom">&#160;</td></tr>':""}),p=s[1].replace(/\{\{(\w+)}}/g,function(e,t){var o;return null!==(o=b[t])&&void 0!==o?o:v(t,a,i,d)}),c=null,s[0]+p},t.mo=b,p=function(e,t){return e.includes(t)},u=function(e,t){return e.startsWith(t)},m=function(e,t){return e.endsWith(t)},g=function(e){return p(e,"Mode")&&p(e,".activate")&&(e=p(e,"ModeTo")?e.replace("ModeTo",""):e.replace("Mode","")),m(e,"Unhover")?e=e.replace("Unhover","Leave"):m(e,"Goto")?e=e.replace("Goto",""):"clearContentSetting"===e?e+="s":p(e,"CS")?e=u(e,"clear")?"clearContentSettings":e.replace("CS","ContentSetting"):p(e,"vateUrl")?e=e.replace("vateUrl","vateEditUrl"):m(e,"TabSelection")?e=e.replace("TabSelection","Tabs"):"quickNext"===e?e="nextTab":"newTab"===e?e="createTab":"closeSomeOtherTabs"===e?e="closeOtherTabs":"simBackspace"===e?e="simulateBackspace":"showHUD"===e?e="showTip":"wait"===e&&(e="blank"),e},v=function(e,t,a,i){var r,s=l.cmdParams||" (use *)",c=o.Nn[2],b="",p=function(e){var o,r,p,u,m,g,v,h,f,w,H,y=t.get(e);if(a&&!y)return"continue";if(o=1===L[e],r=-2,p="",(u=d.get(e))||(m=c[e],u=[l[e].replace("<","&lt;").replace(">","&gt;"),m?s.replace("*",function(){return m}):" "],d.set(e,u)),y&&y.length>0){for(p='\n\t\t<span class="HelpKey">',g=0;g<y.length;g++){if(r>42&&g<y.length-1){p+="</span>\n\t<span>+ "+(y.length-g)+" \u2026";break}f=(h=k((v=y[g])[1]))&&h.Lo||n.It(v[0]),(w=h&&h.Ho)?b+=T(o,'\n\t\t<span class="HelpKey">'+f+"</span>\n\t",i?w+" ":w,i?e:""):(r>=0&&(p+='</span> <span class="HelpKey">'),p+=f,r+=v[0].length+2)}p+="</span>\n\t"}H=i?u[0]+u[1]:u[0],r<=12?b+=T(o,p,H,i?e:""):(b+=T(o,p,"",""),b+=T(o,"",H,i?e:""))};for(r of w[e])p(r);return b},T=function(e,t,o,n){var a=e?'<tr class="HelpAdv">\n\t':"<tr>\n\t";return o?(a+='<td class="HelpTd HelpKeys">',a+=t,a+='</td>\n\t<td class="HelpTd HelpCommandInfo">',a+=o,n&&(a+='<span class="HelpCommandName" role="button">(',a+=n,a+=")</span>\n\t")):(a+='<td class="HelpTd HelpKeys HelpLongKeys" colspan="2">',a+=t),a+"</td>\n</tr>\n"},k=function(e){var t,o,n=e.sa;return n&&null==n.Lo?(c||(t=document.createElement("template"),o=document.createElement("td"),t.content.appendChild(o),c=o),e.sa={Lo:n.la?f(n.la):"",Ho:n.ua?f(n.ua):""}):n},h={a:1,abbr:1,acronym:1,address:1,b:1,big:1,blockquote:1,br:1,cite:1,code:1,colgroup:1,dd:1,del:1,dfn:1,div:1,dl:1,dt:1,em:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,i:1,id:1,img:1,ins:1,kbd:1,li:1,ol:1,p:1,pre:1,samp:1,small:1,span:1,strong:1,sub:1,sup:1,table:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,tt:1,u:1,ul:1,var:1,svg:1,path:1,__proto__:null},f=function(e){var t,o,n,a,i,r,s,l,d,b;for(c.innerHTML=e,o=0,n=(t=c.querySelectorAll("*")).length;o<n;o++)if((a=t[o]).localName+""in h||a instanceof HTMLUnknownElement){for(i=[],s=(r=a.attributes).length,l=0;l<s;l++)d=r[l].name.toLowerCase(),/^on|[^\w\-]|href$|^is/i.test(d)&&i.push(r[l]);for(b of i)a.removeAttributeNode(b)}else a.remove();return c.innerHTML},L={__proto__:null,toggleViewSource:1,clearFindHistory:1,dispatchEvent:1,scrollToLeft:1,scrollToRight:1,moveTabToNextWindow:1,moveTabToNewWindow:1,moveTabToIncognito:1,reloadGivenTab:1,focusOrLaunch:1,enableContentSettingTemp:1,toggleContentSetting:1,toggleStyle:1,clearContentSettings:1,"LinkHints.activateDownloadImage":1,reopenTab:1,"LinkHints.activateOpenImage":1,removeRightTab:1,"LinkHints.activateDownloadLink":1,restoreGivenTab:1,runKey:1,sendToExtension:1,discardTab:1,copyWindowInfo:1,"LinkHints.activateOpenIncognito":1,passNextKey:1,goNext:1,goPrevious:1,"Marks.clearLocal":1,"Marks.clearGlobal":1,moveTabLeft:1,moveTabRight:1,closeTabsOnLeft:1,closeTabsOnRight:1,closeOtherTabs:1,scrollPxDown:1,scrollPxUp:1,scrollPxLeft:1,scrollPxRight:1,debugBackground:1,blank:1,reset:1,scrollSelect:1,"LinkHints.activateHover":1,"LinkHints.unhoverLast":1,toggleLinkHintCharacters:1,toggleSwitchTemp:1,"LinkHints.activateLeave":1,"Vomnibar.activateEditUrl":1,"Vomnibar.activateEditUrlInNewTab":1,closeDownloadBar:0,zoomIn:1,zoomOut:1,zoomReset:1,addBookmark:1},(w={__proto__:null,pageNavigation:["LinkHints.activate","LinkHints.activateOpenInNewTab","LinkHints.activateOpenInNewForegroundTab","LinkHints.activateWithQueue","scrollDown","scrollUp","scrollLeft","scrollRight","scrollToTop","scrollToBottom","scrollToLeft","scrollToRight","scrollPageDown","scrollPageUp","scrollPxDown","scrollPxUp","scrollPxLeft","scrollPxRight","scrollFullPageDown","scrollFullPageUp","scrollSelect","reload","reloadTab","reloadGivenTab","zoom","zoomIn","zoomOut","zoomReset","toggleViewSource","copyCurrentUrl","copyCurrentTitle","switchFocus","focusInput","LinkHints.activateCopyLinkUrl","LinkHints.activateCopyLinkText","openCopiedUrlInCurrentTab","openCopiedUrlInNewTab","goUp","goToRoot","LinkHints.activateDownloadImage","LinkHints.activateOpenImage","LinkHints.activateDownloadLink","LinkHints.activateOpenIncognito","LinkHints.activateHover","LinkHints.activateLeave","LinkHints.unhoverLast","LinkHints.activateSearchLinkText","LinkHints.activateEdit","LinkHints.activateSelect","LinkHints.click","simulateBackspace","dispatchEvent","goPrevious","goNext","nextFrame","mainFrame","parentFrame","enterInsertMode","enterVisualMode","enterVisualLineMode","Marks.activateCreate","Marks.activate","Marks.clearLocal","Marks.clearGlobal","openUrl","focusOrLaunch"],vomnibarCommands:["Vomnibar.activate","Vomnibar.activateInNewTab","Vomnibar.activateBookmarks","Vomnibar.activateBookmarksInNewTab","Vomnibar.activateHistory","Vomnibar.activateHistoryInNewTab","Vomnibar.activateTabs","Vomnibar.activateEditUrl","Vomnibar.activateEditUrlInNewTab","LinkHints.activateOpenVomnibar","toggleVomnibarStyle"],historyNavigation:["goBack","goForward","reopenTab"],findCommands:["enterFindMode","performFind","performBackwardsFind","performAnotherFind","clearFindHistory"],tabManipulation:["nextTab","previousTab","firstTab","lastTab","createTab","duplicateTab","removeTab","removeRightTab","restoreTab","restoreGivenTab","discardTab","moveTabToNextWindow","moveTabToNewWindow","moveTabToIncognito","joinTabs","sortTabs","togglePinTab","toggleMuteTab","visitPreviousTab","closeTabsOnLeft","closeTabsOnRight","closeOtherTabs","moveTabLeft","moveTabRight","enableContentSettingTemp","toggleContentSetting","clearContentSettings","copyWindowInfo","captureTab"],misc:["showHelp","autoCopy","autoOpen","searchAs","searchInAnother","showTip","openBookmark","addBookmark","toggleStyle","toggleLinkHintCharacters","toggleSwitchTemp","passNextKey","debugBackground","reset","runKey","sendToExtension","blank"]}).misc.push("closeDownloadBar"),o.zn&&w.tabManipulation.push("toggleReaderMode")});