"use strict";__filename="background/settings.js",define(["require","exports","./store","./utils","./browser","./normalize_urls","./parse_urls","./ports"],function(e,o,a,n,t,s,i,r){var c,l,h,w;Object.defineProperty(o,"__esModule",{value:true}),o.Le=o.Ge=o.Fe=o.Pe=o.Ne=o.Je=o.Ke=o.Ye=o.Qe=o.We=o.Ve=o.Xe=o.Ze=void 0,o.Ze=localStorage,c=null,l=function(e,n){var t,s,i;return e in a.An?a.An[e]:(t=o.Ne[e],i=null==(s=o.Ze.getItem(e))?t:"string"==typeof t?s:false===t||true===t?"true"===s:JSON.parse(s),n&&(a.An[e]=i),i)},o.Xe=l,h=function(e,n){var t,s;if(a.An[e]=n,e in o.Fe||(n===(t=o.Ne[e])?(o.Ze.removeItem(e),a.O(e,null)):(o.Ze.setItem(e,"string"==typeof t?n:JSON.stringify(n)),a.O(e,n)),e in o.Le&&o.Ke(o.Le[e],n,a.yn)),s=o.Je[e])return s(n,e)},o.Ve=h,o.We=function(e,a){return o.Je[e](void 0!==a?a:o.Xe(e),e)},o.Qe=function(e){if(6!==e.N)w(e);else if(null==e.d.length)w(e);else{var o=e.d;c?o=o.concat(c):n.c(w.bind(null,e)),c=o,e.d=null}},w=function(e){var o,n,t;if(6===e.N&&!e.d){for(t of(o=c,n=e.d={},o))n[t]=a.yn[t];c=null}r.eo(function(o){for(var a of o.oo)a.postMessage(e)})},o.Ye=function(e){n.a(a.Sn.slice(0),function(o){return a.Sn.includes(o)&&o.postMessage(e),1})},o.Ke=function(e,o,n){switch(e){case"c":case"n":o=o.toLowerCase().toUpperCase();break;case"i":o=o===!!o?o:o>1||o>0&&!a.yn.o;break;case"l":o=o===!!o?o?2:0:o;break;case"d":o=o?" D":""}return n?n[e]=o:o},o.Je={__proto__:null,extAllowList:function(e){var o,n,t,s=a.kn;if(s.forEach(function(e,o){false!==e&&s.delete(o)}),e)for(n=(o=e.split("\n")).length,t=/^[\da-z_]/i;0<=--n;)(e=o[n].trim())&&t.test(e)&&s.set(e,true)},grabBackFocus:function(e){a.yn.g=e},newTabUrl:function(e){e=/^\/?pages\/[a-z]+.html\b/i.test(e)?t.me.runtime.getURL(e):t.oe(s.Ee(e)),o.Ve("newTabUrl_f",e)},searchEngines:function(){var e,n=a.An.searchEngineMap;n.clear(),"searchKeywords"in a.An&&o.Ve("searchKeywords",null),e=i.Re("~:"+o.Xe("searchUrl")+"\n"+o.Xe("searchEngines"),n),o.Ve("searchEngineRules",e)},searchUrl:function(e){var n=a.An,t=n.searchEngineMap;if(e)i.Re("~:"+e,t);else if(t.clear(),t.set("~",{De:"~",B:"",Ae:o.Xe("searchUrl").split(" ",1)[0]}),n.searchEngineRules=[],o.Xe("newTabUrl_f",true))return;o.We("newTabUrl")},mapModifier:function(e){o.Ye({N:47,d:{a:e}})},vomnibarPage:function(e){var n=o.Ze.getItem("vomnibarPage_f");!n||e?((e=e?t.oe(e):o.Xe("vomnibarPage"))===o.Ne.vomnibarPage?e=a.u.gt:e.startsWith("front/")?e=t.me.runtime.getURL(e):(e=s.Ee(e),e=s.pe(e),e=a.Un<50&&!e.startsWith(a.u.ut)?a.u.gt:e.replace(":version",""+parseFloat(a.u.ft))),o.Ve("vomnibarPage_f",e)):a.An.vomnibarPage_f=n}},o.Ne={__proto__:null,allBrowserUrls:false,autoDarkMode:true,autoReduceMotion:false,clipSub:"p=^git@([^/:]+):=https://$1/=\np@^https://item\\.m\\.jd\\.com/product/(\\d+)\\.html\\b@https://item.jd.com/$1.html@",exclusionListenHash:true,exclusionOnlyFirstMatch:false,exclusionRules:[{pattern:":https://mail.google.com/",passKeys:""}],extAllowList:"# modified versions of X New Tab and PDF Viewer,\n# NewTab Adapter, and Shortcuts Forwarding Tool\nhdnehngglnbnehkfcidabjckinphnief\nnacjakoppgmdcpemlfnfegmlhipddanj\ncglpcedifkgalfdklahhcchnjepcckfn\nclnalilglegcjmlgenoppklmfppddien\n# EdgeTranslate\nbocbaocobfecmglnmeaeppambideimao\nbfdogplmndidlpjfhoijckpakkdjkkil",filterLinkHints:false,findModeRawQueryList:"",grabBackFocus:false,hideHud:false,ignoreCapsLock:0,ignoreKeyboardLayout:0,innerCSS:"",keyboard:[560,33],keyMappings:"",linkHintCharacters:"sadjklewcmpgh",linkHintNumbers:"0123456789",localeEncoding:"gbk",mapModifier:0,mouseReachable:true,newTabUrl:"",newTabUrl_f:"",nextPatterns:"\u4e0b\u4e00\u5c01,\u4e0b\u9875,\u4e0b\u4e00\u9875,\u4e0b\u4e00\u7ae0,\u540e\u4e00\u9875,next,more,newer,>,\u203a,\u2192,\xbb,\u226b,>>",omniBlockList:"",previousPatterns:"\u4e0a\u4e00\u5c01,\u4e0a\u9875,\u4e0a\u4e00\u9875,\u4e0a\u4e00\u7ae0,\u524d\u4e00\u9875,prev,previous,back,older,<,\u2039,\u2190,\xab,\u226a,<<",regexFindMode:false,scrollStepSize:100,searchUrl:navigator.language.startsWith("zh")?"https://www.baidu.com/s?ie=utf-8&wd=%s \u767e\u5ea6":"https://www.google.com/search?q=%s Google",searchEngines:navigator.language.startsWith("zh")?"b|ba|baidu|Baidu|\u767e\u5ea6: https://www.baidu.com/s?ie=utf-8&wd=%s \\\n  blank=https://www.baidu.com/ \u767e\u5ea6\nbi: https://cn.bing.com/search?q=$s\nbi|bing|Bing|\u5fc5\u5e94: https://www.bing.com/search?q=%s \\\n  blank=https://cn.bing.com/ \u5fc5\u5e94\ng|go|gg|google|Google|\u8c37\u6b4c: https://www.google.com/search?q=%s\\\n  www.google.com re=/^(?:\\.[a-z]{2,4})?\\/search\\b.*?[#&?]q=([^#&]*)/i\\\n  blank=https://www.google.com/ Google\nbr|brave: https://search.brave.com/search?q=%s Brave\nd|dd|ddg|duckduckgo: https://duckduckgo.com/?q=%s DuckDuckGo\nec|ecosia: https://www.ecosia.org/search?q=%s Ecosia\nqw|qwant: https://www.qwant.com/?q=%s Qwant\nya|yd|yandex: https://yandex.com/search/?text=%s Yandex\nyh|yahoo: https://search.yahoo.com/search?p=%s Yahoo\n\nb.m|bm|map|b.map|bmap|\u5730\u56fe|\u767e\u5ea6\u5730\u56fe: \\\n  https://api.map.baidu.com/geocoder?output=html&address=%s&src=vimium-c\\\n  blank=https://map.baidu.com/\ngd|gaode|\u9ad8\u5fb7\u5730\u56fe: https://www.gaode.com/search?query=%s \\\n  blank=https://www.gaode.com\ng.m|gm|g.map|gmap: https://www.google.com/maps?q=%s \\\n  blank=https://www.google.com/maps \u8c37\u6b4c\u5730\u56fe\nbili|bilibili|bz|Bili: https://search.bilibili.com/all?keyword=%s \\\n  blank=https://www.bilibili.com/ \u54d4\u54e9\u54d4\u54e9\ny|yt: https://www.youtube.com/results?search_query=%s \\\n  blank=https://www.youtube.com/ YouTube\n\nw|wiki: https://www.wikipedia.org/w/index.php?search=%s Wikipedia\nb.x|b.xs|bx|bxs|bxueshu: https://xueshu.baidu.com/s?ie=utf-8&wd=%s \\\n  blank=https://xueshu.baidu.com/ \u767e\u5ea6\u5b66\u672f\ngs|g.s|gscholar|g.x|gx|gxs: https://scholar.google.com/scholar?q=$s \\\n  scholar.google.com re=/^(?:\\.[a-z]{2,4})?\\/scholar\\b.*?[#&?]q=([^#&]*)/i\\\n  blank=https://scholar.google.com/ \u8c37\u6b4c\u5b66\u672f\n\nt|tb|taobao|ali|\u6dd8\u5b9d: https://s.taobao.com/search?ie=utf8&q=%s \\\n  blank=https://www.taobao.com/ \u6dd8\u5b9d\nj|jd|jingdong|\u4eac\u4e1c: https://search.jd.com/Search?enc=utf-8&keyword=%s\\\n  blank=https://jd.com/ \u4eac\u4e1c\naz|amazon: https://www.amazon.com/s/?field-keywords=%s \\\n  blank=https://www.amazon.com/ \u4e9a\u9a6c\u900a\n\nv.m|v\\:math: vimium://math\\ $S re= \u8ba1\u7b97\u5668\ngh|github: https://github.com/search?q=$s \\\n  blank=https://github.com/ GitHub \u4ed3\u5e93\nge|gitee: https://search.gitee.com/?type=repository&q=$s \\\n  blank=https://gitee.com/ Gitee \u4ed3\u5e93\njs\\:|Js: javascript:\\ $S; JavaScript":"bi: https://cn.bing.com/search?q=$s\nbi|bing: https://www.bing.com/search?q=%s \\\n  blank=https://www.bing.com/ Bing\nb|ba|baidu|\u767e\u5ea6: https://www.baidu.com/s?ie=utf-8&wd=%s \\\n  blank=https://www.baidu.com/ \u767e\u5ea6\ng|go|gg|google|Google: https://www.google.com/search?q=%s \\\n  www.google.com re=/^(?:\\.[a-z]{2,4})?\\/search\\b.*?[#&?]q=([^#&]*)/i\\\n  blank=https://www.google.com/ Google\nbr|brave: https://search.brave.com/search?q=%s Brave\nd|dd|ddg|duckduckgo: https://duckduckgo.com/?q=%s DuckDuckGo\nec|ecosia: https://www.ecosia.org/search?q=%s Ecosia\nqw|qwant: https://www.qwant.com/?q=%s Qwant\nya|yd|yandex: https://yandex.com/search/?text=%s Yandex\nyh|yahoo: https://search.yahoo.com/search?p=%s Yahoo\n\ng.m|gm|g.map|gmap: https://www.google.com/maps?q=%s \\\n  blank=https://www.google.com/maps Google Maps\nb.m|bm|map|b.map|bmap|\u767e\u5ea6\u5730\u56fe: \\\n  https://api.map.baidu.com/geocoder?output=html&address=%s&src=vimium-c\ny|yt: https://www.youtube.com/results?search_query=%s \\\n  blank=https://www.youtube.com/ YouTube\nw|wiki: https://www.wikipedia.org/w/index.php?search=%s Wikipedia\ng.s|gs|gscholar: https://scholar.google.com/scholar?q=$s \\\n  scholar.google.com re=/^(?:\\.[a-z]{2,4})?\\/scholar\\b.*?[#&?]q=([^#&]*)/i\\\n  blank=https://scholar.google.com/ Google Scholar\n\na|ae|ali|alie|aliexp: https://www.aliexpress.com/wholesale?SearchText=%s \\\n  blank=https://www.aliexpress.com/ AliExpress\nj|jd|jb|joy|joybuy: https://www.joybuy.com/search?keywords=%s \\\n  blank=https://www.joybuy.com/ Joybuy\naz|amazon: https://www.amazon.com/s/?field-keywords=%s \\\n  blank=https://www.amazon.com/ Amazon\n\nv.m|v\\:math: vimium://math\\ $S re= Calculate\ngh|github: https://github.com/search?q=$s \\\n  blank=https://github.com/ GitHub Repo\nge|gitee: https://search.gitee.com/?type=repository&q=$s \\\n  blank=https://gitee.com/ Gitee \u4ed3\u5e93\njs\\:|Js: javascript:\\ $S; JavaScript",showActionIcon:true,showAdvancedCommands:true,showAdvancedOptions:true,showInIncognito:false,notifyUpdate:true,smoothScroll:true,vomnibarOptions:{maxMatches:10,queryInterval:333,sizes:"77,3,44,0.8",styles:"mono-url",actions:""},userDefinedCss:"",vimSync:null,vomnibarPage:"front/vomnibar.html",vomnibarPage_f:"",waitForEnter:true},o.Pe={__proto__:null,extWhiteList:"extAllowList",phraseBlacklist:"omniBlockList"},o.Fe={__proto__:null,searchEngineMap:1,searchEngineRules:1,searchKeywords:1},o.Ge=["showAdvancedCommands"],o.Le={__proto__:null,filterLinkHints:"f",ignoreCapsLock:"i",ignoreKeyboardLayout:"l",mapModifier:"a",mouseReachable:"e",keyboard:"k",linkHintCharacters:"c",linkHintNumbers:"n",regexFindMode:"r",smoothScroll:"s",scrollStepSize:"t",waitForEnter:"w"},t.me.runtime.getPlatformInfo(function(e){var n=e.os.toLowerCase(),s=t.me.runtime.PlatformOs,i=n===s.WIN?2:n===s.MAC?0:1,r=o.Xe("ignoreCapsLock");a.u.mt=n,a.qn.o=a.yn.o=i,o.Ke("i",r,a.yn),a.Vn>2||(a.J(1|a.Vn),gA&&gA.ao())}),(function(){var e,n,s,i=t.me.runtime.getManifest(),r=location.origin,c=r+"/",l=i.content_scripts[0].js,h=a.u,w=a.In,p=function(e){return(47===e.charCodeAt(0)?r:e.startsWith(c)?"":c)+e};if(o.Ne.newTabUrl=a.zn?"edge://newtab":"chrome://newtab",w.set("about:newtab",1),w.set("about:newtab/",1),w.set("chrome://newtab",1),w.set("chrome://newtab/",1),a.zn&&(w.set("edge://newtab",1),w.set("edge://newtab/",1)),w.set("chrome://new-tab-page",2),w.set("chrome://new-tab-page/",2),a.An.searchEngineMap=new Map,h.ht=Object.keys(i.commands||{}).map(function(e){return"quickNext"===e?"nextTab":e}),h.ft=i.version,h.at=i.version_name||i.version,h._t=p(i.options_page||h._t),h.it=null!=i.permissions&&i.permissions.indexOf("clipboardRead")>=0,h.dt=p(h.dt),h.gt=p(o.Ne.vomnibarPage),h.wt=p(h.bt),h.pt=i.homepage_url||h.pt,h.st=p(h.st),l.push("content/injected_end.js"),h.lt=l.map(p),!(a.Vn>2)){for(e in a.yn.g=o.Xe("grabBackFocus"),o.Le)o.Ke(o.Le[e],o.Xe(e),a.yn);for(n in o.Pe)null!=(s=o.Ze.getItem(n))&&(o.Ve(o.Pe[n],s),o.Ze.removeItem(n))}})(),a.Vn<3&&a.Jn&&a.Ln.then(function(e){if(e&&"install"===e.reason){var a=((navigator.userAgentData||navigator).platform||"").toLowerCase();(a.startsWith("mac")||a.startsWith("ip"))&&o.Ve("ignoreKeyboardLayout",1)}})});