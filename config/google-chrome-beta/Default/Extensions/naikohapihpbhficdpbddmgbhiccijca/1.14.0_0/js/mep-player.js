var packaged_app=(window.location.origin.indexOf("chrome-extension")===0),mejs={};(function(){var a=function(){this.player.updateCurrent();this.player.setCurrentRail()};mejs.MediaElementPlayer=function(b){if(!(this instanceof mejs.MediaElementPlayer)){return new mejs.MediaElementPlayer(b)}this.media=b;this.media.player=this;this.options=mejs.MepDefaults;this.init()};mejs.MediaElementPlayer.prototype={controlsAreVisible:true,init:function(){var b=this;b.media.controls=false;b.container=$('<div class="mejs-container"><div class="mejs-mediaelement"></div><div class="mejs-layers"></div><div class="mejs-controls"><div id="left" class="skip"></div><div id="right" class="skip"></div><div id="middle" class="skip"></div></div></div>').appendTo($("#main"));b.container.find(".mejs-mediaelement").append(b.media);b.controls=b.container.find(".mejs-controls");b.leftControls=b.controls.find("#left");b.rightControls=b.controls.find("#right");b.middleControls=b.controls.find("#middle");b.layers=b.container.find(".mejs-layers");b.meReady()},showControls:function(){var b=this;if(b.controlsAreVisible){return}b.media.addEventListener("timeupdate",a,false);b.controls.show(true);$(document.body).css({cursor:"pointer"});b.controlsAreVisible=true},hideControls:function(){var b=this;if(!b.controlsAreVisible){return}b.controls.hide(true);$(document.body).css({cursor:"none"});b.controlsAreVisible=false;b.media.removeEventListener("timeupdate",a,false)},controlsTimer:null,startControlsTimer:function(c){var b=this;if(b.controlsTimer!==null){clearTimeout(b.controlsTimer)}b.controlsTimer=setTimeout(function(){b.hideControls();b.controlsTimer=null},c||1500)},meReady:function(){var c=this,d=mejs.MediaFeatures,g,b;c.buildoverlays();for(g in c.options.features){b=c.options.features[g];if(typeof c[b]==="function"){try{c[b]();console.log("Loaded:",b)}catch(f){console.error("Load Failed:",b);console.error(f)}}}if("ontouchstart" in window){c.media.addEventListener("touchstart",function(){if(c.controlsAreVisible){c.hideControls()}else{c.showControls()}})}else{c.container.on("mousemove",function(){if(!c.controlsAreVisible){c.showControls()}c.startControlsTimer(2500)}).on("mouseleave",function(){if(!c.isPaused()){c.startControlsTimer(1000)}})}c.media.addEventListener("ended",function(h){c.next();if(c.isPaused()){$(".mejs-pause").removeClass("mejs-pause").addClass("mejs-play")}},false);c.media.addEventListener("loadedmetadata",function(h){c.updateDuration();c.updateCurrent()},false);c.options.success(c)},buildoverlays:function(){var b=this,c=$('<div class="mejs-overlay mejs-layer"><div class="mejs-overlay-loading"><div class="sk-circle"><div class="sk-circle1"></div><div class="sk-circle2"></div><div class="sk-circle3"></div><div class="sk-circle4"></div><div class="sk-circle5"></div><div class="sk-circle6"></div><div class="sk-circle7"></div><div class="sk-circle8"></div><div class="sk-circle9"></div><div class="sk-circle10"></div><div class="sk-circle11"></div><div class="sk-circle12"></div></div></div></div>').hide(true).on("click",function(){b.isPaused()?b.play():b.pause()}).appendTo(b.layers);b.media.addEventListener("seeking",function(){c.show(true);b.railBar.addClass("mejs-buffering");b.showControls();b.startControlsTimer()},false);b.media.addEventListener("seeked",function(){c.hide(true);b.railBar.removeClass("mejs-buffering")},false);b.media.addEventListener("waiting",function(){c.show(true);b.railBar.addClass("mejs-buffering")},false);b.media.addEventListener("loadeddata",function(){c.show(true);b.resizeVideo();b.railBar.addClass("mejs-buffering");b.media.addEventListener("timeupdate",b.timeupdate,false);b.play()},false);b.media.addEventListener("play",function(){c.hide(true);b.railBar.removeClass("mejs-buffering")},false);b.media.addEventListener("error",function(d){if(b.getSrc()===""){return}c.hide(true);b.railBar.removeClass("mejs-buffering");b.notify("Cannot play the given file!",3000)},false)},isEnded:function(){return this.media.ended},isPaused:function(){return this.media.paused},play:function(){if(this.media.readyState===0){this.openFileForm();return}this.notify("▶");$(".mejs-play").removeClass("mejs-play").addClass("mejs-pause");this.media.play()},pause:function(){this.notify("￰⏸");$(".mejs-pause").removeClass("mejs-pause").addClass("mejs-play");this.media.pause()},stop:function(){this.notify("￰■");if(!this.isPaused()){this.media.pause();$(".mejs-pause").removeClass("mejs-pause").addClass("mejs-play")}this.setCurrentTime(0)},load:function(){this.media.load()},isMuted:function(){return this.media.muted},setMuted:function(b){this.media.muted=b},getDuration:function(){return this.media.duration},setCurrentTime:function(b){this.media.currentTime=b},seek:function(b){this.notify("Seeking "+b+"s.");this.setCurrentTime(Math.max(0,Math.min(this.getCurrentTime()+b,this.getDuration())))},getCurrentTime:function(){return this.media.currentTime},getVolume:function(){return this.gainNode.gain.value>1?this.gainNode.gain.value:this.media.volume},setVolume:function(b){if(b<=1){this.media.volume=b;this.gainNode.gain.value=1;this.setMuted(b===0)}else{this.media.volume=1;this.gainNode.gain.value=b;this.media.dispatchEvent(new Event("volumechange"))}this.notify("Volume: "+(this.getVolume()*100).toFixed()+"%")},setSrc:function(b){if(this.getDuration()){this.stop()}if(b!==undefined){this.playIndex=parseInt(b)}this.media.src=window.URL.createObjectURL(this.playlist[this.playIndex]);document.title=this.playlist[this.playIndex].name;this.setThumbnailSrc(this.media.src)},getSrc:function(){return this.media.currentSrc},getPlaybackRate:function(b){return this.media.playbackRate},setPlaybackRate:function(b){this.media.playbackRate=parseFloat(b);this.notify("Playback Rate: x"+this.media.playbackRate.toFixed(2))},resetPlaybackRate:function(){this.setPlaybackRate(1)},incPlaybackRate:function(b){this.setPlaybackRate(this.getPlaybackRate()+(b||0.05))},decPlaybackRate:function(b){this.setPlaybackRate(Math.max(0.05,this.getPlaybackRate()-(b||0.05)))},toggleLoop:function(){this.media.loop=!this.media.loop;this.notify("Loop O"+(this.media.loop?"n.":"ff."))},moveCaptions:function(b){var d=$(".mejs-captions-position");switch(b){case 37:d.css({left:mejs.Utility.addToPixel(d.css("left"),-8)+"px"});break;case 38:d.css({bottom:mejs.Utility.addToPixel(d.css("bottom"),8)+"px"});break;case 39:d.css({left:mejs.Utility.addToPixel(d.css("left"),8)+"px"});break;case 40:d.css({bottom:mejs.Utility.addToPixel(d.css("bottom"),-8)+"px"});break}},brightness:1,changeBrightness:function(b){this.brightness=Math.min(Math.max(0.5,this.brightness+(b?0.1:-0.1)),2);this.media.style.webkitFilter="brightness("+this.brightness+")";this.notify("Brightness x"+this.brightness.toFixed(1))},changeAudioDelay:function(b){this.delayNode.delayTime.value=Math.min(Math.max(0,(this.delayNode.delayTime.value+(b?0.05:-0.05))),2);this.notify("Audio Delay: "+(this.delayNode.delayTime.value*1000).toFixed()+"ms.")},filterFiles:function(h,c){var e,g,b,j=[],f=[],d=this;for(e=0;e<h.length;e++){g=h[e].name.split(".").pop().toLowerCase();if(d.options.mediaExts.indexOf(g)!==-1&&d.playlist.every(function(i){return i.name!==h[e].name})){j.push(h[e])}else{if(d.options.subExts.indexOf(g)!==-1&&d.subtitles.every(function(i){return i.file.name!==h[e].name})){f.push({file:h[e],entries:null})}else{if(g==="zip"){mejs.Utility.unzip(h[e],function(i){d.filterFiles(i,false)})}}}}if(f.length){d.subtitles=d.subtitles.concat(f);d.setSubtitle(d.subtitles.length-f.length);b='<option value="-1">None</option>';d.subtitles.forEach(function(l,k){b+="<option value="+k+(k===d.subIndex?" selected":"")+">"+l.file.name+"</option>"});d.subSelect.html(b)}if(j.length){d.playIndex=c?0:d.playlist.length;d.playlist=c?j:d.playlist.concat(j);d.setSrc()}chrome.contextMenus.remove("setSrc",function(){if(chrome.runtime.lastError){console.log("Nothing!")}chrome.contextMenus.create({title:"Select",parentId:"playlist",id:"setSrc"});if(d.playlist.length===0){chrome.contextMenus.create({title:"None",parentId:"setSrc",id:"-1m",enabled:false});return}for(e=0;e<d.playlist.length;e++){chrome.contextMenus.create({title:d.playlist[e].name,type:"radio",parentId:"setSrc",id:e+"m",checked:e===d.playIndex})}});chrome.contextMenus.remove("setSubtitle",function(){if(chrome.runtime.lastError){console.log("Nothing!")}chrome.contextMenus.create({title:"Select",parentId:"subtitles",id:"setSubtitle"});chrome.contextMenus.create({title:"None",type:"Select",type:"radio",parentId:"setSubtitle",id:"-1s",checked:true});for(e=0;e<d.subtitles.length;e++){chrome.contextMenus.create({title:d.subtitles[e].file.name,type:"radio",parentId:"setSubtitle",id:e+"s",checked:e===d.subIndex})}})}};window.MediaElementPlayer=mejs.MediaElementPlayer})();