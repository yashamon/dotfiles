"use strict";var joinmeeting=function(){var f,v,p,h,k,b,C,S,T,w,y,L,M,I=!1,o=!1;var e=void 0;function n(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],o=$("#btn-sso-continue");e?o.addClass("isLoading").removeClass("enabled"):o.removeClass("isLoading").addClass("enabled")}function i(){var o;$(".tab3 .container-login").addClass("screen-left"),$("#container-sso").removeClass("screen-right"),o=$("#btn-sso-continue"),function(){!(0<arguments.length&&void 0!==arguments[0])||arguments[0],$("#btn-sso-continue").unbind("click").click(function(e){$(this).hasClass("enabled")&&($("#login-sso-domain").is(":visible")?0<$("#login-sso-domain").val().length&&K($("#login-sso-domain").val()+".zoom.us"):$("#login-sso-email").val().length&&(_($("#login-sso-email").val()),n()))})}(),$("#btn-sso-back").one("click",function(){$(".tab3 .container-login").removeClass("screen-left"),$("#container-sso").addClass("screen-right")}),$("#login-sso-domain,#login-sso-email").unbind("input keyup").bind("input",function(e){0<$(this).val().length&&!o.hasClass("enabled")?o.addClass("enabled"):0===$(this).val().length&&o.hasClass("enabled")&&o.removeClass("enabled")}).bind("keyup",function(e){return"Enter"===e.key?o.click():""}),$("#btn-unknow-domain").unbind("click").click(function(e){$("#container-know-domain").hide().addClass("hideMe"),$("#container-unknow-domain").fadeIn(200).removeClass("hideMe"),0<$("#login-sso-email").val().length?o.addClass("enabled"):o.removeClass("enabled")}),$("#btn-know-domain").unbind("click").click(function(e){$("#container-unknow-domain").hide().addClass("hideMe"),$("#container-know-domain").fadeIn(200).removeClass("hideMe"),0<$("#login-sso-domain").val().length?o.addClass("enabled"):o.removeClass("enabled")})}var t=void 0;function a(){var e,o=$("#login-email").val(),n=$("#login-pwd").val();return""!==o&&""!==n&&$("#login-submit").hasClass("enabled")?!!/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(o)||(e=ne("login-email"),$("#login-email").one("focus",function(){$("#login-email").removeClass("focus"),clearInterval(e)}),!1):(""===o?e=ne("login-email"):""===n&&(e=ne("login-pwd")),$("#login-email,#login-password").one("focus",function(){$("#login-email,#login-password").removeClass("focus"),clearInterval(e)}),!1)}var s=void 0;function r(){d(),s=registerTimer(3e4,function(){console.error("Login time out."),j({errorStr:"Login time out."})})}function d(){clearTimeout(s)}function l(){c=0,m(!1);var e=$("#login-email").val();saveToLocal("userEmail",e),E(e,$("#login-pwd").val(),$("#keep-login-option").next().hasClass("selected")),$("#login-form").addClass("forceHide"),$(".login-loading-container").removeClass("hideMe"),accessibility.focusWithoutOutline(".login-loading-container .login-text"),$(".login-loading").removeClass("hideMe")}function m(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],o=$(".container-other-login,.divider");e?o.show():o.hide()}var c=0;function u(e){var o=setInterval(function(){if(null!==common.naclModule&&common.nativeReady&&(window.clearInterval(o),!backgroundWindow.getIsWeblaunched()&&void 0!==localStorage.userToken)){if(!e&&!localStorage.keepLogin)return void removeFromLocal("userToken");!function(){c=1;var e=localStorage.userToken.type,o=localStorage.userToken.token,n=localStorage.userToken.refreshToken,i=localStorage.userToken.expireIn,t=localStorage.userToken.createTimeSince1970inSec,a=localStorage.userToken.isSelectedRoomLogin,s=localStorage.userToken.roomEmail;0===e&&V(o,"","")||2===e&&D(o,n,i,t)||100===e&&!a&&B(o)||100===e&&a&&F(o,s)||101===e&&q(o)}(),r(),m(!1),g.getLoginState()||W()}},400);common.registTimer(o)}function W(){$("#login-form").addClass("forceHide"),$(".login-loading-container").removeClass("hideMe"),$("#join-panel li.tab3").click(),$("#login-submit").removeClass("enabled"),$("#login-submit .text-label").text("auto signing.."),$(".login-loading").removeClass("hideMe")}function N(){$("#login-webview-wrapper").addClass("screen-right").fadeOut(200),$("#login-webview").length&&$("#login-webview")[0]&&($("#login-webview")[0].src="about:blank")}function O(e){saveToLocal("keepLogin",e)}var A=void 0;var R=0;function j(e){if(userStatus={},d(),m(),N(),$(".container-login").removeClass("screen-left"),$(".login-loading-container").addClass("hideMe"),backgroundWindow.isKioskApp()&&kiosk.isLoginWithActivationCode())kiosk.onActivateResult(0,e);else{var o=10006e4===e.result?g.getConstants()[10006e4]:e.errorStr;$(".login-error-msg").text(o).removeClass("hideMe"),accessibility.focusWithoutOutline(".login-error-msg"),clearTimeout(A),A=registerTimer(5e3,function(){$(".login-error-msg").addClass("hideMe")})}g.setLoginState(!1),uiAgent.showSignedOutUI(),$("#login-email").val(localStorage.userEmail);var n=$("#login-pwd");""===n.val()&&n.val("**********"),Y()}var x=void 0;function U(){R=0,clearTimeout(x)}function E(e,o,n){r(),common.postMessageToNaCl({type:"user",command:"user.login",name:e,password:o,keepLogin:n})}function B(e){r(),common.postMessageToNaCl({type:"user",command:"user.loginWithToken",token:e})}function F(e,o){common.postMessageToNaCl({type:"user",command:"user.loginZRroomWithToken",token:e,roomEmail:o})}var z=void 0;function P(){clearTimeout(z)}function Z(){P(),z=setTimeout(uiAgent.startOrJoinMeetingTimeOut,9e4)}function H(n){getFromLocal("userToken",function(e){var o;c=0,localStorage.userToken=e,(o=$("#login-webview")[0])&&localStorage.userToken&&localStorage.userToken.logoutUrl&&(o.src=localStorage.userToken.logoutUrl),$("#login-form").removeClass("forceHide"),$(".index-up .loading-container,.index-up .login-loading").removeClass("hideMe"),removeFromLocal("userToken","keepLogin"),uiAgent.onLogouting(),userStatus={},saveToLocal("usePMIOption",!1),g.setLoginState(!1),common.postMessageToNaCl({type:"user",command:"user.logout"}),"function"==typeof n&&n()})}function J(){common.postMessageToNaCl({type:"user",command:"user.getGoogleLoginURL"})}function D(e,o,n,i){r(),common.postMessageToNaCl({type:"user",command:"user.loginWithGoogleWithOAuth",token:e,refreshToken:o,expireIn:n,createTimeSince1970inSec:i})}function G(){common.postMessageToNaCl({type:"user",command:"user.getFBLoginURL"})}function V(e,o,n){r(),common.postMessageToNaCl({type:"user",command:"user.loginWithFacebook",accessToken:e,expire:o,url:n})}function K(e){common.postMessageToNaCl({type:"user",command:"user.getSSOLoginURL",domain:e})}function _(e){common.postMessageToNaCl({type:"user",command:"user.querySSOVanityURLByEmail",email:e})}function q(e){r(),common.postMessageToNaCl({type:"user",command:"user.loginWithSSOToken",token:e})}var Q=!0;function Y(){0<arguments.length&&void 0!==arguments[0]&&!arguments[0]?$("#login-submit").removeClass("enabled").attr("aria-disabled","false").off("click"):$("#login-submit").addClass("enabled").attr("aria-disabled","true").off("click").click(function(e){e.preventDefault(),e.stopPropagation(),localStorage.userToken&&Q?u(1):a()&&l()})}function X(e){e?$("#btnSubmit").addClass("enabled").attr("aria-disabled","false"):$("#btnSubmit").removeClass("enabled").attr("aria-disabled","true")}function ee(e,o){e=e||util.trim($("#join-confno").val());ie(o=o||$("#join-username").val()),uiAgent.showConnecting("join");var n=$("#connectOption").is(":checked"),i=setInterval(function(){null!==common.naclModule&&(clearInterval(i),common.postMessageToNaCl({type:"user",command:"user.joinConf",confNo:e,userName:o,password:v,loginType:h,loginToken:k,uid:b,domain:C,wtk:S,trackID:T,email:w,zak:y,zakt:L,pk:M.pk||"",notConnectAudio:n}))},500)}function oe(){var e,o=util.trim($("#join-confno").val()),n=$("#join-username").val();return!(""===o||""===n||!$("#btnSubmit").hasClass("enabled"))||(""===o?e=ne("join-confno"):""===n&&(e=ne("join-username")),$("#join-confno,#join-username").one("focus",function(){$("#join-confno,#join-username").removeClass("focus"),clearInterval(e)}),!1)}function ne(e){var o=0,n=setInterval(function(){if(6<=++o)return clearInterval(n),$("#"+e).removeClass("focus"),void $("#"+e).focus();o%2==1&&$("#"+e).addClass("focus"),o%2==0&&$("#"+e).removeClass("focus")},500);return n}function ie(e){e&&saveToLocal("screenName",e,function(){$("#screenName").val(e)})}var te=0,ae=void 0;function se(){chrome.storage.local.clear(function(e){chrome.runtime.lastError?re(0):(localStorage={},re(1))})}function re(e){e?$("#dev-tools .alert-storage").removeClass("forceHide alert-danger").addClass("alert-success").find("p").text("Clear Success."):$("#dev-tools .alert-storage").removeClass("forceHide alert-success").addClass("alert-danger").find("p").text("Clear failed.")}function le(){$(".version span").text(appObject.version),$("#domainInfo").text(backgroundWindow.getWebDomain()),$("#dev-tools .alert-storage").addClass("forceHide"),g.getLoginState()?$("#dev-tools .dropdown-menu, #dev-tools .caret").addClass("forceHide"):$("#dev-tools .dropdown-menu, #dev-tools .caret").removeClass("forceHide"),$("#dev-tools").modal({backdrop:!1,show:!0})}function ce(e,o){common.postMessageToNaCl({type:"conf",command:"conf.confirmPrivacyAndTOS",agree:e,resource:o})}return{setInMeeting:function(e){o=e},ifInMeeting:function(){return o},bindForm:function(){var o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;setMainAppWindowObject(mainWindow),uiAgent.appUIInit(),videoConstraints={video:!0},chrome.storage.local.get(null,function(e){chrome.runtime.lastError||(localStorage=e),client.showConfnoArrowAndScreenName(),client.joinFromUrl(),o&&u()}),a11y(),$("#zoom-logo, #dev-tools .about-logo").unbind("click").click(function(e){4===te&&($(this).hasClass("zoom-logo")?le():$("#dev-tools .modal-footer").removeClass("forceHide"),te=0),te++,clearTimeout(ae),ae=setTimeout(function(){te=0},500)}),$(".setting-window .icon-container").off("click").on("click",function(e){winMgr.createWindow("settingWindow","build/window/settingWindow.html",{width:680,height:600})}),$("#dev-tools .change-domain-group").undelegate("[data-domain]","click").delegate("[data-domain]","click",function(e){g.getLoginState()||(backgroundWindow.setWebDomain($(e.currentTarget).attr("data-domain")),$("#dev-tools").modal("hide"))}),$("#dev-tools .btn-clear-storage").unbind("click").click(function(){userStatus.isZRLogin?kiosk.verifyLockCode(userStatus.zrLockCode,"logout").then(se):0===userStatus.isZRLogin?H(se):se()}),$("#dev-tools .btn-clear-persistent").unbind("click").click(function(){weblog.stopWriter(),fsObj.clearAll(function(e){re(!e)})}),$(".dev").unbind("dblclick").dblclick(function(){le()}),$("#dev-tools").unbind("click").click(function(e){"dev-tools"===$(e.target).attr("id")&&$(this).modal("hide")}),$(".tab3 .container-other-login").undelegate("[id^=btn]","click").delegate("[id^=btn]","click",function(e){switch($(this).attr("id")){case"btn-login-google":J();break;case"btn-login-sso":i();break;case"btn-login-facebook":G();break;case"btn-activation":kiosk.showActivationPage(1)}})},saveConfList:function(e){var o,n=common.addSpace(e.meetingno),i={meetingno:n,meetingtopic:e.meetingtopic};if(void 0!==localStorage.confList){o=localStorage.confList;for(var t=0;t<o.length;t++)if(o[t].meetingno==n){o.splice(t,1);break}}else o=[];for(o.unshift(i);10<o.length;)o.pop();saveToLocal("confList",o)},verifyJoinPassword:function(e){common.postMessageToNaCl({type:"conf",command:"conf.setPassword",password:e})},joinBtnBindEventListener:function(){$("#btnSubmit").off("click").click(function(){oe()&&ee()}),$("#join-confno, #join-username").unbind("keydown").keydown(function(e){"13"==e.keyCode&&oe()&&ee()}),$("#login-form input[type=password],#login-form input[type=email]").unbind("keydown").keydown(function(e){"13"==e.keyCode&&a()&&l()}).unbind("input propertychange").bind("input propertychange",function(){Q=!1,0<util.trim($("#login-email").val()).length&&0<util.trim($("#login-pwd").val()).length?Y():Y(!1)}),Y(!1)},setJoinParameters:function(e,o,n,i,t,a,s,r,l,c,u,d,g,m){f=e,v=o,p=n,h=i,k=t,b=a,C=s,S=r,T=l,w=c,y=u,L=d,I=m,M=g},formSubmit:ee,formCheck:oe,validateJoinInputAndEnableSubmit:function(){var e=util.trim($("#join-username").val());o=util.trim($("#join-confno").val()),(/^[0-9]*$/.test(o)?8<o.length:4<o.length)&&1<=e.length?X(!0):X(!1);var o},login:E,signInToJoin:function(){common.postMessageToNaCl({type:"user",command:"user.signInToJoin"})},switchAccount:function(){common.postMessageToNaCl({type:"user",command:"user.switchAccount"})},loginZRroom:function(e,o,n){r(),common.postMessageToNaCl({type:"user",command:"user.loginZRroom",name:e,password:o,roomEmail:n})},loginWithToken:B,loginZRroomWithToken:F,startInstantMeeting:function(e,o){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;Z(),common.postMessageToNaCl({type:"user",command:"user.startConf",withVideo:e,alwaysUsePMI:o,audioOnly:n,duration:30})},logout:H,getGoogleLoginURL:J,loginGoogleWithTokens:function(e){common.postMessageToNaCl({type:"user",command:"user.loginGoogleWithTokens",url:e})},loginWithGoogleWithOAuth:D,getFBLoginURL:G,loginWithFacebook:V,getSSOLoginURL:K,querySSOVanityURLByEmail:_,loginWithSSOToken:q,loginSuccess:function(e){U(),d(),N(),m(),g.setLoginState(!0),$(".index-up .loading-container").removeClass("hideMe"),userStatus=Object.assign({},e),delete userStatus.EVENT,delete userStatus.TYPE;var s=userStatus.zoomToken;100!==userStatus.snsType&&(O(!0),s=userStatus["3rdLoginToken"]);var r=void 0,l=void 0,c=void 0,u="";0===userStatus.snsType?(u="https://www.facebook.com/logout.php?access_token=",u+=userStatus["3rdLoginToken"],u+="&next=http%3A%2F%2Fwww.zoom.us"):2===userStatus.snsType?(u="https://www.google.com/accounts/Logout",userStatus.refreshToken&&(r=userStatus.refreshToken),userStatus.expireIn&&(l=userStatus.expireIn),userStatus.createTimeSince1970inSec&&(c=userStatus.createTimeSince1970inSec)):101===userStatus.snsType&&(u=e.SSOLogoutUrl),getFromLocal("userToken",function(e){var o,n,i,t,a;2!==userStatus.snsType||r&&l&&c||(r=e.refreshToken,l=e.expireIn,c=e.createTimeSince1970inSec),o=s,n=u,i=r,t=l,a=c,saveToLocal("userToken",{type:userStatus.snsType,token:o,logoutUrl:n,refreshToken:i,expireIn:t,createTimeSince1970inSec:a,isSelectedRoomLogin:userStatus.isSelectedRoomLogin,roomEmail:userStatus.isSelectedRoomLogin?userStatus.email:""})}),uiAgent.showSignedInUI()},loginFailed:j,show3rdLogin:m,hideWebview:N,refreshLoginLoadingUI:W,getBuddyList:function(){common.postMessageToNaCl({type:"user",command:"user.getBuddyList"})},getRoomList:function(){common.postMessageToNaCl({type:"user",command:"user.getRoomList"})},searchBuddyByKey:function(e){common.postMessageToNaCl({type:"user",command:"user.searchBuddyByKey",key:e})},inviteBuddyToConf:function(e){common.postMessageToNaCl({type:"user",command:"user.inviteBuddyToConf",JIDArray:e})},renderSSO:i,renderWebview:function(){n(!1);var e=$("#login-webview")[0];$("#login-webview-wrapper").fadeIn(10,function(){$("#login-webview-wrapper").removeClass("screen-right hideMe")}),e.src="about:blank",$("#btn-back-zoom").one("click",function(e){N()})},clearStartJoinTimmer:P,startJoinTimmer:Z,showSsoDomainQueryFailedMsg:function(){$(".sso-domain-errmsg").removeClass("hideMe"),n(!1),clearTimeout(t),t=registerTimer(5e3,function(){$(".sso-domain-errmsg").addClass("hideMe")})},startCheckWindowHeartBeat:function(){clearInterval(e),e=setInterval(function(){backgroundWindow.setMainWindowExist()},1e3)},hideWaiting:function(){$(".waiting_container").addClass("hideMe")},saveScreenName:ie,showGDPR:function(e){d();var o=e.tosURL,n=e.privacyURL,i=e.resource,t=$("#modal-gdpr");t.find(".case").addClass("hideMe"),o&&n&&($("#modal-gdpr .gdpr-ts").attr("href",o),$("#modal-gdpr .gdpr-pp").attr("href",n));var a,s,r=1;"conf"===i&&(r=2),t.find(".case"+r).removeClass("hideMe"),1===r?$("#modal-gdpr .modal-dialog").css("width","560px"):$("#modal-gdpr .modal-dialog").css("width","480px"),a=i,(s=$("#modal-gdpr")).undelegate().delegate("button","click",function(e){$(this).hasClass("agree")?(s.modal("hide"),"conf"===a&&($(".waiting_container").addClass("hideMe"),uiAgent.showConnecting()),ce(1,a)):$(this).hasClass("disagree")?(s.find(".case").addClass("hideMe"),s.find(".case3").removeClass("hideMe")):$(this).hasClass("leave-meeting")&&(s.modal("hide"),ce(0,a))}),t.modal("show")},getLoginRetryFlag:function(){return R},loginMaintain:u,isLoginWithToken:function(){return c},hideLoginErrorMsg:function(){$(".login-error-msg").addClass("hideMe"),clearTimeout(A)},signInStateCheck:function(){return g.getLoginState()},loginSubmit:l,setKeepLogin:O,setVideoOption:function(){var e=$("#videoOption").is(":checked");meetingAutoStartMyVideo=!e},setLoginOption:function(){O(!!$("#keep-login-option").next().hasClass("selected"))},setPMIOption:function(){var e=$("#use-pmi-option").is(":checked");saveToLocal("usePMIOption",e)},enableLoginSubmitBtn:Y,cancelRetryLogin:U,lazyStartCallOut:function(e,o,n){common.postMessageToNaCl({type:"conf",command:"conf.lazyStartCallOut",countryCode:e,callOutNumber:o,callOutName:n||""})},getJoinParameters:function(){return{paraMeetingID:f,paraMeetingPassword:v,paraMeetingScreenName:p,paraMeetingLoginType:h,paraMeetingLoginToken:k,paraMeetingUid:b,paraDomain:C,paraWebinarToken:S,paraTrackId:T,paraEmail:w,paraZak:y,paraZakt:L,paramWebLaunchUrlScheme:M,paraIsRejoin:I}},clearLoginSubmitTimer:d}}();