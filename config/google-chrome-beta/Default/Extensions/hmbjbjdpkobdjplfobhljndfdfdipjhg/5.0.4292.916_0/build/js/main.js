"use strict";var micSpeehLevelTimer,BOStatusTimer,resizeTimer,editPollingURL,pollingStatusObject,pollingDocObject,pollingTimeInterval,elaspedPollingTimeSec,recordStatusObject,mainWindow,backgroundWindow,prevCPUUsage,willRejoin=!1,willJoinAnotherConf=!1,localStorage={},managedStorage={},attendeeList=[],viewerList=[],videoReady=!1,watingJoinVideo=[],canShowActiveSpeakerUI=1,telephoneUserNum=0,callInInfoObject={},callOutInfoObject={},chatObject={chatMsg:"",chatNum:0,curReceiverID:-1,curReceiverName:"",lastDtId:"",isAllowAttendeeChat:1,curToAllPanelist:0,isHost:0,attendeeChatPriviledge:-1},myStatusObject={id:0},CCStatusObject={canShowCCButton:0,hasAssignedCCEditor:0,CCEditroUserID:0,isMyself:0},recordingNodeIDs="",forceStartShare=!1,meetingAutoStartMyVideo=!0,lastVideoViewStatus=-1,machineInfo={archName:"",modleName:"",width:1280,height:720,widthInNativePixels:1280,heightInNativePixels:720},qaObject={qaContent:"",anonymously:!1,qaNum:0,qaQuestions:"",qaAnswers:"",qaDismissed:"",openNum:0,answeredNum:0,dismissedNum:0,isHostAllowAnonymous:!0};function resetqaObjet(){qaObject.qaContent="",qaObject.anonymously=!1,qaObject.qaNum=0,qaObject.qaQuestions="",qaObject.qaAnswers="",qaObject.qaDismissed="",qaObject.openNum=0,qaObject.answeredNum=0,qaObject.dismissedNum=0,qaObject.isHostAllowAnonymous=!0}function resetChatObject(){chatObject.chatMsg="",chatObject.chatNum=0,chatObject.curReceiverID=-1,chatObject.curReceiverName="",chatObject.lastDtId="",chatObject.isAllowAttendeeChat=1,chatObject.curToAllPanelist=0,chatObject.isHost=0,chatObject.attendeeChatPriviledge=-1}function uuidv4(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)})}function copyOneFile(e,t,i){return new Promise(function(n,o){e.getFile(t,{},function(e){e.copyTo(i,t,n,o)},function(e){o(e)})})}function copyBuildDirRequiredFiles(e,n,o,t){copyOneFile(e,"zcacert.pem",n).then(copyOneFile(e,"dingdong.pcm",n)).then(copyOneFile(e,"leave.pcm",n)).then(copyOneFile(e,"record_start.pcm",n)).then(copyOneFile(e,"record_stop.pcm",n)).then(o).catch(function(e){t(e)})}function copyBuildDirectory(){return new Promise(function(o,t){chrome.runtime.getPackageDirectoryEntry(function(e){e.getDirectory("build",{create:!1},function(n){window.webkitRequestFileSystem(window.PERSISTENT,1,function(e){e.root.getDirectory("bin",{create:!0},function(e){copyBuildDirRequiredFiles(n,e,o,t)},function(e){t(e)})},function(e){t(e)})},function(e){t(e)})})})}function deleteTmpDirectory(){return new Promise(function(n,e){window.webkitRequestFileSystem(window.PERSISTENT,1,function(e){e.root.getDirectory("tmp",{},function(e){e.removeRecursively(function(){n()},n)},n)})})}function initApp(){common.apiPermissionCheck(),commonModule.DisplaysMgr.getInstance().promiseGetDisplayInfo(),window.eev.emit(g.getConstants().APP_LIFE_CYCLE.APP_INIT),storeInMeetingPage(),addStorageChangeListener(),client.initAppUI(),addWinMsgListener(),addWindowBoundsListener(),commonModule.DeviceMgr.getInstance().checkMicSpkCamDevice(),commonModule.DisplaysMgr.getInstance().addDisplayesChangeListener(),getCpuUsage(),addNetWorkChangeListener(),commonModule.prepareFloatVideoInAdvance()}document.addEventListener("DOMContentLoaded",function(){copyBuildDirectory().then(function(){}).then(preloadLocalStorage).then(preloadManagedStorage).then(userSettings.transformAppSettingForOldVersion).then(loadCPUInfo).then(function(){chrome.runtime.getManifest();initApp(),common.domContentLoaded("/build/zoom",200,0)}).catch(function(e){console.error(e)})});var cpuInfo=null;function loadCPUInfo(){return new Promise(function(n){chrome.system.cpu.getInfo(function(e){cpuInfo={coreNumber:e.numOfProcessors||1,archName:e.archName,modelName:e.modelName,features:e.features},n()})})}function checkWindowForSecondaryScreen(){commonModule.DisplaysMgr.getInstance().promiseGetDisplayInfo().then(commonModule.rendererMgr.getInstance().checkSecondaryScreenWindowByDisplays)}function getCpuUsage(){chrome.system.cpu.getInfo(function(e){prevCPUUsage=e.processors})}function addNetWorkChangeListener(){naclNetworkChange(navigator.connection),navigator.connection.onchange=onNetworkChange}function onNetworkChange(e){var n=e.target;naclNetworkChange(n),n=navigator.connection}function naclNetworkChange(e){var n=e.effectiveType,o=e.type;common.naclModule?common.postMessageToNaCl({command:"networkInfo",networkType:o,effectiveType:n}):util.deferTodo(function(){naclNetworkChange(e)},1e3)}function addWinMsgListener(){chrome.runtime.onMessage.addListener(function(e,n,o){"joinAudio_fromWin"==e.message?(inmeeting.joinAudio(),o({reply:"success"})):"leaveMeeting_fromWin"==e.message?(inmeeting.leaveMeeting(),o({reply:"success"})):"endMeeting_fromWin"==e.message?(inmeeting.endMeeting(),o({reply:"success"})):"refreshParticipantList_fromWin"==e.message?o({reply:"success",attendeeList:attendeeList}):"showJoinForm_fromWin"==e.message?(client.showJoinForm(),o({reply:"success"})):"verifyJoinPassword_fromWin"==e.message&&(joinmeeting.verifyJoinPassword(e.password),o({reply:"success"}))})}function addIdleListener(e){chrome.idle&&chrome.idle.onStateChanged.addListener(e)}function removeIdleListener(e){chrome.idle&&chrome.idle.onStateChanged.removeListener(e)}function onIdleChanged(e){switch(e){case"idle":break;case"locked":inmeeting.leaveMeeting()}}function addWindowBoundsListener(){mainWindow.onBoundsChanged.addListener(onMainWindowSizeChanged),mainWindow.onFullscreened.addListener(function(){inmeeting.onWindowFullScreened(),eev.emit(g.getConstants().MAIN_WINDOW_FULLSCREEN)}),mainWindow.onMinimized.addListener(function(){client.onWindowMinimized(),eev.emit(g.getConstants().MAIN_WINDOW_MINIMIZE)}),mainWindow.onRestored.addListener(function(){mainWindow.isFullscreen()||(setListenerWidthThrottle&&setListenerWidthThrottle.flush(),client.onWindowRestored(),eev.emit(g.getConstants().MAIN_WINDOW_RESTORE))})}var audioStream,deviceAwakeFlag=0;function keepDeviceAwake(e){common.hasApi_Power()&&e!=deviceAwakeFlag&&(e?(deviceAwakeFlag=1,chrome.power.requestKeepAwake("display")):(deviceAwakeFlag=0,chrome.power.releaseKeepAwake()))}var videoStream,videoTrack,audioTrack=null,prevAudioTrack=null;function audioSuccess(e){var n=(audioStream=e).getAudioTracks()[0];n?((prevAudioTrack=prevAudioTrack&&n.id==prevAudioTrack.id?null:audioTrack)&&prevAudioTrack.stop(),(audioTrack=n).onended=onAudioTrackEnded,common.postMessageToNaCl({type:"audio",command:"audio.setTrack",track:audioTrack,trackId:audioTrack.id,trackLabel:audioTrack.label.replace(/,/g,"")})):console.error("audioTrack is invalid")}function onAudioTrackEnded(){}function audioFailure(e){common.logMessage("Error: "+e)}function stopAllAudioTracks(){if(void 0!==audioStream){var e=audioStream.getAudioTracks()[0];"ended"!=e.readyState&&e.stop()}}function sendInitVideoCommand(n){commonModule.DisplaysMgr.getInstance().promiseGetDisplayInfo().then(function(e){common.postMessageToNaCl({type:"video",command:"video.initVideo",track:n,videoIsOpen:!!n,mirrorEffect:getMirrorEffect()})})}function stopVideoTrack(){if(stopNewVideoCaptureTimer(),void 0!==videoStream){var e=videoStream.getVideoTracks()[0];"ended"!=e.readyState&&e.stop()}}function assignNewVideoTrack(e){(videoTrack=(videoStream=e).getVideoTracks()[0]).onended=onVideoTrackEnded}var newVideoCaptureTimer=null,newVideoCaptureCanvas=null,newVideoCaptureVideo=null,newVideoImageCapture=null,needNewVideoExternalData=!0;function stopNewVideoCaptureTimer(){newVideoCaptureTimer&&(clearInterval(newVideoCaptureTimer),newVideoCaptureTimer=null),needNewVideoExternalData=!0}function startNewVideoCaptureTimer(){stopNewVideoCaptureTimer(),newVideoImageCapture=new ImageCapture(videoTrack);newVideoCaptureCanvas=new OffscreenCanvas(640,360),needNewVideoExternalData=!0,newVideoCaptureTimer=setInterval(function(){!0===needNewVideoExternalData&&(newVideoImageCapture.grabFrame().then(function(e){var n=newVideoCaptureCanvas.getContext("2d");n.drawImage(e,0,0,640,360);var o=n.getImageData(0,0,640,360),t=new Uint8Array(o.data.buffer);common.naclModule.postMessage({type:"video",command:"video.newVideoCaptureData",data:t.buffer,width:o.width,height:o.height})}).catch(function(e){}),needNewVideoExternalData=!1)},75)}function checkOldVideoCaptureWorkswell(){window.setTimeout(function(){common.naclModule.postMessage({type:"video",command:"video.checkOldVideoCaptureWorkswell"})},2e3)}function videoSuccess(e){inmeeting.updateMyVideoState(g.getConstants().VIDEO_STATE_START),stopVideoTrack(),assignNewVideoTrack(e),sendInitVideoCommand(videoStream.getVideoTracks()[0]),checkOldVideoCaptureWorkswell()}function videoSuccess2(e){inmeeting.updateMyVideoState(g.getConstants().VIDEO_STATE_START),stopVideoTrack(),assignNewVideoTrack(e),common.postMessageToNaCl({type:"video",command:"video.startSendMyVideo",track:videoStream.getVideoTracks()[0],mirrorEffect:getMirrorEffect()}),checkOldVideoCaptureWorkswell()}function onVideoTrackEnded(){inmeeting.stopMyVideo()}function videoFailure(e){inmeeting.updateMyVideoState(g.getConstants().VIDEO_STATE_CLOSE),uiAgent.updateVideoButton(!0),common.logMessage("videoFailure Error: ",e),sendInitVideoCommand(null)}var gMonitorTimer=null;function startMonitorResource(){var r=0,s=0;gMonitorTimer&&(clearInterval(gMonitorTimer),gMonitorTimer=null),gMonitorTimer=setInterval(function(){chrome.system.cpu.getInfo(function(e){for(var n=0,o=r=0;o<e.processors.length;++o){var t=e.processors[o].usage,i=prevCPUUsage[o].usage;if(0!==t.total&&(n++,t.total!=i.total)){var a=Math.floor((t.kernel+t.user-i.kernel-i.user)/(t.total-i.total)*100);r+=a}}0<n?r/=n:r=0,prevCPUUsage=e.processors,chrome.system.memory.getInfo(function(e){s=Math.ceil((e.capacity-e.availableCapacity)/e.capacity*100);var n=videocontrol.decideDyPrefLevel(r);common.postMessageToNaCl({command:"realtimeResourceInfo",cpuUsage:r,memoryUsage:s,dyPrefLevel:n})})})},1e3)}function onMainWindowSizeChanged(){var e=mainWindow.innerBounds.width,n=mainWindow.innerBounds.height-30,o=30;($(".viewport").css("width",e),mainWindow.isFullscreen())?(n=mainWindow.innerBounds.height,o=0):$("body").hasClass("hasSidePanel")?(e<=580&&resetMainWindwMinWidth(580),e-=320):e<=260&&resetMainWindwMinWidth(260);toolbar.resize(e),toolbar.respondToWindowResize({toolbarWidth:e}),inmeeting.relocateCCToolTipPos(),client.correctShareOptionPosition(),mainWindow.isFullscreen()?(setListenerWidthThrottle.cancel(),setListenerWidth(e,n,o)):setListenerWidthThrottle(e,n,o)}var setListenerWidthThrottle=_.throttle(setListenerWidth,500,{leading:!1,trailing:!0});function setListenerWidth(e,n,o){$("#listener").css({width:e,height:n,top:o})}function resetMainWindwMinWidth(e){mainAppChromeWindow.innerBounds.minWidth=e}function resizeMainWindow(e,n,o){mainWindow.resizeTo(e,n+30),o&&mainWindow.moveTo((screen.availWidth-e)/2,(screen.availHeight-(n+30))/2)}function restoreMainWindow(){mainWindow.isFullscreen()||mainWindow.innerBounds.width===screen.width&&mainWindow.innerBounds.height===screen.height?(mainWindow.restore(),mainWindow.fullscreen()):mainWindow.isMinimized()&&mainWindow.restore(),mainWindow.focus()}function moduleDidLoad(){void 0===localStorage.uuid&&(localStorage.uuid=uuidv4(),saveToLocal("uuid",localStorage.uuid));var e=userSettings.getAllAudioSettings(),n=userSettings.getAllVideoSettings();common.postMessageToNaCl({command:"initparam",policy:managedStorage,localStorage:localStorage,audioSettings:e,videoSettings:n,cpuInfo:cpuInfo,rejoin:backgroundWindow.getIsRejoin()}),backgroundWindow.setIsRejoin(!1);var o={command:"hello",userAgent:navigator.userAgent,osVersion:/Chrome\/([0-9.]+)/.exec(navigator.userAgent)[1],appVersion:appObject.version,isKiosk:backgroundWindow.isKioskApp(),isKioskSession:backgroundWindow.isKioskSession()};common.postMessageToNaCl(o),backgroundWindow.getIsWeblaunched()||window.eev.emit(g.getConstants().NACL_LOADED,managedStorage)}function getMirrorEffect(){return userSettings.getAppSetting(userSettings.MIRROR_EFFECT)}function setMirrorEffect(e){}function getAttendeeObject(e,n){var o={};"undefined"!==n&&n&&(o=null);for(var t=0;t<attendeeList.length;t++)if(attendeeList[t].id>>10==e>>10){o=attendeeList[t];break}return o}function getWaitingUserObject(e){for(var n={},o=0;o<g.getMeetingStatusObj().waitingUserList.length;o++)if(g.getMeetingStatusObj().waitingUserList[o].userID>>10==e>>10){n=g.getMeetingStatusObj().waitingUserList[o];break}return n}function findHostAttendeeObject(e){var n={};"undefined"!==e&&e&&(n=null);for(var o=0;o<attendeeList.length;o++)if(attendeeList[o].isHost){n=attendeeList[o];break}return n}function existRaiseHandAttendee(){for(var e=0,n=0;n<attendeeList.length;n++)if(attendeeList[n].isRaiseHand){e=1;break}return e}function isWebinarViewerMode(){return!(!g.getMeetingStatusObj().isWebinar||!g.getMeetingStatusObj().meetingIsViewOnly)}var isNaClReloaded=!1,userStatus={};function stopEventandTimer(){$(document).undelegate(".window-close","click"),inmeeting.offShortCuts(),common.stopAllTimer()}function uiReset(){closeAllWindowExceptWinByID(["","meetingInvitationWin","invalidRoomWindow"]),g.getMeetingStatusObj().isInWaitingRoom&&(inmeeting.outWaitingRoom(),inmeeting.fullScreen()),resetAttendeeView("attendee"),resetAttendeeView("activeSpeaker"),client.resetTopLeftIcons(),$("#next4attendee").addClass("hideMe"),$("#content").removeClass("hideMe forceHide"),$(".connecting").addClass("hideMe"),$(".waiting_container").addClass("hideMe"),$("#listener").css("z-index",-5),$("#join-confno").val(""),client.TalkingUserBar.reset(),uiAgent.showShareOption(0),commonModule.rendererMgr.getInstance().reset(),commonModule.DeviceMgr.getInstance().resetInMeetingUsingDevice(),inmeeting.outWaitingRoom()}function resetUIandData(){myStatusObject={id:0},attendeeList=[],viewerList=[],g.resetMeetingStatusObj(),inmeeting.resetccObj(),inmeeting.resetboObj(),resetqaObjet(),resetChatObject(),backgroundWindow.clearMeetingID(),backgroundWindow.setIsWeblaunched(!1),uiReset(),willRejoin||inmeeting.restorScreen(),switchUIToOutsideMeeting(),reformLoginEmail()}function prepareNextMeeting(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;joinmeeting.setInMeeting(!1),joinmeeting.setJoinParameters("","","","","","","","","","","","",!1),joinmeeting.joinBtnBindEventListener(),joinmeeting.bindForm(e)}function reloadJoinMeetingPageandNaClModule(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;isNaClReloaded||(window.eev.emit(g.getConstants().RELOAD_JOINMEETING_PAGE_AND_NACL_MODULE),stopAllAudioTracks(),inmeeting.stopMyVideo(),e&&common.removeModule(),stopEventandTimer(),resetUIandData(),e?(common.removeModule(),common.attachDefaultListeners(),common.createNaClModule("zoom",200,0),willRejoin=!1):naclReleaseConfResource(),isNaClReloaded=!0,prepareNextMeeting(e))}function reformLoginEmail(){g.getLoginState()&&localStorage.userEmail&&$("#login-email").val(localStorage.userEmail)}function naclReleaseConfResource(){common.postMessageToNaCl({type:"conf",command:"conf.releaseConfResource"})}function switchUIToOutsideMeeting(){window.eev.emit(g.getConstants().SWITCH_TO_OUTSIDE_MEETING_REMOVE_TOOOLBAR_EVENT),$("#outsideMeeting").removeClass("forceHide"),$("#insideMeeting").addClass("forceHide").focusOut(),$("#insideMeeting").replaceWith($inMeeting.clone()),willRejoin||(willJoinAnotherConf?client.showConnecting("join"):(client.showConfnoArrowAndScreenName(),!0===g.getLoginState()?client.showSignedInUI():(client.showSignedOutUI(),client.initLoginUI())))}function switchUIToInmeeting(){$("#outsideMeeting").addClass("forceHide"),$("#insideMeeting").removeClass("forceHide").focusIn(),mainWindow.isFullscreen()&&inmeeting.onWindowFullScreened(),commonModule.rendererMgr.getInstance().onSyncBackgroundBlur(0)}var webViewforLogin,$inMeeting,LaunchConfReason_JoinBO=10,LaunchConfReason_LeaveBO=11;function handleMessageNotifyLoginResult(e){0===e.result?joinmeeting.loginSuccess(e):joinmeeting.loginFailed(e)}function getParamFromUrl(e,n,o){var t=n.split(e),i="";if(t.length<2)return"";for(var a=t[1].split("&"),r=0,s=a.length;r<s;r++){var d=a[r].split("=");if(o===d[0]){i=d[1];break}}return i}function generateScriptText(e){return'(function() {\n  var script = document.createElement("script");\n  script.innerHTML = "(function() { ('+e.toString().replace(/"/g,'\\"').replace(/(\r?\n|\r)/g,"\\n")+')(); })()" \n  document.body.appendChild(script);\n})()'}function setCookieForCCTypeandIDFn(){var e=new Date;e.setDate(e.getDate()+30),document.cookie="_zm_sf=cc;expires="+e.toGMTString()+";path=/;domain=zoom.us",document.cookie="_zm_cc_id=hmbjbjdpkobdjplfobhljndfdfdipjhg;expires="+e.toGMTString()+";path=/;domain=zoom.us"}function getAppID(){return"Zoom for Chromebase/Chromebox (Dev)"==chrome.runtime.getManifest().name?"hglfgbcklajbcdckdegihdoecfdelmkd":"hmbjbjdpkobdjplfobhljndfdfdipjhg"}function setCookieForCCTypeandID(){try{var e="var exdate = new Date(); exdate.setDate(exdate.getDate() + 30); document.cookie =  '_zm_cc_id="+getAppID()+";expires=' + exdate.toGMTString() + ';path=/;domain=zoom.us'; ";webViewforLogin.executeScript({code:e},function(){chrome.runtime.lastError&&console.error(chrome.runtime.lastError.message)})}catch(e){}}function removeCustomizedEventForWebview(){removeCustomizedEventForWebview_google(),removeCustomizedEventForWebview_FB(),removeCustomizedEventForWebview_SSO()}function removeCustomizedEventForWebview_google(){webViewforLogin.removeEventListener("loadstart",googleLoginLoadStartFunc),webViewforLogin.removeEventListener("loadredirect",googleLoginLoadRedirectFunc),webViewforLogin.removeEventListener("loadstop",googleLoginLoadStopFunc)}function removeCustomizedEventForWebview_FB(){webViewforLogin.removeEventListener("loadstart",FBLoginLoadStartFunc),webViewforLogin.removeEventListener("loadredirect",FBLoginLoadRedirectFunc),webViewforLogin.removeEventListener("loadstop",FBLoginLoadStopFunc)}function removeCustomizedEventForWebview_SSO(){webViewforLogin.removeEventListener("loadstart",SSOLoginLoadStartFunc),webViewforLogin.removeEventListener("loadredirect",SSOLoginLoadRedirectFunc),webViewforLogin.removeEventListener("loadstop",SSOLoginLoadStopFunc)}function addCustomizedEventForWebview(e,n,o){webViewforLogin.removeEventListener("loadstart",e),webViewforLogin.addEventListener("loadstart",e),webViewforLogin.removeEventListener("loadredirect",n),webViewforLogin.addEventListener("loadredirect",n),webViewforLogin.removeEventListener("loadstop",o),webViewforLogin.addEventListener("loadstop",o)}function parseZoomusProtocol(e){if(-1!==e.indexOf("zoomus://")||-1!==e.indexOf("zoommtg://"))if(joinmeeting.hideWebview(),joinmeeting.show3rdLogin(!1),joinmeeting.refreshLoginLoadingUI(),"0"==getParamFromUrl("?",e,"errorno"))joinmeeting.loginGoogleWithTokens(e);else getParamFromUrl("?",e,"errormsg")}function parseZoomusProtocolForSSO(e){if(-1!==e.indexOf("zoomus://")||-1!==e.indexOf("zoommtg://")){joinmeeting.hideWebview(),joinmeeting.show3rdLogin(!1),joinmeeting.refreshLoginLoadingUI(),$("#btn-sso-back").click();var n=getParamFromUrl("?",e,"token");null===n&&void 0===n&&""===n||joinmeeting.loginWithSSOToken(n)}}function parseZoomusProtocolForSSO2(e){joinmeeting.hideWebview(),joinmeeting.show3rdLogin(!1),joinmeeting.refreshLoginLoadingUI(),$("#btn-sso-back").click(),joinmeeting.loginWithSSOToken(e)}function googleLoginLoadStartFunc(e){$(".webview-loading").removeClass("hideMe"),parseZoomusProtocol(e.url)}function googleLoginLoadRedirectFunc(e){parseZoomusProtocol(e.newUrl)}function googleLoginLoadStopFunc(e){$(".webview-loading").addClass("hideMe")}function googleLoginCB(){removeCustomizedEventForWebview(),addCustomizedEventForWebview(googleLoginLoadStartFunc,googleLoginLoadRedirectFunc,googleLoginLoadStopFunc)}function parseZoomusProtocolForFB(e){if(-1!==e.indexOf("zoomus://")||-1!==e.indexOf("zoommtg://")||-1!==e.indexOf("zoomroom://")){joinmeeting.hideWebview(),joinmeeting.show3rdLogin(!1),joinmeeting.refreshLoginLoadingUI();var n=getParamFromUrl("?",e,"token");null===n&&void 0===n&&""===n||(e=decodeURIComponent(e),joinmeeting.loginWithFacebook("","",e))}}function FBLoginLoadStartFunc(e){$(".webview-loading").removeClass("hideMe"),parseZoomusProtocolForFB(e.url)}function FBLoginLoadRedirectFunc(e){parseZoomusProtocolForFB(e.newUrl)}function FBLoginLoadStopFunc(e){googleLoginLoadStopFunc(e)}function FBLoginCB(){removeCustomizedEventForWebview(),addCustomizedEventForWebview(FBLoginLoadStartFunc,FBLoginLoadRedirectFunc,FBLoginLoadStopFunc)}function SSOLoginLoadStartFunc(e){$(".webview-loading").removeClass("hideMe"),parseZoomusProtocolForSSO(e.url)}function SSOLoginLoadRedirectFunc(e){parseZoomusProtocolForSSO(e.newUrl)}function SSOLoginLoadStopFunc(e){googleLoginLoadStopFunc(e)}function SSOLoginCB(){joinmeeting.renderWebview(),removeCustomizedEventForWebview(),addCustomizedEventForWebview(SSOLoginLoadStartFunc,SSOLoginLoadRedirectFunc,SSOLoginLoadStopFunc)}function create3rdPartyLoginWebview(e){switch(webViewforLogin=document.getElementById("login-webview"),e.EVENT){case"onGetGoogleLoginURL":open(e.GoogleLoginURL);break;case"onGetFBLoginURL":open(e.FBLoginURL);break;case"onGetSSOLoginURL":open(e.authUrl)}}function resetAttendeeView(e){var n="attendee_";"activeSpeaker"==e?n="activeSpeaker_":"attendee"==e&&(n="attendee_"),$("#listener [id^="+n+"]").remove()}function showHideUsername(e,n,o){n||o?$(e).removeClass("forceHide"):$(e).addClass("forceHide")}function hasAvatarForUser(e){return""!==e.smallPicUrl||""!==e.bigPicUrl}function createAttendVideo(e){var n=e.userId>>10<<10,o=getAttendeeObject(e.userId,!0),t=$("#listener");if(o){$("<i style='display: inline-block;'></i>").addClass("img-bandwidth img-sprite "+o.netQuality);var i=$("<i style='display: inline-block;'></i>").addClass("img-listAudioOff forceHide"),a=$("<i style='display: inline-block;'></i>").addClass("img-listPhoneOff img-sprite forceHide"),r=$("<span></span>").css({opacity:.8,color:"white",inlineHeight:"16px",verticalAlign:"top",display:"inline-block",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",flexGrow:1}).text(o.name).addClass("name_"+n).addClass("nameSpan"),s=$("<div></div>").css({position:"absolute",left:"0px",bottom:"0px",height:"22px",background:"rgba(0, 0, 0, 0.5)",maxWidth:"100%",display:"flex",alignItems:"center"}),d=$("<div></div>").attr("id","attendee_"+n).css({position:"absolute",left:e.left+"px",top:e.top+"px",width:e.width+"px",height:e.height+"px",display:"block",zIndex:"40"}).addClass("attendee"),c=document.createElement("div");c.className="div-video-toolbar",c.style.display="none";var l=document.createElement("span");return l.className="div-video-toolbar-pin",l.dataset.name="pin",c.appendChild(l),needShowAvatar(e)?(d.css("background","#222222"),showAvatar(d,e.userId,!0)):d.css("background",""),showHideUsername(r,!needShowAvatar(e),hasAvatarForUser(o)),s.append(i,a,r),d.append(c,s),t.append(d),inmeeting.showMuteIcon(o.audioIsMuted,e.userId,o.audioType),d}}function createActiveVideo(e){var n=e.userId>>10<<10,o=getAttendeeObject(e.userId,!0);if(!o)return null;var t=$("#listener"),i=$("<i style='display: inline-block;'></i>").addClass("img-bandwidth img-sprite "+o.netQuality),a=$("<i style='display: inline-block;'></i>").addClass("img-listAudioOff forceHide"),r=$("<i style='display: inline-block;'></i>").addClass("img-listPhoneOff img-sprite forceHide"),s=$("<span></span>").css({opacity:.8,color:"white",inlineHeight:"16px",verticalAlign:"top",display:"inline-block",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}).text(o.name).addClass("name_"+n).addClass("nameSpan");s.css("maxWidth","400px");var d=$("<div></div>").css({position:"absolute",left:"0px",bottom:"0px",height:"22px",background:"rgba(0, 0, 0, 0.5)"}),c=$("<div></div>").css({position:"absolute",left:e.left+"px",top:e.top+"px",width:e.width+"px",height:e.height+"px",display:"block"}),l=document.createElement("div");l.className="div-video-toolbar",l.style.display="none";var u=document.createElement("span");return u.className="div-video-toolbar-pin",u.dataset.name="pin",l.appendChild(u),c.attr("id","activeSpeaker_"+n).css({zIndex:39,border:""}),d.addClass("active-speaker"),needShowAvatar(e)&&showAvatar(c,e.userId,!1),showHideUsername(s,!needShowAvatar(e),hasAvatarForUser(o)),d.append(i),d.append(a,r,s),c.append(l,d),t.append(c),toolbar.isShow()&&toolbar.shouldActiveSpeakerTooltipUp(e.height,e.top)&&d.css("bottom","52px"),inmeeting.showMuteIcon(o.audioIsMuted,e.userId,o.audioType),c}function onVideoUINotifyDelete(e){var n=e.userId>>10<<10;$("#listener>#attendee_"+n).remove()}function onVideoUINotifyUpdate(e){var n=e.userId>>10<<10,o=$("#listener>#attendee_"+n);$("#listener");if(0===o.length||o.hasClass("attendee_type_thumbvideo"))o=createAttendVideo(e);else{o.css({left:e.left+"px",top:e.top+"px",width:e.width+"px",height:e.height+"px"}),needShowAvatar(e)?(o.css("background","#222222"),showAvatar(o,e.userId,!0)):(o.children("img").remove(),o.find(".avatar-name").remove(),o.css("background",""));var t=getAttendeeObject(e.userId,!0);t&&showHideUsername(o.find(".nameSpan"),!needShowAvatar(e),hasAvatarForUser(t))}e.canPinUser?o&&o.addClass("canShowPin"):o&&o.removeClass("canShowPin").find(".div-video-toolbar").css("display","none")}function onVideoUIActiveSpeakerUpdate(e){var n=e.userId>>10<<10,o=$("#listener>#activeSpeaker_"+n);if(0===o.length)resetAttendeeView("activeSpeaker"),o=createActiveVideo(e);else{var t=getAttendeeObject(n,!0);if(!t)return;o.css({left:e.left+"px",top:e.top+"px",width:e.width+"px",height:e.height+"px"}),needShowAvatar(e)?showAvatar(o,e.userId,!0):(o.children("img").remove(),o.find(".avatar-name").remove()),showHideUsername(o.find(".nameSpan"),!needShowAvatar(e),hasAvatarForUser(t))}toolbar.isShow()&&toolbar.moveActiveSpeakerTooltipUp()}function showAvatarXhr(e,n,o,t,i){var a=new XMLHttpRequest;a.open("GET",n,!0),a.timeout=1e4,a.responseType="blob",a.onload=function(){200==a.status&&document.getElementById(i.id)?(i.src=window.URL.createObjectURL(this.response),e?t.picBlobUrlSmall=i.src:t.picBlobUrlBig=i.src):o(t,i)},a.onerror=function(){o(t,i)},a.onabort=function(){o(t,i)},a.ontimeout=function(){o(t,i)},a.send()}function showDefaultAvatar(e,n){e.isTelephoneUser?n.src="/build/static/images/phone.svg":e.isH323User?n.src="/build/static/images/inmeeting_avatar_h323.png":backgroundWindow.isKioskApp()?n.src="/build/static/images/zr_avatar.png":n.src="/build/static/images/avatar.png"}function showSmallAvatar(e,n){e.picBlobUrlSmall?n.src=e.picBlobUrlSmall:showAvatarXhr(!0,e.smallPicUrl,showDefaultAvatar,e,n)}function needShowAvatar(e){if(!e.videoIsSending)return!0;var n=mainAppHtmlWindow.g.getMeetingStatusObj();return!!(n&&n.bandwidthLimit&&n.bandwidthLimit.disable_receive_video)&&!(e.isMyself&&!n.bandwidthLimit.disable_send_video)}function showAvatar(e,n,o){var t=getAttendeeObject(n,!0);if(t){var i=n>>10<<10,a=$(e);if(a.children("img").remove(),a.find(".avatar-name").remove(),""==t.smallPicUrl&&""==t.bigPicUrl){var r=document.createElement("div");r.textContent=t.name,r.className="avatar-name name_"+i;var s=Math.max(18,Math.min(48,a.width()/17));if(r.style.fontSize=s+"px",t.isTelephoneUser){var d=$("<img/>").attr("id","img_"+i).css({position:"absolute",left:"40%",top:"20%",width:"20%",transform:"rotate(-135deg)"});showDefaultAvatar(t,d[0]),a.append(d),r.style.top="65%"}a.append(r)}else{var c=$("<img/>").attr("id","img_"+i).css({position:"absolute",left:"50%",top:"50%",width:"35%",maxHeight:"90%",transform:"translate(-50%, -50%)"});t.picBlobUrlBig?c.attr("src",t.picBlobUrlBig):showAvatarXhr(!1,t.bigPicUrl,showSmallAvatar,t,c[0]),a.append(c)}}}function storeInMeetingPage(){$inMeeting=$("#insideMeeting").clone()}function refreshStoreInmeetingPageToTouch(e){var n="#kiosk-toolbar,#kiosk-toolbar-pt-num,#window-controls,#page-participants,.toolbar-waiting-room,.waitingRoomNotice,.waitingRoomNotice,#page-invite,.turnpage-button-group, #window-record-consent";e?$inMeeting.find(n).removeClass("meeting-mode"):$inMeeting.find(n).addClass("meeting-mode")}function zoomDebug(e,n){common.postMessageToNaCl({command:"zoomDebug",action:e,param:n})}function preloadLocalStorage(){return chrome.runtime.getBackgroundPage(function(n){getFromLocal("webDomain",function(e){e?n.setWebDomain(e):n.setWebDomain("https://www.zoom.us")})}),new Promise(function(n,e){chrome.storage.local.get(null,function(e){localStorage=e,chrome.runtime.lastError,n()})})}function preloadManagedStorage(){return new Promise(function(n,e){chrome.storage.managed.get(null,function(e){managedStorage=e,chrome.runtime.lastError,n()})})}function isInTabletMode(){return commonModule.DisplaysMgr.getInstance().getPrimaryWindowDisplay().isTabletMode}function openQA(){winMgr.createWindow("qaWin","build/window/qaWindow.html",{width:500,height:600,minWidth:500,minHeight:600,resizable:!0},function(e){e.contentWindow.qa.initQAWin()})}