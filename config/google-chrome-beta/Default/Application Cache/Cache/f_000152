function n4f(a,b){F(a,1,b)}function o4f(){var a=pM.getInstance();return new cn(function(b,c){$pe(a,"/dbx/schedules",function(d){var e=new lk;e.Gg=!0;d=e.Nc(w7b.xa(),d.De());b(d)},c)})}function p4f(a){var b=pM.getInstance(),c=new lk;c.Gg=!0;var d=c.serialize(a);return new cn(function(e,f){qM(b,"/dbx/createSchedule",[],d,function(h){c.Gg=!0;h=c.Nc(q7b.xa(),h.De());e(h)},f)})}
function q4f(a){var b=pM.getInstance(),c=new lk;c.Gg=!0;var d=c.serialize(a);return new cn(function(e,f){qM(b,"/dbx/updateSchedule",[],d,function(h){c.Gg=!0;h=c.Nc(u7b.xa(),h.De());e(h)},f)})}function r4f(a){if(ritz_api.BigSheetsApi.isExternalDataForDatasourceSheetPreview(a))return!1;a=ritz_api.BigSheetsApi.getDbObjectTypeForExternalDataSourceId(a);return D9b.has(a)}function s4f(a){var b=[];a=ja(a.C.keys());for(var c=a.next();!c.done;c=a.next())c=c.value,r4f(c)&&b.push(c);return b}
function t4f(a){if(a.F)return[];var b=[];a.C.forEach(function(c,d){t9b.has(c.D)&&r4f(d)&&b.push(d)});return b}function u4f(a,b){b=b.map(function(c){return new nsd(c.Dq(),c.Eh())});ysd(a,b)}function v4f(a,b,c,d){vsd(a.L,b,function(e){var f=e.filter(function(h){return 3==h.Eh().getState()});u4f(a,f);c(e)},function(e){u4f(a,e);d(e)})}function w4f(a){a.Db()&&mJe(a.H)}function x4f(a,b){pJe.call(this,a,b)}u(x4f,pJe);x4f.prototype.R=function(){this.refresh()};
x4f.prototype.refresh=function(){if(this.Db()){var a=FB.isEnabled();a=this.J&&this.L&&a&&0<t4f(this.F).length;this.C.Na(a)}};x4f.prototype.O=m("Refresh all");function y4f(a,b,c){b=c||b;a=a||{};a=""+R(c_(Sv({title:"Connected sheets",Iu:"waffle-dataconnector-refresh-sidepane",nC:Vv(""+R(gA({icon:"docs-icon-img docs-icon-database"},b))),$j:Vv('<div class="'+T("waffle-dataconnector-refresh-sidepane-container")+'"><div class="'+T("waffle-dataconnector-refresh-sidepane-refresh-widget")+'"></div></div><div class="'+T("waffle-dataconnector-refresh-sidepane-backdrop")+'"></div>'),UQ:!0,eR:Vv('<div class="'+T("waffle-dataconnector-refresh-sidepane-footer-wrapper")+
'"></div>')},a),b));return S(a)};function z4f(){return S('<div class="'+T("waffle-dataconnector-refresh-all-pane")+'"><div class="'+T("waffle-dataconnector-refresh-all-stale-msg")+'">This panel may be out of date. Close and reopen it to display the latest information.</div><div class="'+T("waffle-dataconnector-refresh-all-datasources-container")+'"></div></div>')}
function A4f(){return S('<div class="'+T("waffle-dataconnector-refresh-all-dbobject-list-items-container")+'"></div><div class="'+T("waffle-dataconnector-refresh-all-dbobject-list-footer-container")+'"></div>')}function B4f(a,b,c){b=c||b;return S('<div class="'+T("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title")+'"></div>'+A4f(null,b))}
function C4f(){return S('<div class="'+T("waffle-dataconnector-refresh-all-dbobject-list-footer")+'"><div class="'+T("waffle-dataconnector-refresh-all-dbobject-list-footer-bytes-wrapper")+'"></div><div class="'+T("waffle-dataconnector-refresh-all-dbobject-list-footer-button-wrapper")+'"></div></div>')}
function D4f(a){a=a.title;return S('<div class="'+T("waffle-dataconnector-refresh-all-dbobject-item")+'" tabindex="0"><div class="'+T("waffle-dataconnector-refresh-all-dbobject-item-icon-wrapper")+'"><div class="'+T("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh")+'">'+R(Uqe(null))+'</div><div class="'+T("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner")+'"></div></div><div class="'+T("waffle-dataconnector-refresh-all-dbobject-item-title")+'">'+R(a)+'</div><div class="'+
T("waffle-dataconnector-refresh-all-dbobject-item-status-wrapper")+'"><div class="'+T("waffle-dataconnector-refresh-all-dbobject-item-timestamp")+'"></div><div class="'+T("waffle-dataconnector-refresh-all-dbobject-item-error")+'">Error</div><div class="'+T("waffle-dataconnector-refresh-all-dbobject-item-loading")+'">Loading\u2026</div><div class="'+T("waffle-dataconnector-refresh-all-dbobject-item-running")+'">Running\u2026</div></div></div>')};function E4f(a,b,c,d){Q.call(this,d);this.D=a;this.L=b;this.J=c;this.H=new Rqe;this.C=new wZ(!1);this.F=!0}u(E4f,Q);p=E4f.prototype;p.Ba=function(){this.ib(ix(D4f,{title:this.L}))};p.Ha=function(){Q.prototype.Ha.call(this);ow(this.La(),"waffle-dataconnector-refresh-all-dbobject-item-enabled");this.C.render(this.Ea("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"));this.getHandler().listen(this.La(),"click",this.INa).listen(this.La(),"keydown",this.zQb);F4f(this)};
function F4f(a){var b=DV(a.J,a.D);switch(b.getType()){case "invalid-db-object":case "insufficient-access":case "fetch-failed":G4f(a,"waffle-dataconnector-refresh-all-dbobject-item-error");H4f(a);break;case "offline":H4f(a);break;case "loading":G4f(a,"waffle-dataconnector-refresh-all-dbobject-item-loading");I4f(a);break;case "fetching-results":G4f(a,"waffle-dataconnector-refresh-all-dbobject-item-running");I4f(a);break;case "no-results":J4f(a);H4f(a);break;case "fetch-successful":b=b.C.Os();b=a.H.format(b);
eu(a.Ea("waffle-dataconnector-refresh-all-dbobject-item-timestamp"),b);G4f(a,"waffle-dataconnector-refresh-all-dbobject-item-timestamp");H4f(a);break;case "do-not-show":break;default:throw Error("Unexpected DbObjectUiStateType");}}p.Na=function(a){this.F=a;var b=this.La();a?uw(b,"waffle-dataconnector-refresh-all-dbobject-item-disabled","waffle-dataconnector-refresh-all-dbobject-item-enabled"):uw(b,"waffle-dataconnector-refresh-all-dbobject-item-enabled","waffle-dataconnector-refresh-all-dbobject-item-disabled")};
function G4f(a,b){J4f(a);P(a.Ea(b),!0)}function H4f(a){a.C.setActive(!1);P(a.Ea("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"),!1);P(a.Ea("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh"),!0)}function I4f(a){a.C.setActive(!0);P(a.Ea("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh"),!1);P(a.Ea("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"),!0)}p.zQb=function(a){13===a.keyCode&&this.INa()};
p.INa=function(){if(this.F){var a=new aH("refresh-db-object-request");a.RAa=this.D;this.dispatchEvent(a)}};function J4f(a){["waffle-dataconnector-refresh-all-dbobject-item-timestamp","waffle-dataconnector-refresh-all-dbobject-item-error","waffle-dataconnector-refresh-all-dbobject-item-loading","waffle-dataconnector-refresh-all-dbobject-item-running"].forEach(function(b){return P(a.Ea(b),!1)})};function K4f(a,b,c,d,e){Q.call(this,e);this.L=new Set(a);this.J=b;this.H=[];this.F=c;this.D=this.C=null;d&&(this.C=new L4f(this.qa()),this.D=new GIe(this.F,this.qa(),!0,!0));this.O=new Map([[1,0],[2,0],[3,0],[4,0],[5,0]])}u(K4f,Q);K4f.prototype.Ba=function(){this.D?(this.D.render(),this.ib(this.D.La()),this.D.setContent(ix(A4f))):this.ib(ix(B4f))};
K4f.prototype.Ha=function(){var a=this;Q.prototype.Ha.call(this);this.D||eu(this.Ea("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title"),this.F);M4f(this);var b=this.getHandler();this.H.forEach(function(c){b.listen(c,"refresh-db-object-request",function(d){d=d.RAa;t9b.has(DV(a.J,d).D)&&cnb.Eb([d])})});this.C&&(this.C.render(this.Ea("waffle-dataconnector-refresh-all-dbobject-list-footer-container")),b.listen(this.C,"action",this.R))};
function M4f(a){var b=a.Ea("waffle-dataconnector-refresh-all-dbobject-list-items-container");a.L.forEach(function(c){var d=ritz_api.BigSheetsApi.getDbObjectTypeForExternalDataSourceId(c);d=N4f(a,d);c=new E4f(c,d,a.J,a.qa());a.H.push(c);c.render(b)})}
function N4f(a,b){switch(b){case 1:return"Pivot table "+O4f(a,1);case 2:return"Chart "+O4f(a,2);case 3:return"Function "+O4f(a,3);case 4:return"Connected sheet "+O4f(a,4);case 5:return"Extract "+O4f(a,5);default:throw Error("Unexpected DbObjectType");}}function O4f(a,b){var c=a.O.get(b);a.O.set(b,c+1);return 0==c?"":c.toString()}K4f.prototype.R=function(){var a=this,b=Array.from(this.L).filter(function(c){return t9b.has(DV(a.J,c).D)});cnb.Eb(b)};
function P4f(a){a.H.forEach(function(b){return F4f(b)})}function Q4f(a,b){a.C&&(b=b.filter(function(c){return a.L.has(c.Dq())}),R4f(a.C,b))}function S4f(a,b){a.F=b;a.D?a.D.getHeader().setContent(b):eu(a.Ea("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title"),b)}K4f.prototype.Na=function(a){this.C&&this.C.Na(a);this.H.forEach(function(b){return b.Na(a)})};function L4f(a){Q.call(this,a);this.D=new aV("Refresh",this.qa());this.Ga(this.D);this.C=new lJe;this.Ga(this.C)}u(L4f,Q);
L4f.prototype.Ba=function(){this.ib(ix(C4f))};L4f.prototype.Ha=function(){Q.prototype.Ha.call(this);this.D.render(this.Ea("waffle-dataconnector-refresh-all-dbobject-list-footer-button-wrapper"));this.C.render(this.Ea("waffle-dataconnector-refresh-all-dbobject-list-footer-bytes-wrapper"))};function R4f(a,b){var c=0;b.forEach(function(d){return c+=parseInt(E(d,2),10)});oJe(a.C,c);a.D.Na(!0)}L4f.prototype.Na=function(a){this.D.Na(a)};function T4f(a,b){Q.call(this,b);this.F=a;this.D=a.ma;this.C=[]}u(T4f,Q);T4f.prototype.Ba=function(){this.ib(ix(z4f))};T4f.prototype.Ha=function(){var a=this;Q.prototype.Ha.call(this);U4f(this);1<this.C.length&&this.C[0].D.getHeader().Vb(!0);P(this.Ea("waffle-dataconnector-refresh-all-stale-msg"),!1);this.getHandler().listen(this.F.C,"ha",function(b){return V4f(a,b)})};
function U4f(a){var b=W4f(a);if(1==b.size){var c=b.entries().next().value;b=c[1];c=X4f(a,c[0]);b=new K4f(b,a.D,c,!1,a.qa());a.C.push(b);b.render(a.Ea("waffle-dataconnector-refresh-all-datasources-container"))}else{c=ja(b.keys());for(var d=c.next();!d.done;d=c.next()){var e=d.value;d=X4f(a,e);e=b.get(e);d=new K4f(e,a.D,d,!0,a.qa());a.C.push(d);d.render(a.Ea("waffle-dataconnector-refresh-all-datasources-container"))}}}
function W4f(a){var b=new Map;s4f(a.D).forEach(function(c){var d=ritz_api.BigSheetsApi.getDataSourceIdForExternalDataId(c);b.has(d)?b.get(d).push(c):b.set(d,[c])});return b}function X4f(a,b){b=ritz_api.BigSheetsApi.getSheetIdForDatasourceId(b);return ZI(a.F.C,b).Rd()}function Y4f(a,b){a.C.forEach(function(c){return Q4f(c,b)})}function Z4f(a){a.C.forEach(function(b){b.C&&nJe(b.C.C)})}function $4f(a){a.C.forEach(function(b){b.C&&(b=b.C,mJe(b.C),b.D.Na(!1))})}
function a5f(a){a.C.forEach(function(b){return P4f(b)})}T4f.prototype.Na=function(a){this.C.forEach(function(b){return b.Na(a)})};function V4f(a,b){3==ZI(a.F.C,b.Wg).getSheetType()&&(a=a.C.find(function(c){return c.F==b.C}))&&S4f(a,b.wl)}var b5f={"margin-top":"-43px"},c5f={"margin-top":"0"},d5f={cj:"margin-top",duration:.1,timing:"ease-out",delay:0};function e5f(a,b,c){b=void 0===b?jW.getInstance():b;xx.call(this,"",void 0,c);a&&f5f(a);this.C=new g5f(a,b,c);this.Ga(this.C)}u(e5f,xx);p=e5f.prototype;p.Ba=function(){this.C.Ba();this.ib(this.C.La())};p.Mc=function(a){a.Bm(!0);this.C.Mc(a)};p.Dt=function(a,b){a.Bm(!0);this.C.Dt(a,b)};p.yf=function(a){return this.C.yf(a)};p.Fh=function(){return this.C.Fh()};p.Cd=function(){return this.C.C.map(function(a){return a.getValue()})};
function h5f(a,b){a=a.C;for(var c=ja(a.C),d=c.next();!d.done;d=c.next())d.value.Vb(!1);if(0==b.length)a.C=[];else{c=[];d=b.length;for(var e=0;e<a.Fh();e++){var f=a.yf(e),h=f.getValue();if(0<=b.indexOf(h)&&(f.Vb(!0),c.push(f),0==--d))break}a.C=c}a.oC()}p.Lb=function(){return this.C.Lb()};p.Ee=function(a){f5f(a);this.C.Ee(a)};p.Fd=function(a){this.C.Fd(a)};function f5f(a){for(var b=0;b<a.Hc();b++)a.Bc(b).Bm(!0)}function g5f(a,b,c){b=void 0===b?jW.getInstance():b;I_.call(this,a,b,c);this.C=[]}
u(g5f,I_);g5f.prototype.Ee=function(a){I_.prototype.Ee.call(this,a);this.C=[];this.oC()};g5f.prototype.Nr=function(a){a.stopPropagation();a=a.target;if(a.isChecked()){var b=this.Lb();Jne(this.C,a,function(c,d){return ed(Lv(b,c),Lv(b,d))})}else Wc(this.C,a);this.oC();this.dispatchEvent("change")};g5f.prototype.D=function(){var a;0==this.C.length?a=this.F:a=this.C.map(function(b){return b.zg()}).join(", ");return a||""};function i5f(){var a='<div class="'+T("waffle-dataconnector-refresh-schedules-widget")+'"><div class="'+T("waffle-dataconnector-refresh-schedules-header")+'"><div class="'+T("waffle-dataconnector-refresh-schedules-top-section")+'"><div class="'+T("waffle-dataconnector-refresh-schedules-header-title")+'"><span tabindex="0" class="'+T("waffle-dataconnector-refresh-schedules-title")+'">';a=a+'Scheduled refresh</span></div><div class="'+(T("waffle-dataconnector-refresh-schedules-enable-switch")+'"></div></div><div class="'+
T("waffle-dataconnector-refresh-schedules-spinner")+'"></div><div class="'+T("waffle-dataconnector-refresh-schedules-setup-btn")+'"></div><div class="'+T("waffle-dataconnector-refresh-schedules-overview-section")+'"><span class="'+T("waffle-dataconnector-refresh-schedules-overview-text")+'"></span><span class="'+T("waffle-dataconnector-refresh-schedules-edit-btn")+'"></span></div><div class="'+T("waffle-dataconnector-refresh-schedules-fullview-section")+'"><div class="waffle-dataconnector-refresh-schedules-fullview-text"></div><div><span class="'+
T("waffle-dataconnector-refresh-schedules-timezone-setting-btn")+'"></span> - ');a=a+'based on timezone set up in this spreadsheet</div></div></div><div class="'+(T("waffle-dataconnector-refresh-schedules-edit-section")+'"><div class="'+T("waffle-dataconnector-refresh-schedules-edit-section-row")+'"><label for="waffle-dataconnector-refresh-schedule-frequency" class="'+T("waffle-dataconnector-refresh-schedules-edit-section-row-label")+'">');a=a+'Frequency</label><div class="'+(T("waffle-dataconnector-refresh-schedules-frequency-select")+
" "+T("waffle-dataconnector-refresh-schedules-select")+'"></div></div><div class="'+T("waffle-dataconnector-refresh-schedules-edit-section-row")+" "+T("waffle-dataconnector-refresh-schedules-edit-section-row-date")+'"><label for="waffle-dataconnector-refresh-schedule-date" class="'+T("waffle-dataconnector-refresh-schedules-edit-section-row-label")+'">');a=a+'On date</label><div class="'+(T("waffle-dataconnector-refresh-schedules-date-select")+" "+T("waffle-dataconnector-refresh-schedules-select")+
'"></div></div><div class="'+T("waffle-dataconnector-refresh-schedules-edit-section-row")+'"><label for="waffle-dataconnector-refresh-schedule-time" class="'+T("waffle-dataconnector-refresh-schedules-edit-section-row-label")+'">');a=a+'Between</label><div class="'+(T("waffle-dataconnector-refresh-schedules-time-select")+" "+T("waffle-dataconnector-refresh-schedules-select")+'"></div></div><div class="'+T("waffle-dataconnector-refresh-schedules-owner-info")+'"></div><div class="'+T("waffle-dataconnector-refresh-schedules-btns")+
'"><div class="'+T("waffle-dataconnector-refresh-schedules-cancel-btn")+'"></div><div class="'+T("waffle-dataconnector-refresh-schedules-save-btn")+'"></div></div></div></div>');return S(a)};var j5f=new PA(7),k5f=new PA(RA.MONTH_DAY_ABBR),l5f=new Iz("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");
function m5f(a,b,c){Q.call(this,c);this.Ka=a;a=new ey;a.Ga(new $x("Every day",1),!0);a.Ga(new $x("Every week",2),!0);a.Ga(new $x("Every month",3),!0);this.H=new I_(a,jW.getInstance(),c);Gy(this.H,"Add frequency");this.H.Fd("waffle-dataconnector-refresh-schedule-frequency");this.Ga(this.H);this.F=new e5f(void 0,jW.getInstance(),c);Gy(this.F.C,"Add date");this.F.Fd("waffle-dataconnector-refresh-schedule-date");this.Ga(this.F);a=new ey;for(var d=new Date(Ia()),e=Array(24),f=0;24>f;f++){d.setHours(f,
0,0,0);var h=new Date(d.getTime()),k=new Date(d.getTime());k.setHours(h.getHours()+4);k=n5f(h,k);e[h.getHours()]={value:f,label:k}}for(d=0;24>d;d++)f=new $x(e[d].label,e[d].value),a.Ga(f,!0);this.J=new I_(a,jW.getInstance(),c);Gy(this.J,"Add time");this.J.Fd("waffle-dataconnector-refresh-schedule-time");this.Ga(this.J);this.L=new iQ("Cancel");this.Ga(this.L);this.R=new EA("Save",c);this.R.Na(!1);this.Ga(this.R);this.V=new Wx("",hO.getInstance(),c);this.Ga(this.V);this.Ca=new Wx("Setup now",hO.getInstance(),
c);this.Ga(this.Ca);this.Aa=new Wx("",hO.getInstance(),c);this.Ga(this.Aa);this.D=new fW(c);this.D.Pe("Enable schedule");this.Ga(this.D);this.eb=3;this.C=null;this.Fa=new nKe(500,500,"dbxScheduleOnCompleteAuth");this.va(this.Fa);this.ma=b;this.O=new SKe(c);this.O.Jc("waffle-dataconnector-refresh-schedules-info-icon");this.O.setVisible(!1);this.Oa=new wZ(!0);this.Ia=!1}u(m5f,Q);p=m5f.prototype;
p.Ba=function(){Q.prototype.Ba.call(this);this.ib(ix(i5f));this.O.C.setContent(re("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."));this.O.render(this.Ea("waffle-dataconnector-refresh-schedules-header-title"))};
p.Ha=function(){Q.prototype.Ha.call(this);this.L.render(this.Ea("waffle-dataconnector-refresh-schedules-cancel-btn"));this.V.render(this.Ea("waffle-dataconnector-refresh-schedules-edit-btn"));this.D.render(this.Ea("waffle-dataconnector-refresh-schedules-enable-switch"));this.H.render(this.Ea("waffle-dataconnector-refresh-schedules-frequency-select"));this.R.render(this.Ea("waffle-dataconnector-refresh-schedules-save-btn"));this.Ca.render(this.Ea("waffle-dataconnector-refresh-schedules-setup-btn"));
this.Aa.render(this.Ea("waffle-dataconnector-refresh-schedules-timezone-setting-btn"));this.J.render(this.Ea("waffle-dataconnector-refresh-schedules-time-select"));this.F.render(this.Ea("waffle-dataconnector-refresh-schedules-date-select"));this.Oa.render(this.Ea("waffle-dataconnector-refresh-schedules-spinner"));o5f(this,!1);this.getHandler().listen(this.V,"action",this.tSb).listen(this.L,"action",this.WRb).listen(this.R,"action",this.ITb).listen(this.Ca,"action",this.MTb).listen(this.D,"action",
this.uSb).listen(this.H,"change",this.FSb).listen(this.F,"change",this.Z1).listen(this.J,"change",this.Z1).listen(this.Aa,"action",this.dUb);0<Array.from(this.Ka.C.keys()).length?(P(this.La(),!0),p5f(this)):P(this.La(),!1)};
function q5f(a){if(!a.isDisposed()){var b=a.Ea("waffle-dataconnector-refresh-schedules-edit-section"),c=a.Ea("waffle-dataconnector-refresh-schedules-overview-section"),d=a.Ea("waffle-dataconnector-refresh-schedules-fullview-section"),e=a.Ea("waffle-dataconnector-refresh-schedules-owner-info"),f=a.Ea("waffle-dataconnector-refresh-schedules-setup-btn"),h=a.Ea("waffle-dataconnector-refresh-schedules-enable-switch"),k=a.Ea("waffle-dataconnector-refresh-schedules-spinner");P(f,!1);P(h,!1);P(b,!1);P(c,
!1);P(d,!1);P(e,!1);P(k,!1);sw(a.La(),"waffle-dataconnector-refresh-schedules-widget-opened",!1);var l=!1;a.O.setVisible(!1);switch(a.eb){case 1:P(f,!0);break;case 2:P(d,!0);P(b,!0);P(e,!0);sw(a.La(),"waffle-dataconnector-refresh-schedules-widget-opened",!0);l=!0;r5f(a);s5f(a);a.Z1();a.L.Na(!0);a.O.setVisible(!0);break;case 3:P(k,!0);break;case 5:P(d,!0);P(h,!0);P(b,!0);P(e,!0);sw(a.La(),"waffle-dataconnector-refresh-schedules-widget-opened",!0);l=!0;t5f(a);r5f(a);s5f(a);b=E(a.C,2);a.D.Vb(!!E(b,1));
c=b.Un().Un();a.H.setValue(c);switch(c){case 1:o5f(a,!1);break;case 2:h5f(a.F,Rf(b.Un(),4));o5f(a,!0);break;case 3:h5f(a.F,Rf(b.Un(),5)),o5f(a,!0)}a.J.setValue(E(b.Un(),2));a.Z1();a.L.Na(!0);a.O.setVisible(!0);break;case 4:P(h,!0),P(c,!0),t5f(a),c=a.Ea("waffle-dataconnector-refresh-schedules-overview-text"),u5f(a)?(b=a.C.getStatus(),eu(c,"Next: "),c=new Date(1E3*E(b,2)),b=new Date(1E3*E(b,3)),a.V.setContent(pu(a.qa(),v5f(c,b,a.ma,!0)))):(eu(c,"Paused"),a.V.setContent("Edit"))}a.Ia!=l&&(a.Ia=l,a.dispatchEvent(l?
"di":"ci"))}}function t5f(a){var b=!!E(E(a.C,2),1);a.D.Vb(b);a.D.Na(!0)}function r5f(a){var b=a.Ea("waffle-dataconnector-refresh-schedules-owner-info"),c="Will run as you.";a.C&&(a=E(E(a.C,4),1))&&(c+=" Currently running as "+a);eu(b,c)}
function s5f(a){var b=a.Ea("waffle-dataconnector-refresh-schedules-fullview-text");if(u5f(a)){var c=a.C.getStatus(),d=new Date(1E3*E(c,2));c=new Date(1E3*E(c,3));var e=a.qa();e.Zc(b);e.appendChild(b,pu(e,ve(re("Next: "),v5f(d,c,a.ma,!1))))}else eu(b,"");a.Aa.setContent(w5f(a.ma))}function u5f(a){return a.C&&E(E(a.C,2),1)?(E(a.C.getStatus(),1),!0):!1}p.WRb=function(){this.eb=2==this.eb?1:4;q5f(this);this.Ea("waffle-dataconnector-refresh-schedules-title").focus()};p.tSb=function(){this.eb=5;q5f(this)};
p.FSb=function(){var a=this.H.getValue();h5f(this.F,[]);switch(a){case 1:o5f(this,!1);break;case 2:o5f(this,!0);a=this.F.Ee(x5f());sf(a);break;case 3:o5f(this,!0),a=this.F.Ee(y5f()),sf(a)}this.Z1()};
p.ITb=function(){this.R.Na(!1);this.L.Na(!1);var a=this.H.getValue(),b=new zL,c=new BL;c.dC(a);if(2===a){var d=ja(this.F.Cd());for(a=d.next();!a.done;a=d.next())Pf(c,4,a.value)}else if(3===a)for(d=ja(this.F.Cd()),a=d.next();!a.done;a=d.next())Pf(c,5,a.value);a=this.J.getValue();F(c,2,a);b.dC(c);F(b,3,1);2==this.eb?(b.Na(!0),z5f(this,b,null)):(b.Na(this.D.isChecked()),A5f(this,b,null))};p.MTb=function(){this.eb=2;q5f(this)};
p.uSb=function(){var a=this;if(4==this.eb){var b=E(this.C,2),c=this.D.isChecked();this.D.Vb(!c);this.D.Na(!1);if(c){var d=B5f(this);d.render();d.setVisible(!0);d.getResult().then(function(){sf(d);b.Na(c);A5f(a,b,null)},function(){sf(d)})}else b.Na(c),A5f(this,b,null)}};p.dUb=function(){OD.Eb()};p.Z1=function(){var a=!!this.H.Xe(),b=1===this.H.getValue()||0<this.F.Cd().length,c=!!this.J.Xe();this.R.Na(a&&b&&c)};
function z5f(a,b,c,d){d=void 0===d?!0:d;var e=new o7b;F(e,1,b);c&&F(e,2,c);p4f(e).then(function(f){return C5f(a,b,f.getStatus(),E(f,2),!0,d)},function(){D5f(a)})}function A5f(a,b,c,d){d=void 0===d?!0:d;var e=new s7b;n4f(e,a.C.getId());F(e,2,b);c&&F(e,3,c);q4f(e).then(function(f){return C5f(a,b,f.getStatus(),E(f,2),!1,d)},function(){D5f(a)})}
function C5f(a,b,c,d,e,f){a.D.Na(!0);switch(c){case 1:a.Ea("waffle-dataconnector-refresh-schedules-title").focus();p5f(a);break;case 2:if(!f)break;oKe(a.Fa,d,function(h){a.isDisposed()||(a.D.Na(!1),e?z5f(a,b,h,!1):A5f(a,b,h,!1))});break;default:D5f(a)}}function p5f(a){a.eb=3;q5f(a);o4f().then(function(b){a.isDisposed()||(b=Rf(b,1),0==b.length?(a.eb=1,a.C=null):(a.eb=4,a.C=b[0]),q5f(a))},function(){mz.getInstance().postMessage(oz("Error loading schedule configuration.","error",!0))})}
function o5f(a,b){P(a.Ea("waffle-dataconnector-refresh-schedules-edit-section-row-date"),b)}
function B5f(a){var b=new lLe;b.Jc("waffle-dataconnector-refresh-schedules-resume-prompt");b.setTitle("Resume scheduled refresh?");b.C.setContent("Resume");b.H.setContent("Cancel");var c=E(a.C,2);switch(c.Un().Un()){case 1:var d="Daily";break;case 2:d=E5f();var e=Rf(c.Un(),4);d="Weekly on "+(d.filter(function(l){return e.includes(l.value)}).map(function(l){return l.label}).join(", ")+" ");break;case 3:d="Monthly on the "+(Rf(c.Un(),5).map(function(l){return l5f.format({DAY:l})}).join(", ")+" ")}var f=
a.C.getStatus();c=F5f(a.ma);var h=new Date(Ia()),k=new Date(1E3*E(f,2));f=new Date(1E3*E(f,3));d+=n5f(k,f,c)+" ("+whb(c.C-OA(c,h))+")";a="Will run as "+E(E(a.C,4),1);a=ve(re("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."),te("H4",void 0,"Schedule"),re(d),te("BR"),re(a));Dw(b,a);return b}function D5f(a){mz.getInstance().postMessage(oz("Error saving schedule.","error",!0));a.R.Na(!0);a.L.Na(!0);a.D.Na(!0)}
function E5f(){var a=(JA.FIRSTDAYOFWEEK+1)%7,b=JA.WEEKDAYS.map(function(c,d){return{label:c,value:(d+6)%7+1}});return b.slice(a).concat(b.slice(0,a))}function x5f(){var a=new ey,b=E5f();b=ja(b);for(var c=b.next();!c.done;c=b.next())c=c.value,a.Ga(new $x(c.label,c.value),!0);return a}function y5f(){for(var a=new ey,b=1;28>=b;b++)a.Ga(new $x(l5f.format({DAY:b}),b),!0);return a}function n5f(a,b,c){return j5f.format(a,c)+" - "+j5f.format(b,c)}
function v5f(a,b,c,d){var e=new VA,f=F5f(c);f=k5f.format(a,f)+" \u00b7 "+n5f(a,b,f);a.getDate()!==b.getDate()&&(f+=e.bd("sup")+"+1"+e.$c("sup"));d&&(f+=" ("+w5f(c)+")");return e.format(f)}function w5f(a){var b=new Date(Ia());a=F5f(a);return whb(a.C-OA(a,b))}function F5f(a){a=-1*a.getTimezoneOffset(new Date(Ia()));return NA(a/6E4)};function G5f(a,b,c){GZ.call(this,c);this.R=b;this.J=b.ma;this.O=a;this.Ix=new T4f(b,this.qa());this.Ga(this.Ix);this.D=new x4f(this.J,c);this.va(this.D);this.H=this.F=null}u(G5f,GZ);G5f.prototype.Ba=function(){GZ.prototype.Ba.call(this);this.ib(ix(y4f,{id:this.getId(),Sd:!0}));this.D.render(this.Ea("waffle-dataconnector-refresh-sidepane-footer-wrapper"))};
G5f.prototype.Ha=function(){var a=this;GZ.prototype.Ha.call(this);A(z(),"fedsr")&&(H5f(this),this.getHandler().listen(this,["ci","di"],this.L));this.Ix.render(this.Ea("waffle-dataconnector-refresh-sidepane-refresh-widget"));this.getHandler().listen(this.D,"refresh-db-object-request",function(){var b=t4f(a.J);cnb.Eb(b)});this.D.refresh();P(this.Ea("waffle-dataconnector-refresh-sidepane-backdrop"),!1)};
function I5f(a){sf(a.Ix);a.Ix=new T4f(a.R,a.qa());a.Ga(a.Ix);a.Ix.render(a.Ea("waffle-dataconnector-refresh-sidepane-refresh-widget"));a.D.refresh()}function J5f(a){null!=a.F&&(sf(a.F),sf(a.H),H5f(a))}function K5f(a,b){Y4f(a.Ix,b);var c=0;b.forEach(function(d){return c+=parseInt(E(d,2),10)});a.D.aA(c)}G5f.prototype.L=function(a){a="di"===a.type;P(this.Ea("waffle-dataconnector-refresh-sidepane-backdrop"),a);sf(this.H);a&&(a=this.F.La(),this.H=new uA(a,this.qa()),this.va(this.H),vA(this.H),a.focus())};
function H5f(a){a.F=new m5f(a.J,a.O,a.qa());a.Ga(a.F);a.F.render(a.La());P(a.Ea("waffle-dataconnector-refresh-sidepane-backdrop"),!1)};function L5f(a,b,c){UY.call(this,a,b);var d=this;this.C=c;this.D=new zm;this.va(this.D);Dm(this.D,this.C.D,function(e){if("dbobjectmodel-event-add"==e.getType()||"dbobjectmodel-event-remove"==e.getType()){e=d.ze.Ix.Ea("waffle-dataconnector-refresh-all-stale-msg");if(!yv(e)){var f=new bx(e,.1,b5f,c5f,d5f);P(e,!0);f.play()}e=d.ze;e.Ix.Na(!1);e.D.C.Na(!1)}M5f(d);a5f(d.ze.Ix);d.ze.La().focus()});this.Ma.listen(xK,"show-db-objects-refresh-sidepane",this.F)}u(L5f,UY);L5f.prototype.Df=function(){return enb};
L5f.prototype.Ko=function(){return fnb};function M5f(a){var b=t4f(a.C),c=a.ze;0==b.length?w4f(c.D):(Z4f(c.Ix),qJe(c.D),v4f(a.C,b,function(d){a.isDisposed()||c.isDisposed()||K5f(c,d)},function(d){if(!a.isDisposed()&&!c.isDisposed()){d=new nsd(d[0].Dq(),d[0].Eh());$4f(c.Ix);var e=c.D;e.Db()&&(e=e.H,e.F=d,mJe(e),P(e.Ea("waffle-dbobject-estimated-bytes-error"),!0),e.C.setActive(!1))}}))}L5f.prototype.F=function(){var a=this;I5f(this.ze);J5f(this.ze);M5f(this);VY(this);uza(function(){return a.ze.La().focus()})};function N5f(){rK.apply(this,arguments)}u(N5f,rK);N5f.prototype.C=function(){return L5f};N5f.prototype.D=function(){return G5f};vK("dbrefresh",N5f);
